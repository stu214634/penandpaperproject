import{i as z,j as e,B as d,d as u,e as o,P as se,G as n,l as w,m as A,n as W,o as m,a7 as j,a8 as v,a9 as f,aa as l,r as E,ah as re,z as ie,H as le,$ as P,k as de,L as oe,f as T,h as L,I as M}from"./mui-vendor-Bcv5ZZdT.js";import{r as c}from"./react-vendor-BgQLxDxx.js";import{r as H,u as ce,d as ue,b as N,a as he,e as xe,f as pe}from"./index-DRB9_cb-.js";import{d as me}from"./Edit-Bz8Ycac1.js";import{d as je}from"./Delete-DHt16Zdy.js";import"./map-vendor-ScXzXL1_.js";import"./utilities-jN8BjJof.js";var I={},ve=z;Object.defineProperty(I,"__esModule",{value:!0});var O=I.default=void 0,fe=ve(H()),ye=e;O=I.default=(0,fe.default)((0,ye.jsx)("path",{d:"M20 4H4v2h16zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6zm-9 4H6v-4h6z"}),"Store");var b={},Ce=z;Object.defineProperty(b,"__esModule",{value:!0});var B=b.default=void 0,ge=Ce(H()),Ie=e;B=b.default=(0,ge.default)((0,Ie.jsx)("path",{d:"M20 2H4c-1 0-2 .9-2 2v3.01c0 .72.43 1.34 1 1.69V20c0 1.1 1.1 2 2 2h14c.9 0 2-.9 2-2V8.7c.57-.35 1-.97 1-1.69V4c0-1.1-1-2-2-2m-5 12H9v-2h6zm5-7H4V4l16-.02z"}),"Inventory");const Ae=()=>{const[R,h]=c.useState(!1),[q,p]=c.useState(!1),[V,S]=c.useState(!1),[F,G]=c.useState(""),[D,k]=c.useState(!1),{characters:y,addCharacter:Q,updateCharacter:Y,deleteCharacter:J,saveDataToIndexedDB:K,locations:C}=ce(),[t,s]=c.useState({name:"",description:"",type:"npc",locationId:""}),[_,$]=c.useState(null),U=()=>{Q({name:t.name,description:t.description,type:t.type,locationId:t.locationId}),h(!1),g(),x("Character added successfully")},g=()=>{s({name:"",description:"",type:"npc",locationId:""})},X=a=>{const i=y.find(r=>r.id===a);i&&($(a),s({name:i.name,description:i.description,type:i.type,locationId:i.locationId||""}),p(!0))},Z=()=>{_&&(Y(_,{name:t.name,description:t.description,type:t.type,locationId:t.locationId}),p(!1),g(),$(null),x("Character updated successfully"))},ee=a=>{window.confirm("Are you sure you want to delete this character? This cannot be undone.")&&(J(a),x("Character deleted successfully"))},ae=async()=>{k(!0);try{const a=await K();x(a.message)}catch(a){x(`Error saving data: ${a instanceof Error?a.message:String(a)}`)}finally{k(!1)}},x=a=>{G(a),S(!0)},te=()=>{S(!1)},ne=a=>{const i=a.locationId?C.find(r=>r.id===a.locationId):null;return e.jsx(n,{item:!0,xs:12,sm:6,md:4,children:e.jsx(ie,{children:e.jsx(le,{children:e.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs(d,{children:[e.jsx(u,{variant:"h6",children:a.name}),e.jsxs(d,{sx:{display:"flex",alignItems:"center",mt:1},children:[e.jsx(P,{icon:a.type==="npc"?e.jsx(xe,{}):e.jsx(O,{}),label:a.type==="npc"?"NPC":"Merchant",size:"small",color:a.type==="npc"?"primary":"secondary",variant:"outlined"}),i&&e.jsx(P,{icon:e.jsx(pe,{}),label:i.name,size:"small",color:"info",variant:"outlined",sx:{ml:1}})]}),e.jsx(u,{variant:"body2",color:"text.secondary",sx:{mt:2},children:a.description}),a.inventory&&a.inventory.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(de,{sx:{my:2}}),e.jsxs(u,{variant:"subtitle2",gutterBottom:!0,children:[e.jsx(B,{fontSize:"small",sx:{verticalAlign:"middle",mr:.5}}),"Inventory (",a.inventory.length,")"]}),e.jsxs(oe,{dense:!0,children:[a.inventory.slice(0,3).map(r=>e.jsx(T,{disablePadding:!0,children:e.jsx(L,{primary:r.name,secondary:`Qty: ${r.quantity}${r.price?` - Price: ${r.price}`:""}`})},r.id)),a.inventory.length>3&&e.jsx(T,{disablePadding:!0,children:e.jsx(L,{primary:`+ ${a.inventory.length-3} more items`,primaryTypographyProps:{variant:"caption"}})})]})]})]}),e.jsxs(d,{children:[e.jsx(M,{onClick:()=>X(a.id),children:e.jsx(me,{})}),e.jsx(M,{onClick:()=>ee(a.id),children:e.jsx(je,{})})]})]})})})},a.id)};return e.jsxs(d,{sx:{p:3,maxWidth:1200,mx:"auto"},children:[e.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(u,{variant:"h4",children:"Characters"}),e.jsxs(d,{children:[e.jsx(o,{variant:"outlined",color:"success",startIcon:e.jsx(ue,{}),onClick:ae,disabled:D,sx:{mr:2},children:D?"Saving...":"Save Changes"}),e.jsx(o,{variant:"contained",startIcon:e.jsx(N,{}),onClick:()=>{g(),h(!0)},children:"Add Character"})]})]}),y.length===0?e.jsxs(se,{sx:{p:3,textAlign:"center"},children:[e.jsx(u,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No Characters Yet"}),e.jsx(u,{variant:"body1",color:"text.secondary",paragraph:!0,children:"Add your first character to get started."}),e.jsx(o,{variant:"contained",startIcon:e.jsx(N,{}),onClick:()=>h(!0),children:"Add Character"})]}):e.jsx(n,{container:!0,spacing:3,children:y.map(a=>ne(a))}),e.jsxs(w,{open:R,onClose:()=>h(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(A,{children:"Add New Character"}),e.jsx(W,{children:e.jsxs(n,{container:!0,spacing:2,sx:{mt:.5},children:[e.jsx(n,{item:!0,xs:12,md:8,children:e.jsx(m,{label:"Name",fullWidth:!0,value:t.name,onChange:a=>s({...t,name:a.target.value})})}),e.jsx(n,{item:!0,xs:12,md:4,children:e.jsxs(j,{fullWidth:!0,children:[e.jsx(v,{children:"Character Type"}),e.jsxs(f,{value:t.type,label:"Character Type",onChange:a=>s({...t,type:a.target.value}),children:[e.jsx(l,{value:"npc",children:"NPC"}),e.jsx(l,{value:"merchant",children:"Merchant"})]})]})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(j,{fullWidth:!0,children:[e.jsx(v,{children:"Location"}),e.jsxs(f,{value:t.locationId,label:"Location",onChange:a=>s({...t,locationId:a.target.value}),displayEmpty:!0,children:[e.jsx(l,{value:"",children:"No Location"}),C.map(a=>e.jsx(l,{value:a.id,children:a.name},a.id))]})]})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(m,{label:"Description",fullWidth:!0,multiline:!0,rows:4,value:t.description,onChange:a=>s({...t,description:a.target.value})})})]})}),e.jsxs(E,{children:[e.jsx(o,{onClick:()=>h(!1),children:"Cancel"}),e.jsx(o,{onClick:U,variant:"contained",disabled:!t.name,children:"Add Character"})]})]}),e.jsxs(w,{open:q,onClose:()=>p(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(A,{children:"Edit Character"}),e.jsx(W,{children:e.jsxs(n,{container:!0,spacing:2,sx:{mt:.5},children:[e.jsx(n,{item:!0,xs:12,md:8,children:e.jsx(m,{label:"Name",fullWidth:!0,value:t.name,onChange:a=>s({...t,name:a.target.value})})}),e.jsx(n,{item:!0,xs:12,md:4,children:e.jsxs(j,{fullWidth:!0,children:[e.jsx(v,{children:"Character Type"}),e.jsxs(f,{value:t.type,label:"Character Type",onChange:a=>s({...t,type:a.target.value}),children:[e.jsx(l,{value:"npc",children:"NPC"}),e.jsx(l,{value:"merchant",children:"Merchant"})]})]})}),e.jsx(n,{item:!0,xs:12,md:6,children:e.jsxs(j,{fullWidth:!0,children:[e.jsx(v,{children:"Location"}),e.jsxs(f,{value:t.locationId,label:"Location",onChange:a=>s({...t,locationId:a.target.value}),displayEmpty:!0,children:[e.jsx(l,{value:"",children:"No Location"}),C.map(a=>e.jsx(l,{value:a.id,children:a.name},a.id))]})]})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(m,{label:"Description",fullWidth:!0,multiline:!0,rows:4,value:t.description,onChange:a=>s({...t,description:a.target.value})})})]})}),e.jsxs(E,{children:[e.jsx(o,{onClick:()=>p(!1),children:"Cancel"}),e.jsx(o,{onClick:Z,variant:"contained",disabled:!t.name,children:"Save Changes"})]})]}),e.jsx(re,{open:V,autoHideDuration:6e3,onClose:te,message:F}),e.jsx(he,{})]})};export{Ae as CharactersView};

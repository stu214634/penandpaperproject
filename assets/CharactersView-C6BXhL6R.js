import{i as S,j as e,B as c,d as p,e as u,G as pe,P as A,N as n,l as O,m as z,n as F,o as l,ad as v,ae as y,af as f,ag as a,a6 as g,r as B,ah as ue,R as he,X as xe,Y as me,a2 as k,k as je,L as ve,f as L,h as R,I as q}from"./mui-vendor-B6rETHjT.js";import{r as o}from"./react-vendor-BzdEknB4.js";import{r as D,u as ye,f as fe,e as V,k as G,a as ge,b as Ce,l as be,c as Ie,m as Te,M as Ae,i as ke}from"./index-j4jQxGJR.js";import{d as Se}from"./Edit-Dc_QG9DX.js";import"./map-vendor-CMk8R3PE.js";import"./utilities-BTDtKTyc.js";var _={},De=S;Object.defineProperty(_,"__esModule",{value:!0});var Y=_.default=void 0,_e=De(D()),we=e;Y=_.default=(0,_e.default)((0,we.jsx)("path",{d:"M20 4H4v2h16zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6zm-9 4H6v-4h6z"}),"Store");var w={},Pe=S;Object.defineProperty(w,"__esModule",{value:!0});var Q=w.default=void 0,Ne=Pe(D()),$e=e;Q=w.default=(0,Ne.default)((0,$e.jsx)("path",{d:"M20 2H4c-1 0-2 .9-2 2v3.01c0 .72.43 1.34 1 1.69V20c0 1.1 1.1 2 2 2h14c.9 0 2-.9 2-2V8.7c.57-.35 1-.97 1-1.69V4c0-1.1-1-2-2-2m-5 12H9v-2h6zm5-7H4V4l16-.02z"}),"Inventory");var P={},We=S;Object.defineProperty(P,"__esModule",{value:!0});var U=P.default=void 0,Me=We(D()),Ee=e;U=P.default=(0,Me.default)((0,Ee.jsx)("path",{d:"M21 6H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2m-10 7H8v3H6v-3H3v-2h3V8h2v3h3zm4.5 2c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5m4-3c-.83 0-1.5-.67-1.5-1.5S18.67 9 19.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5"}),"VideogameAsset");const Re=()=>{const[C,h]=o.useState(!1),[b,j]=o.useState(!1),[X,N]=o.useState(!1),[J,K]=o.useState(""),[$,W]=o.useState(!1),[M,Z]=o.useState([]),{characters:I,addCharacter:ee,updateCharacter:te,deleteCharacter:se,saveDataToIndexedDB:ie,locations:x}=ye(),[s,r]=o.useState({name:"",description:"",type:"npc",locationId:"",descriptionType:"markdown",descriptionAssetName:"",hp:10}),[E,ne]=o.useState(null);o.useEffect(()=>{(C||b)&&(async()=>{const i=await Ce.getAssets("images");Z(i.map(d=>d.name))})()},[C,b]);const re=()=>{const t={name:s.name,description:s.description,type:s.type,hp:Number(s.hp)||1};s.locationId&&(t.locationId=s.locationId),t.descriptionType=s.descriptionType,s.descriptionAssetName&&(t.descriptionAssetName=s.descriptionAssetName),ee(t),h(!1),T(),m("Character added successfully")},T=()=>{r({name:"",description:"",type:"npc",locationId:"",descriptionType:"markdown",descriptionAssetName:"",hp:10})},ae=t=>{const i=I.find(d=>d.id===t);i&&(ne(t),r({name:i.name,description:i.description,type:i.type,locationId:i.locationId||"",descriptionType:i.descriptionType||"markdown",descriptionAssetName:i.descriptionAssetName||"",hp:i.hp}),j(!0))},le=()=>{if(E){const t={name:s.name,description:s.description,type:s.type,hp:Number(s.hp)||1,descriptionType:s.descriptionType};s.locationId&&(t.locationId=s.locationId),s.descriptionAssetName&&(t.descriptionAssetName=s.descriptionAssetName),te(E,t),j(!1),T(),m("Character updated successfully")}},de=t=>{window.confirm("Are you sure you want to delete this character? This cannot be undone.")&&(se(t),m("Character deleted successfully"))},oe=async()=>{W(!0);try{const t=await ie();m(t.message)}catch(t){m(`Error saving data: ${t instanceof Error?t.message:String(t)}`)}finally{W(!1)}},m=t=>{K(t),N(!0)},H=()=>{N(!1)},ce=t=>{const i=t.locationId?x.find(d=>d.id===t.locationId):null;return e.jsx(n,{item:!0,xs:12,sm:6,md:5,children:e.jsx(xe,{children:e.jsx(me,{children:e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs(c,{children:[e.jsx(p,{variant:"h6",children:t.name}),e.jsxs(c,{sx:{display:"flex",alignItems:"center",mt:1},children:[e.jsx(k,{icon:t.type==="npc"?e.jsx(be,{}):t.type==="merchant"?e.jsx(Y,{}):t.type==="enemy"?e.jsx(Ie,{}):e.jsx(U,{}),label:t.type==="npc"?"NPC":t.type==="merchant"?"Merchant":t.type==="enemy"?"Enemy":"Player",size:"small",color:t.type==="npc"?"primary":t.type==="merchant"?"secondary":t.type==="enemy"?"error":"success",variant:"outlined"}),i&&e.jsx(k,{icon:e.jsx(Te,{}),label:i.name,size:"small",color:"info",variant:"outlined",sx:{ml:1}}),e.jsx(k,{label:`HP: ${t.hp}`,size:"small",color:"default",variant:"outlined",sx:{ml:1}})]}),e.jsxs(c,{sx:{mt:1,mb:2},children:[t.descriptionType==="markdown"&&e.jsx(Ae,{content:t.description}),t.descriptionType!=="markdown"&&e.jsx(p,{variant:"body2",color:"text.secondary",children:t.description})]}),t.inventory&&t.inventory.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(je,{sx:{my:2}}),e.jsxs(p,{variant:"subtitle2",gutterBottom:!0,children:[e.jsx(Q,{fontSize:"small",sx:{verticalAlign:"middle",mr:.5}}),"Inventory (",t.inventory.length,")"]}),e.jsxs(ve,{dense:!0,children:[t.inventory.slice(0,3).map(d=>e.jsx(L,{disablePadding:!0,children:e.jsx(R,{primary:d.name,secondary:`Qty: ${d.quantity}${d.price?` - Price: ${d.price}`:""}`})},d.id)),t.inventory.length>3&&e.jsx(L,{disablePadding:!0,children:e.jsx(R,{primary:`+ ${t.inventory.length-3} more items`,primaryTypographyProps:{variant:"caption"}})})]})]})]}),e.jsxs(c,{children:[e.jsx(q,{onClick:()=>ae(t.id),children:e.jsx(Se,{})}),e.jsx(q,{onClick:()=>de(t.id),children:e.jsx(ke,{})})]})]})})})},t.id)};return e.jsxs(c,{sx:{p:3,maxWidth:1200,mx:"auto"},children:[e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(p,{variant:"h4",children:"Characters"}),e.jsxs(c,{children:[e.jsx(u,{variant:"outlined",color:"success",startIcon:e.jsx(fe,{}),onClick:oe,disabled:$,sx:{mr:2},children:$?e.jsx(pe,{size:24}):"Save Changes"}),e.jsx(u,{variant:"contained",startIcon:e.jsx(V,{}),onClick:()=>{T(),h(!0)},children:"Add Character"})]})]}),I.length===0?e.jsxs(A,{sx:{p:3,textAlign:"center"},children:[e.jsx(p,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No Characters Yet"}),e.jsx(p,{variant:"body1",color:"text.secondary",paragraph:!0,children:"Add your first character to get started."}),e.jsx(u,{variant:"contained",startIcon:e.jsx(V,{}),onClick:()=>h(!0),children:"Add Character"})]}):e.jsx(n,{container:!0,spacing:3,children:I.map(t=>ce(t))}),e.jsxs(O,{open:C,onClose:()=>h(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(z,{children:"Add New Character"}),e.jsx(F,{children:e.jsxs(n,{container:!0,spacing:2,sx:{mt:.5},children:[e.jsx(n,{item:!0,xs:12,md:8,children:e.jsx(l,{label:"Name",fullWidth:!0,value:s.name,onChange:t=>r({...s,name:t.target.value})})}),e.jsx(n,{item:!0,xs:12,md:4,children:e.jsxs(v,{fullWidth:!0,children:[e.jsx(y,{children:"Character Type"}),e.jsxs(f,{value:s.type,label:"Character Type",onChange:t=>r({...s,type:t.target.value}),children:[e.jsx(a,{value:"npc",children:"NPC"}),e.jsx(a,{value:"merchant",children:"Merchant"}),e.jsx(a,{value:"enemy",children:"Enemy"}),e.jsx(a,{value:"player",children:"Player Character"})]})]})}),e.jsx(n,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Hit Points (HP)",type:"number",fullWidth:!0,value:s.hp,onChange:t=>r({...s,hp:parseInt(t.target.value)||1}),inputProps:{min:1}})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(g,{options:x,value:x.find(t=>t.id===s.locationId)||null,onChange:(t,i)=>r({...s,locationId:(i==null?void 0:i.id)||""}),getOptionLabel:t=>t.name,renderInput:t=>e.jsx(l,{...t,label:"Location",fullWidth:!0}),isOptionEqualToValue:(t,i)=>t.id===i.id})}),e.jsx(n,{item:!0,xs:12,children:e.jsxs(v,{fullWidth:!0,children:[e.jsx(y,{children:"Description Type"}),e.jsxs(f,{value:s.descriptionType,label:"Description Type",onChange:t=>r({...s,descriptionType:t.target.value}),children:[e.jsx(a,{value:"markdown",children:"Markdown"}),e.jsx(a,{value:"image",children:"Image"}),e.jsx(a,{value:"pdf",children:"PDF"})]})]})}),s.descriptionType==="markdown"?e.jsxs(e.Fragment,{children:[e.jsx(n,{item:!0,xs:12,children:e.jsx(l,{label:"Description",multiline:!0,rows:6,fullWidth:!0,value:s.description,onChange:t=>r({...s,description:t.target.value})})}),e.jsxs(n,{item:!0,xs:12,children:[e.jsx(p,{variant:"subtitle2",sx:{mt:1,mb:1},children:"Preview"}),e.jsx(A,{sx:{p:2,height:"200px",overflow:"auto",bgcolor:"background.default",border:1,borderColor:"divider"},children:e.jsx(G,{children:s.description})})]})]}):s.descriptionType==="image"||s.descriptionType==="pdf"?e.jsxs(e.Fragment,{children:[e.jsx(n,{item:!0,xs:12,children:e.jsx(g,{options:M,value:s.descriptionAssetName||null,onChange:(t,i)=>r({...s,descriptionAssetName:i||""}),renderInput:t=>e.jsx(l,{...t,label:"Description Asset",fullWidth:!0,helperText:`Select a ${s.descriptionType} file from assets`})})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(l,{label:"Brief Description",multiline:!0,rows:3,fullWidth:!0,value:s.description,onChange:t=>r({...s,description:t.target.value}),helperText:"Add a brief description text to show in lists"})})]}):null]})}),e.jsxs(B,{children:[e.jsx(u,{onClick:()=>h(!1),children:"Cancel"}),e.jsx(u,{onClick:re,variant:"contained",disabled:!s.name,children:"Add Character"})]})]}),e.jsxs(O,{open:b,onClose:()=>j(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(z,{children:"Edit Character"}),e.jsx(F,{children:e.jsxs(n,{container:!0,spacing:2,sx:{mt:.5},children:[e.jsx(n,{item:!0,xs:12,md:8,children:e.jsx(l,{label:"Name",fullWidth:!0,value:s.name,onChange:t=>r({...s,name:t.target.value})})}),e.jsx(n,{item:!0,xs:12,md:4,children:e.jsxs(v,{fullWidth:!0,children:[e.jsx(y,{children:"Character Type"}),e.jsxs(f,{value:s.type,label:"Character Type",onChange:t=>r({...s,type:t.target.value}),children:[e.jsx(a,{value:"npc",children:"NPC"}),e.jsx(a,{value:"merchant",children:"Merchant"}),e.jsx(a,{value:"enemy",children:"Enemy"}),e.jsx(a,{value:"player",children:"Player Character"})]})]})}),e.jsx(n,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Hit Points (HP)",type:"number",fullWidth:!0,value:s.hp,onChange:t=>r({...s,hp:parseInt(t.target.value)||1}),inputProps:{min:1}})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(g,{options:x,value:x.find(t=>t.id===s.locationId)||null,onChange:(t,i)=>r({...s,locationId:(i==null?void 0:i.id)||""}),getOptionLabel:t=>t.name,renderInput:t=>e.jsx(l,{...t,label:"Location",fullWidth:!0}),isOptionEqualToValue:(t,i)=>t.id===i.id})}),e.jsx(n,{item:!0,xs:12,children:e.jsxs(v,{fullWidth:!0,children:[e.jsx(y,{children:"Description Type"}),e.jsxs(f,{value:s.descriptionType,label:"Description Type",onChange:t=>r({...s,descriptionType:t.target.value}),children:[e.jsx(a,{value:"markdown",children:"Markdown"}),e.jsx(a,{value:"image",children:"Image"}),e.jsx(a,{value:"pdf",children:"PDF"})]})]})}),s.descriptionType==="markdown"?e.jsxs(e.Fragment,{children:[e.jsx(n,{item:!0,xs:12,children:e.jsx(l,{label:"Description",multiline:!0,rows:6,fullWidth:!0,value:s.description,onChange:t=>r({...s,description:t.target.value})})}),e.jsxs(n,{item:!0,xs:12,children:[e.jsx(p,{variant:"subtitle2",sx:{mt:1,mb:1},children:"Preview"}),e.jsx(A,{sx:{p:2,height:"200px",overflow:"auto",bgcolor:"background.default",border:1,borderColor:"divider"},children:e.jsx(G,{children:s.description})})]})]}):s.descriptionType==="image"||s.descriptionType==="pdf"?e.jsxs(e.Fragment,{children:[e.jsx(n,{item:!0,xs:12,children:e.jsx(g,{options:M,value:s.descriptionAssetName||null,onChange:(t,i)=>r({...s,descriptionAssetName:i||""}),renderInput:t=>e.jsx(l,{...t,label:"Description Asset",fullWidth:!0,helperText:`Select a ${s.descriptionType} file from assets`})})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(l,{label:"Brief Description",multiline:!0,rows:3,fullWidth:!0,value:s.description,onChange:t=>r({...s,description:t.target.value}),helperText:"Add a brief description text to show in lists"})})]}):null]})}),e.jsxs(B,{children:[e.jsx(u,{onClick:()=>j(!1),children:"Cancel"}),e.jsx(u,{onClick:le,variant:"contained",disabled:!s.name,children:"Save Changes"})]})]}),e.jsx(ue,{open:X,autoHideDuration:6e3,onClose:H,children:e.jsx(he,{onClose:H,severity:"success",sx:{width:"100%"},children:J})}),e.jsx(ge,{})]})};export{Re as CharactersView};
//# sourceMappingURL=CharactersView-C6BXhL6R.js.map

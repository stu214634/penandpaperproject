import{i as we,j as r,P as Ze,M as ke,d as z,B as j,q as ni,I as ne,N as Ve,O as Ke,Q as Ue,e as V,G as qe,R as ri,U as ce,W as ma,X as va,l as ti,m as oi,n as si,r as Ri,L as Xe,f as ye,h as xe,Y as ha,Z as ga,_ as Ai,$ as Qe,a0 as Ti,a1 as Me,a2 as Sa,a3 as ba,a4 as ya,a5 as Di,a6 as xa,o as Ne,a7 as Ge,a8 as Je,a9 as Ie,aa as be,F as wa,ab as Ca,ac as ja,ad as Pa,g as Be,y as Yi,ae as Ei,af as zi,k as Aa,E as Ta,x as Da}from"./mui-vendor-Bcv5ZZdT.js";import{a as re,r as x}from"./react-vendor-BgQLxDxx.js";import{r as Ce,u as E,A as O,a as Ya}from"./index-DRB9_cb-.js";import{h as Ea}from"./utilities-jN8BjJof.js";import{d as Xi}from"./Delete-DHt16Zdy.js";import{d as za,a as ei}from"./ExpandMore-CeVNcmmC.js";import"./map-vendor-ScXzXL1_.js";var pi={},Xa=we;Object.defineProperty(pi,"__esModule",{value:!0});var mi=pi.default=void 0,ka=Xa(Ce()),_a=r;mi=pi.default=(0,ka.default)((0,_a.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");var U=function(e,n){return Number(e.toFixed(n))},Wa=function(e,n){return n},X=function(e,n,i){i&&typeof i=="function"&&i(e,n)},Ma=function(e){return-Math.cos(e*Math.PI)/2+.5},Na=function(e){return e},Ba=function(e){return e*e},Oa=function(e){return e*(2-e)},La=function(e){return e<.5?2*e*e:-1+(4-2*e)*e},Za=function(e){return e*e*e},Ra=function(e){return--e*e*e+1},Fa=function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},$a=function(e){return e*e*e*e},Ha=function(e){return 1- --e*e*e*e},Va=function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},Ka=function(e){return e*e*e*e*e},Ua=function(e){return 1+--e*e*e*e*e},qa=function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e},Fi={easeOut:Ma,linear:Na,easeInQuad:Ba,easeOutQuad:Oa,easeInOutQuad:La,easeInCubic:Za,easeOutCubic:Ra,easeInOutCubic:Fa,easeInQuart:$a,easeOutQuart:Ha,easeInOutQuart:Va,easeInQuint:Ka,easeOutQuint:Ua,easeInOutQuint:qa},$i=function(e){typeof e=="number"&&cancelAnimationFrame(e)},G=function(e){e.mounted&&($i(e.animation),e.animate=!1,e.animation=null,e.velocity=null)};function Hi(e,n,i,a){if(e.mounted){var o=new Date().getTime(),t=1;G(e),e.animation=function(){if(!e.mounted)return $i(e.animation);var s=new Date().getTime()-o,d=s/i,c=Fi[n],f=c(d);s>=i?(a(t),e.animation=null):e.animation&&(a(f),requestAnimationFrame(e.animation))},requestAnimationFrame(e.animation)}}function Qa(e){var n=e.scale,i=e.positionX,a=e.positionY;return!(Number.isNaN(n)||Number.isNaN(i)||Number.isNaN(a))}function le(e,n,i,a){var o=Qa(n);if(!(!e.mounted||!o)){var t=e.setTransformState,s=e.transformState,d=s.scale,c=s.positionX,f=s.positionY,l=n.scale-d,p=n.positionX-c,v=n.positionY-f;i===0?t(n.scale,n.positionX,n.positionY):Hi(e,a,i,function(g){var S=d+l*g,C=c+p*g,y=f+v*g;t(S,C,y)})}}function Ga(e,n,i){var a=e.offsetWidth,o=e.offsetHeight,t=n.offsetWidth,s=n.offsetHeight,d=t*i,c=s*i,f=a-d,l=o-c;return{wrapperWidth:a,wrapperHeight:o,newContentWidth:d,newDiffWidth:f,newContentHeight:c,newDiffHeight:l}}var Ja=function(e,n,i,a,o,t,s){var d=e>n?i*(s?1:.5):0,c=a>o?t*(s?1:.5):0,f=e-n-d,l=d,p=a-o-c,v=c;return{minPositionX:f,maxPositionX:l,minPositionY:p,maxPositionY:v}},vi=function(e,n){var i=e.wrapperComponent,a=e.contentComponent,o=e.setup.centerZoomedOut;if(!i||!a)throw new Error("Components are not mounted");var t=Ga(i,a,n),s=t.wrapperWidth,d=t.wrapperHeight,c=t.newContentWidth,f=t.newDiffWidth,l=t.newContentHeight,p=t.newDiffHeight,v=Ja(s,c,f,d,l,p,!!o);return v},li=function(e,n,i,a){return a?e<n?U(n,2):e>i?U(i,2):U(e,2):U(e,2)},fe=function(e,n){var i=vi(e,n);return e.bounds=i,i};function _e(e,n,i,a,o,t,s){var d=i.minPositionX,c=i.minPositionY,f=i.maxPositionX,l=i.maxPositionY,p=0,v=0;s&&(p=o,v=t);var g=li(e,d-p,f+p,a),S=li(n,c-v,l+v,a);return{x:g,y:S}}function Re(e,n,i,a,o,t){var s=e.transformState,d=s.scale,c=s.positionX,f=s.positionY,l=a-d;if(typeof n!="number"||typeof i!="number")return console.error("Mouse X and Y position were not provided!"),{x:c,y:f};var p=c-n*l,v=f-i*l,g=_e(p,v,o,t,0,0,null);return g}function We(e,n,i,a,o){var t=o?a:0,s=n-t;return!Number.isNaN(i)&&e>=i?i:!Number.isNaN(n)&&e<=s?s:e}var ki=function(e,n){var i=e.setup.panning.excluded,a=e.isInitialized,o=e.wrapperComponent,t=n.target,s="shadowRoot"in t&&"composedPath"in n,d=s?n.composedPath().some(function(l){return l instanceof Element?o==null?void 0:o.contains(l):!1}):o==null?void 0:o.contains(t),c=a&&t&&d;if(!c)return!1;var f=Fe(t,i);return!f},_i=function(e){var n=e.isInitialized,i=e.isPanning,a=e.setup,o=a.panning.disabled,t=n&&i&&!o;return!!t},Ia=function(e,n){var i=e.transformState,a=i.positionX,o=i.positionY;e.isPanning=!0;var t=n.clientX,s=n.clientY;e.startCoords={x:t-a,y:s-o}},en=function(e,n){var i=n.touches,a=e.transformState,o=a.positionX,t=a.positionY;e.isPanning=!0;var s=i.length===1;if(s){var d=i[0].clientX,c=i[0].clientY;e.startCoords={x:d-o,y:c-t}}};function an(e){var n=e.transformState,i=n.positionX,a=n.positionY,o=n.scale,t=e.setup,s=t.disabled,d=t.limitToBounds,c=t.centerZoomedOut,f=e.wrapperComponent;if(!(s||!f||!e.bounds)){var l=e.bounds,p=l.maxPositionX,v=l.minPositionX,g=l.maxPositionY,S=l.minPositionY,C=i>p||i<v,y=a>g||a<S,k=i>p?f.offsetWidth:e.setup.minPositionX||0,M=a>g?f.offsetHeight:e.setup.minPositionY||0,T=Re(e,k,M,o,e.bounds,d||c),w=T.x,A=T.y;return{scale:o,positionX:C?w:i,positionY:y?A:a}}}function Vi(e,n,i,a,o){var t=e.setup.limitToBounds,s=e.wrapperComponent,d=e.bounds,c=e.transformState,f=c.scale,l=c.positionX,p=c.positionY;if(!(s===null||d===null||n===l&&i===p)){var v=_e(n,i,d,t,a,o,s),g=v.x,S=v.y;e.setTransformState(f,g,S)}}var nn=function(e,n,i){var a=e.startCoords,o=e.transformState,t=e.setup.panning,s=t.lockAxisX,d=t.lockAxisY,c=o.positionX,f=o.positionY;if(!a)return{x:c,y:f};var l=n-a.x,p=i-a.y,v=s?c:l,g=d?f:p;return{x:v,y:g}},se=function(e,n){var i=e.setup,a=e.transformState,o=a.scale,t=i.minScale,s=i.disablePadding;return n>0&&o>=t&&!s?n:0},rn=function(e){var n=e.mounted,i=e.setup,a=i.disabled,o=i.velocityAnimation,t=e.transformState.scale,s=o.disabled,d=!s||t>1||!a||n;return!!d},tn=function(e){var n=e.mounted,i=e.velocity,a=e.bounds,o=e.setup,t=o.disabled,s=o.velocityAnimation,d=e.transformState.scale,c=s.disabled,f=!c||d>1||!t||n;return!(!f||!i||!a)};function on(e,n){var i=e.setup.velocityAnimation,a=i.equalToMove,o=i.animationTime,t=i.sensitivity;return a?o*n*t:o}function Wi(e,n,i,a,o,t,s,d,c,f){if(o){if(n>s&&i>s){var l=s+(e-s)*f;return l>c?c:l<s?s:l}if(n<t&&i<t){var l=t+(e-t)*f;return l<d?d:l>t?t:l}}return a?n:li(e,t,s,o)}function sn(e,n){var i=1;return n?Math.min(i,e.offsetWidth/window.innerWidth):i}function ln(e,n){var i=rn(e);if(i){var a=e.lastMousePosition,o=e.velocityTime,t=e.setup,s=e.wrapperComponent,d=t.velocityAnimation.equalToMove,c=Date.now();if(a&&o&&s){var f=sn(s,d),l=n.x-a.x,p=n.y-a.y,v=l/f,g=p/f,S=c-o,C=l*l+p*p,y=Math.sqrt(C)/S;e.velocity={velocityX:v,velocityY:g,total:y}}e.lastMousePosition=n,e.velocityTime=c}}function dn(e){var n=e.velocity,i=e.bounds,a=e.setup,o=e.wrapperComponent,t=tn(e);if(!(!t||!n||!i||!o)){var s=n.velocityX,d=n.velocityY,c=n.total,f=i.maxPositionX,l=i.minPositionX,p=i.maxPositionY,v=i.minPositionY,g=a.limitToBounds,S=a.alignmentAnimation,C=a.zoomAnimation,y=a.panning,k=y.lockAxisY,M=y.lockAxisX,T=C.animationType,w=S.sizeX,A=S.sizeY,R=S.velocityAlignmentTime,N=R,L=on(e,c),B=Math.max(L,N),H=se(e,w),F=se(e,A),q=H*o.offsetWidth/100,I=F*o.offsetHeight/100,$=f+q,ee=l-q,te=p+I,Q=v-I,K=e.transformState,je=new Date().getTime();Hi(e,T,B,function(Pe){var ie=e.transformState,Ae=ie.scale,J=ie.positionX,ae=ie.positionY,Te=new Date().getTime()-je,De=Te/N,Ye=Fi[S.animationType],pe=1-Ye(Math.min(1,De)),de=1-Pe,me=J+s*de,ve=ae+d*de,he=Wi(me,K.positionX,J,M,g,l,f,ee,$,pe),Ee=Wi(ve,K.positionY,ae,k,g,v,p,Q,te,pe);(J!==me||ae!==ve)&&e.setTransformState(Ae,he,Ee)})}}function Mi(e,n){var i=e.transformState.scale;G(e),fe(e,i),window.TouchEvent!==void 0&&n instanceof TouchEvent?en(e,n):Ia(e,n)}function hi(e,n){var i=e.transformState.scale,a=e.setup,o=a.minScale,t=a.alignmentAnimation,s=t.disabled,d=t.sizeX,c=t.sizeY,f=t.animationTime,l=t.animationType,p=s||i<o||!d&&!c;if(!p){var v=an(e);v&&le(e,v,n??f,l)}}function Ni(e,n,i){var a=e.startCoords,o=e.setup,t=o.alignmentAnimation,s=t.sizeX,d=t.sizeY;if(a){var c=nn(e,n,i),f=c.x,l=c.y,p=se(e,s),v=se(e,d);ln(e,{x:f,y:l}),Vi(e,f,l,p,v)}}function un(e){if(e.isPanning){var n=e.setup.panning.velocityDisabled,i=e.velocity,a=e.wrapperComponent,o=e.contentComponent;e.isPanning=!1,e.animate=!1,e.animation=null;var t=a==null?void 0:a.getBoundingClientRect(),s=o==null?void 0:o.getBoundingClientRect(),d=(t==null?void 0:t.width)||0,c=(t==null?void 0:t.height)||0,f=(s==null?void 0:s.width)||0,l=(s==null?void 0:s.height)||0,p=d<f||c<l,v=!n&&i&&(i==null?void 0:i.total)>.1&&p;v?dn(e):hi(e)}}function gi(e,n,i,a){var o=e.setup,t=o.minScale,s=o.maxScale,d=o.limitToBounds,c=We(U(n,2),t,s,0,!1),f=fe(e,c),l=Re(e,i,a,c,f,d),p=l.x,v=l.y;return{scale:c,positionX:p,positionY:v}}function Ki(e,n,i){var a=e.transformState.scale,o=e.wrapperComponent,t=e.setup,s=t.minScale,d=t.limitToBounds,c=t.zoomAnimation,f=c.disabled,l=c.animationTime,p=c.animationType,v=f||a>=s;if((a>=1||d)&&hi(e),!(v||!o||!e.mounted)){var g=n||o.offsetWidth/2,S=i||o.offsetHeight/2,C=gi(e,s,g,S);C&&le(e,C,l,p)}}var oe=function(){return oe=Object.assign||function(n){for(var i,a=1,o=arguments.length;a<o;a++){i=arguments[a];for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=i[t])}return n},oe.apply(this,arguments)};function Bi(e,n,i){for(var a=0,o=n.length,t;a<o;a++)(t||!(a in n))&&(t||(t=Array.prototype.slice.call(n,0,a)),t[a]=n[a]);return e.concat(t||Array.prototype.slice.call(n))}var Oe={scale:1,positionX:0,positionY:0},ze={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,allowLeftClickPan:!0,allowMiddleClickPan:!0,allowRightClickPan:!0,wheelPanning:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},di={wrapperClass:"react-transform-wrapper",contentClass:"react-transform-component"},Ui=function(e){var n,i,a,o;return{previousScale:(n=e.initialScale)!==null&&n!==void 0?n:Oe.scale,scale:(i=e.initialScale)!==null&&i!==void 0?i:Oe.scale,positionX:(a=e.initialPositionX)!==null&&a!==void 0?a:Oe.positionX,positionY:(o=e.initialPositionY)!==null&&o!==void 0?o:Oe.positionY}},Oi=function(e){var n=oe({},ze);return Object.keys(e).forEach(function(i){var a=typeof e[i]<"u",o=typeof ze[i]<"u";if(o&&a){var t=Object.prototype.toString.call(ze[i]),s=t==="[object Object]",d=t==="[object Array]";s?n[i]=oe(oe({},ze[i]),e[i]):d?n[i]=Bi(Bi([],ze[i],!0),e[i]):n[i]=e[i]}}),n},qi=function(e,n,i){var a=e.transformState.scale,o=e.wrapperComponent,t=e.setup,s=t.maxScale,d=t.minScale,c=t.zoomAnimation,f=t.smooth,l=c.size;if(!o)throw new Error("Wrapper is not mounted");var p=f?a*Math.exp(n*i):a+n*i,v=We(U(p,3),d,s,l,!1);return v};function Qi(e,n,i,a,o){var t=e.wrapperComponent,s=e.transformState,d=s.scale,c=s.positionX,f=s.positionY;if(!t)return console.error("No WrapperComponent found");var l=t.offsetWidth,p=t.offsetHeight,v=(l/2-c)/d,g=(p/2-f)/d,S=qi(e,n,i),C=gi(e,S,v,g);if(!C)return console.error("Error during zoom event. New transformation state was not calculated.");le(e,C,a,o)}function Gi(e,n,i,a){var o=e.setup,t=e.wrapperComponent,s=o.limitToBounds,d=Ui(e.props),c=e.transformState,f=c.scale,l=c.positionX,p=c.positionY;if(t){var v=vi(e,d.scale),g=_e(d.positionX,d.positionY,v,s,0,0,t),S={scale:d.scale,positionX:g.x,positionY:g.y};f===d.scale&&l===d.positionX&&p===d.positionY||(a==null||a(),le(e,S,n,i))}}function cn(e,n,i,a){var o=e.getBoundingClientRect(),t=n.getBoundingClientRect(),s=i.getBoundingClientRect(),d=t.x*a.scale,c=t.y*a.scale;return{x:(o.x-s.x+d)/a.scale,y:(o.y-s.y+c)/a.scale}}function fn(e,n,i){var a=e.wrapperComponent,o=e.contentComponent,t=e.transformState,s=e.setup,d=s.limitToBounds,c=s.minScale,f=s.maxScale;if(!a||!o)return t;var l=a.getBoundingClientRect(),p=n.getBoundingClientRect(),v=cn(n,a,o,t),g=v.x,S=v.y,C=p.width/t.scale,y=p.height/t.scale,k=a.offsetWidth/C,M=a.offsetHeight/y,T=We(i||Math.min(k,M),c,f,0,!1),w=(l.width-C*T)/2,A=(l.height-y*T)/2,R=(l.left-g)*T+w,N=(l.top-S)*T+A,L=vi(e,T),B=_e(R,N,L,d,0,0,a),H=B.x,F=B.y;return{positionX:H,positionY:F,scale:T}}var pn=function(e){return function(n,i,a){n===void 0&&(n=.5),i===void 0&&(i=300),a===void 0&&(a="easeOut"),Qi(e,1,n,i,a)}},mn=function(e){return function(n,i,a){n===void 0&&(n=.5),i===void 0&&(i=300),a===void 0&&(a="easeOut"),Qi(e,-1,n,i,a)}},vn=function(e){return function(n,i,a,o,t){o===void 0&&(o=300),t===void 0&&(t="easeOut");var s=e.transformState,d=s.positionX,c=s.positionY,f=s.scale,l=e.wrapperComponent,p=e.contentComponent,v=e.setup.disabled;if(!(v||!l||!p)){var g={positionX:Number.isNaN(n)?d:n,positionY:Number.isNaN(i)?c:i,scale:Number.isNaN(a)?f:a};le(e,g,o,t)}}},hn=function(e){return function(n,i){n===void 0&&(n=200),i===void 0&&(i="easeOut"),Gi(e,n,i)}},gn=function(e){return function(n,i,a){i===void 0&&(i=200),a===void 0&&(a="easeOut");var o=e.transformState,t=e.wrapperComponent,s=e.contentComponent;if(t&&s){var d=Ji(n||o.scale,t,s);le(e,d,i,a)}}},Sn=function(e){return function(n,i,a,o){a===void 0&&(a=600),o===void 0&&(o="easeOut"),G(e);var t=e.wrapperComponent,s=typeof n=="string"?document.getElementById(n):n;if(t&&s&&t.contains(s)){var d=fn(e,s,i);le(e,d,a,o)}}},ui=function(e){return{instance:e,zoomIn:pn(e),zoomOut:mn(e),setTransform:vn(e),resetTransform:hn(e),centerView:gn(e),zoomToElement:Sn(e)}},bn=function(e){return{instance:e,state:e.transformState}},Y=function(e){var n={};return Object.assign(n,bn(e)),Object.assign(n,ui(e)),n},ii=!1;function ai(){try{var e={get passive(){return ii=!0,!1}};return e}catch{return ii=!1,ii}}var Le=".".concat(di.wrapperClass),Fe=function(e,n){return n.some(function(i){return e.matches("".concat(Le," ").concat(i,", ").concat(Le," .").concat(i,", ").concat(Le," ").concat(i," *, ").concat(Le," .").concat(i," *"))})},ci=function(e){e&&clearTimeout(e)},yn=function(e,n,i){return"translate(".concat(e,"px, ").concat(n,"px) scale(").concat(i,")")},Ji=function(e,n,i){var a=i.offsetWidth*e,o=i.offsetHeight*e,t=(n.offsetWidth-a)/2,s=(n.offsetHeight-o)/2;return{scale:e,positionX:t,positionY:s}};function xn(e){return function(n){e.forEach(function(i){typeof i=="function"?i(n):i!=null&&(i.current=n)})}}var wn=function(e,n){var i=e.setup.wheel,a=i.disabled,o=i.wheelDisabled,t=i.touchPadDisabled,s=i.excluded,d=e.isInitialized,c=e.isPanning,f=n.target,l=d&&!c&&!a&&f;if(!l||o&&!n.ctrlKey||t&&n.ctrlKey)return!1;var p=Fe(f,s);return!p},Cn=function(e){return e?e.deltaY<0?1:-1:0};function jn(e,n){var i=Cn(e),a=Wa(n,i);return a}function Ii(e,n,i){var a=n.getBoundingClientRect(),o=0,t=0;if("clientX"in e)o=(e.clientX-a.left)/i,t=(e.clientY-a.top)/i;else{var s=e.touches[0];o=(s.clientX-a.left)/i,t=(s.clientY-a.top)/i}return(Number.isNaN(o)||Number.isNaN(t))&&console.error("No mouse or touch offset found"),{x:o,y:t}}var Pn=function(e,n,i,a,o){var t=e.transformState.scale,s=e.wrapperComponent,d=e.setup,c=d.maxScale,f=d.minScale,l=d.zoomAnimation,p=d.disablePadding,v=l.size,g=l.disabled;if(!s)throw new Error("Wrapper is not mounted");var S=t+n*i,C=a?!1:!g,y=We(U(S,3),f,c,v,C&&!p);return y},An=function(e,n){var i=e.previousWheelEvent,a=e.transformState.scale,o=e.setup,t=o.maxScale,s=o.minScale;return i?a<t||a>s||Math.sign(i.deltaY)!==Math.sign(n.deltaY)||i.deltaY>0&&i.deltaY<n.deltaY||i.deltaY<0&&i.deltaY>n.deltaY||Math.sign(i.deltaY)!==Math.sign(n.deltaY):!1},Tn=function(e,n){var i=e.setup.pinch,a=i.disabled,o=i.excluded,t=e.isInitialized,s=n.target,d=t&&!a&&s;if(!d)return!1;var c=Fe(s,o);return!c},Dn=function(e){var n=e.setup.pinch.disabled,i=e.isInitialized,a=e.pinchStartDistance,o=i&&!n&&a;return!!o},Yn=function(e,n,i){var a=i.getBoundingClientRect(),o=e.touches,t=U(o[0].clientX-a.left,5),s=U(o[0].clientY-a.top,5),d=U(o[1].clientX-a.left,5),c=U(o[1].clientY-a.top,5);return{x:(t+d)/2/n,y:(s+c)/2/n}},ea=function(e){return Math.sqrt(Math.pow(e.touches[0].pageX-e.touches[1].pageX,2)+Math.pow(e.touches[0].pageY-e.touches[1].pageY,2))},En=function(e,n){var i=e.pinchStartScale,a=e.pinchStartDistance,o=e.setup,t=o.maxScale,s=o.minScale,d=o.zoomAnimation,c=o.disablePadding,f=d.size,l=d.disabled;if(!i||a===null||!n)throw new Error("Pinch touches distance was not provided");if(n<0)return e.transformState.scale;var p=n/a,v=p*i;return We(U(v,2),s,t,f,!l&&!c)},zn=160,Xn=100,kn=function(e,n){var i=e.props,a=i.onWheelStart,o=i.onZoomStart;e.wheelStopEventTimer||(G(e),X(Y(e),n,a),X(Y(e),n,o))},_n=function(e,n){var i=e.props,a=i.onWheel,o=i.onZoom,t=e.contentComponent,s=e.setup,d=e.transformState,c=d.scale,f=s.limitToBounds,l=s.centerZoomedOut,p=s.zoomAnimation,v=s.wheel,g=s.disablePadding,S=s.smooth,C=p.size,y=p.disabled,k=v.step,M=v.smoothStep;if(!t)throw new Error("Component not mounted");n.preventDefault(),n.stopPropagation();var T=jn(n,null),w=S?M*Math.abs(n.deltaY):k,A=Pn(e,T,w,!n.ctrlKey);if(c!==A){var R=fe(e,A),N=Ii(n,t,c),L=y||C===0||l||g,B=f&&L,H=Re(e,N.x,N.y,A,R,B),F=H.x,q=H.y;e.previousWheelEvent=n,e.setTransformState(A,F,q),X(Y(e),n,a),X(Y(e),n,o)}},Wn=function(e,n){var i=e.props,a=i.onWheelStop,o=i.onZoomStop;ci(e.wheelAnimationTimer),e.wheelAnimationTimer=setTimeout(function(){e.mounted&&(Ki(e,n.x,n.y),e.wheelAnimationTimer=null)},Xn);var t=An(e,n);t&&(ci(e.wheelStopEventTimer),e.wheelStopEventTimer=setTimeout(function(){e.mounted&&(e.wheelStopEventTimer=null,X(Y(e),n,a),X(Y(e),n,o))},zn))},ia=function(e){for(var n=0,i=0,a=0;a<2;a+=1)n+=e.touches[a].clientX,i+=e.touches[a].clientY;var o=n/2,t=i/2;return{x:o,y:t}},Mn=function(e,n){var i=ea(n);e.pinchStartDistance=i,e.lastDistance=i,e.pinchStartScale=e.transformState.scale,e.isPanning=!1;var a=ia(n);e.pinchLastCenterX=a.x,e.pinchLastCenterY=a.y,G(e)},Nn=function(e,n){var i=e.contentComponent,a=e.pinchStartDistance,o=e.wrapperComponent,t=e.transformState.scale,s=e.setup,d=s.limitToBounds,c=s.centerZoomedOut,f=s.zoomAnimation,l=s.alignmentAnimation,p=f.disabled,v=f.size;if(!(a===null||!i)){var g=Yn(n,t,i);if(!(!Number.isFinite(g.x)||!Number.isFinite(g.y))){var S=ea(n),C=En(e,S),y=ia(n),k=y.x-(e.pinchLastCenterX||0),M=y.y-(e.pinchLastCenterY||0);if(!(C===t&&k===0&&M===0)){e.pinchLastCenterX=y.x,e.pinchLastCenterY=y.y;var T=fe(e,C),w=p||v===0||c,A=d&&w,R=Re(e,g.x,g.y,C,T,A),N=R.x,L=R.y;e.pinchMidpoint=g,e.lastDistance=S;var B=l.sizeX,H=l.sizeY,F=se(e,B),q=se(e,H),I=N+k,$=L+M,ee=_e(I,$,T,d,F,q,o),te=ee.x,Q=ee.y;e.setTransformState(C,te,Q)}}}},Bn=function(e){var n=e.pinchMidpoint;e.velocity=null,e.lastDistance=null,e.pinchMidpoint=null,e.pinchStartScale=null,e.pinchStartDistance=null,Ki(e,n==null?void 0:n.x,n==null?void 0:n.y)},aa=function(e,n){var i=e.props.onZoomStop,a=e.setup.doubleClick.animationTime;ci(e.doubleClickStopEventTimer),e.doubleClickStopEventTimer=setTimeout(function(){e.doubleClickStopEventTimer=null,X(Y(e),n,i)},a)},On=function(e,n){var i=e.props,a=i.onZoomStart,o=i.onZoom,t=e.setup.doubleClick,s=t.animationTime,d=t.animationType;X(Y(e),n,a),Gi(e,s,d,function(){return X(Y(e),n,o)}),aa(e,n)};function Ln(e,n){return e==="toggle"?n===1?1:-1:e==="zoomOut"?-1:1}function Zn(e,n){var i=e.setup,a=e.doubleClickStopEventTimer,o=e.transformState,t=e.contentComponent,s=o.scale,d=e.props,c=d.onZoomStart,f=d.onZoom,l=i.doubleClick,p=l.disabled,v=l.mode,g=l.step,S=l.animationTime,C=l.animationType;if(!p&&!a){if(v==="reset")return On(e,n);if(!t)return console.error("No ContentComponent found");var y=Ln(v,e.transformState.scale),k=qi(e,y,g);if(s!==k){X(Y(e),n,c);var M=Ii(n,t,s),T=gi(e,k,M.x,M.y);if(!T)return console.error("Error during zoom event. New transformation state was not calculated.");X(Y(e),n,f),le(e,T,S,C),aa(e,n)}}}var Rn=function(e,n){var i=e.isInitialized,a=e.setup,o=e.wrapperComponent,t=a.doubleClick,s=t.disabled,d=t.excluded,c=n.target,f=o==null?void 0:o.contains(c),l=i&&c&&f&&!s;if(!l)return!1;var p=Fe(c,d);return!p},Fn=function(){function e(n){var i=this;this.mounted=!0,this.pinchLastCenterX=null,this.pinchLastCenterY=null,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.isWheelPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){i.initializeWindowEvents()},this.unmount=function(){i.cleanupWindowEvents()},this.update=function(a){i.props=a,fe(i,i.transformState.scale),i.setup=Oi(a)},this.initializeWindowEvents=function(){var a,o,t=ai(),s=(a=i.wrapperComponent)===null||a===void 0?void 0:a.ownerDocument,d=s==null?void 0:s.defaultView;(o=i.wrapperComponent)===null||o===void 0||o.addEventListener("wheel",i.onWheelPanning,t),d==null||d.addEventListener("mousedown",i.onPanningStart,t),d==null||d.addEventListener("mousemove",i.onPanning,t),d==null||d.addEventListener("mouseup",i.onPanningStop,t),s==null||s.addEventListener("mouseleave",i.clearPanning,t),d==null||d.addEventListener("keyup",i.setKeyUnPressed,t),d==null||d.addEventListener("keydown",i.setKeyPressed,t)},this.cleanupWindowEvents=function(){var a,o,t=ai(),s=(a=i.wrapperComponent)===null||a===void 0?void 0:a.ownerDocument,d=s==null?void 0:s.defaultView;d==null||d.removeEventListener("mousedown",i.onPanningStart,t),d==null||d.removeEventListener("mousemove",i.onPanning,t),d==null||d.removeEventListener("mouseup",i.onPanningStop,t),s==null||s.removeEventListener("mouseleave",i.clearPanning,t),d==null||d.removeEventListener("keyup",i.setKeyUnPressed,t),d==null||d.removeEventListener("keydown",i.setKeyPressed,t),document.removeEventListener("mouseleave",i.clearPanning,t),G(i),(o=i.observer)===null||o===void 0||o.disconnect()},this.handleInitializeWrapperEvents=function(a){var o=ai();a.addEventListener("wheel",i.onWheelZoom,o),a.addEventListener("dblclick",i.onDoubleClick,o),a.addEventListener("touchstart",i.onTouchPanningStart,o),a.addEventListener("touchmove",i.onTouchPanning,o),a.addEventListener("touchend",i.onTouchPanningStop,o)},this.handleInitialize=function(a,o){var t=!1,s=i.setup.centerOnInit,d=function(c,f){for(var l=0,p=c;l<p.length;l++){var v=p[l];if(v.target===f)return!0}return!1};i.applyTransformation(),i.onInitCallbacks.forEach(function(c){c(Y(i))}),i.observer=new ResizeObserver(function(c){if(d(c,a)||d(c,o))if(s&&!t){var f=o.offsetWidth,l=o.offsetHeight;(f>0||l>0)&&(t=!0,i.setCenter())}else G(i),fe(i,i.transformState.scale),hi(i,0)}),i.observer.observe(a),i.observer.observe(o)},this.onWheelZoom=function(a){var o=i.setup.disabled;if(!o){var t=wn(i,a);if(t){var s=i.isPressingKeys(i.setup.wheel.activationKeys);s&&(kn(i,a),_n(i,a),Wn(i,a))}}},this.onWheelPanning=function(a){var o=i.setup,t=o.disabled,s=o.wheel,d=o.panning;if(!(!i.wrapperComponent||!i.contentComponent||t||!s.wheelDisabled||d.disabled||!d.wheelPanning||a.ctrlKey)){a.preventDefault(),a.stopPropagation();var c=i.transformState,f=c.positionX,l=c.positionY,p=f-a.deltaX,v=l-a.deltaY,g=d.lockAxisX?f:p,S=d.lockAxisY?l:v,C=i.setup.alignmentAnimation,y=C.sizeX,k=C.sizeY,M=se(i,y),T=se(i,k);g===f&&S===l||Vi(i,g,S,M,T)}},this.onPanningStart=function(a){var o=i.setup.disabled,t=i.props.onPanningStart;if(!o){var s=ki(i,a);if(s){var d=i.isPressingKeys(i.setup.panning.activationKeys);d&&(a.button===0&&!i.setup.panning.allowLeftClickPan||a.button===1&&!i.setup.panning.allowMiddleClickPan||a.button===2&&!i.setup.panning.allowRightClickPan||(a.preventDefault(),a.stopPropagation(),G(i),Mi(i,a),X(Y(i),a,t)))}}},this.onPanning=function(a){var o=i.setup.disabled,t=i.props.onPanning;if(!o){var s=_i(i);if(s){var d=i.isPressingKeys(i.setup.panning.activationKeys);d&&(a.preventDefault(),a.stopPropagation(),Ni(i,a.clientX,a.clientY),X(Y(i),a,t))}}},this.onPanningStop=function(a){var o=i.props.onPanningStop;i.isPanning&&(un(i),X(Y(i),a,o))},this.onPinchStart=function(a){var o=i.setup.disabled,t=i.props,s=t.onPinchingStart,d=t.onZoomStart;if(!o){var c=Tn(i,a);c&&(Mn(i,a),G(i),X(Y(i),a,s),X(Y(i),a,d))}},this.onPinch=function(a){var o=i.setup.disabled,t=i.props,s=t.onPinching,d=t.onZoom;if(!o){var c=Dn(i);c&&(a.preventDefault(),a.stopPropagation(),Nn(i,a),X(Y(i),a,s),X(Y(i),a,d))}},this.onPinchStop=function(a){var o=i.props,t=o.onPinchingStop,s=o.onZoomStop;i.pinchStartScale&&(Bn(i),X(Y(i),a,t),X(Y(i),a,s))},this.onTouchPanningStart=function(a){var o=i.setup.disabled,t=i.props.onPanningStart;if(!o){var s=ki(i,a);if(s){var d=i.lastTouch&&+new Date-i.lastTouch<200&&a.touches.length===1;if(!d){i.lastTouch=+new Date,G(i);var c=a.touches,f=c.length===1,l=c.length===2;f&&(G(i),Mi(i,a),X(Y(i),a,t)),l&&i.onPinchStart(a)}}}},this.onTouchPanning=function(a){var o=i.setup.disabled,t=i.props.onPanning;if(i.isPanning&&a.touches.length===1){if(o)return;var s=_i(i);if(!s)return;a.preventDefault(),a.stopPropagation();var d=a.touches[0];Ni(i,d.clientX,d.clientY),X(Y(i),a,t)}else a.touches.length>1&&i.onPinch(a)},this.onTouchPanningStop=function(a){i.onPanningStop(a),i.onPinchStop(a)},this.onDoubleClick=function(a){var o=i.setup.disabled;if(!o){var t=Rn(i,a);t&&Zn(i,a)}},this.clearPanning=function(a){i.isPanning&&i.onPanningStop(a)},this.setKeyPressed=function(a){i.pressedKeys[a.key]=!0},this.setKeyUnPressed=function(a){i.pressedKeys[a.key]=!1},this.isPressingKeys=function(a){return a.length?!!a.find(function(o){return i.pressedKeys[o]}):!0},this.setTransformState=function(a,o,t){var s=i.props.onTransformed;if(!Number.isNaN(a)&&!Number.isNaN(o)&&!Number.isNaN(t)){a!==i.transformState.scale&&(i.transformState.previousScale=i.transformState.scale,i.transformState.scale=a),i.transformState.positionX=o,i.transformState.positionY=t,i.applyTransformation();var d=Y(i);i.onChangeCallbacks.forEach(function(c){return c(d)}),X(d,{scale:a,positionX:o,positionY:t},s)}else console.error("Detected NaN set state values")},this.setCenter=function(){if(i.wrapperComponent&&i.contentComponent){var a=Ji(i.transformState.scale,i.wrapperComponent,i.contentComponent);i.setTransformState(a.scale,a.positionX,a.positionY)}},this.handleTransformStyles=function(a,o,t){return i.props.customTransform?i.props.customTransform(a,o,t):yn(a,o,t)},this.applyTransformation=function(){if(!(!i.mounted||!i.contentComponent)){var a=i.transformState,o=a.scale,t=a.positionX,s=a.positionY,d=i.handleTransformStyles(t,s,o);i.contentComponent.style.transform=d}},this.getContext=function(){return Y(i)},this.onChange=function(a){return i.onChangeCallbacks.has(a)||i.onChangeCallbacks.add(a),function(){i.onChangeCallbacks.delete(a)}},this.onInit=function(a){return i.onInitCallbacks.has(a)||i.onInitCallbacks.add(a),function(){i.onInitCallbacks.delete(a)}},this.init=function(a,o){i.cleanupWindowEvents(),i.wrapperComponent=a,i.contentComponent=o,fe(i,i.transformState.scale),i.handleInitializeWrapperEvents(a),i.handleInitialize(a,o),i.initializeWindowEvents(),i.isInitialized=!0;var t=Y(i);X(t,void 0,i.props.onInit)},this.props=n,this.setup=Oi(this.props),this.transformState=Ui(this.props)}return e}(),Si=re.createContext(null),$n=function(e,n){return typeof e=="function"?e(n):e},Hn=re.forwardRef(function(e,n){var i=x.useRef(new Fn(e)).current,a=$n(e.children,ui(i));return x.useImperativeHandle(n,function(){return ui(i)},[i]),x.useEffect(function(){i.update(e)},[i,e]),re.createElement(Si.Provider,{value:i},a)});re.forwardRef(function(e,n){var i=x.useRef(null),a=x.useContext(Si);return x.useEffect(function(){return a.onChange(function(o){if(i.current){var t=0,s=0;i.current.style.transform=a.handleTransformStyles(t,s,1/o.instance.transformState.scale)}})},[a]),re.createElement("div",oe({},e,{ref:xn([i,n])}))});function Vn(e,n){n===void 0&&(n={});var i=n.insertAt;if(!(typeof document>"u")){var a=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",i==="top"&&a.firstChild?a.insertBefore(o,a.firstChild):a.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}var Kn=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
  transform: translate3d(0, 0, 0);
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,Li={wrapper:"transform-component-module_wrapper__SPB86",content:"transform-component-module_content__FBWxo"};Vn(Kn);var Un=function(e){var n=e.children,i=e.wrapperClass,a=i===void 0?"":i,o=e.contentClass,t=o===void 0?"":o,s=e.wrapperStyle,d=e.contentStyle,c=e.wrapperProps,f=c===void 0?{}:c,l=e.contentProps,p=l===void 0?{}:l,v=x.useContext(Si),g=v.init,S=v.cleanupWindowEvents,C=x.useRef(null),y=x.useRef(null);return x.useEffect(function(){var k=C.current,M=y.current;return k!==null&&M!==null&&g&&(g==null||g(k,M)),function(){S==null||S()}},[]),re.createElement("div",oe({},f,{ref:C,className:"".concat(di.wrapperClass," ").concat(Li.wrapper," ").concat(a),style:s}),re.createElement("div",oe({},p,{ref:y,className:"".concat(di.contentClass," ").concat(Li.content," ").concat(t),style:d}),n))},bi={},qn=we;Object.defineProperty(bi,"__esModule",{value:!0});var na=bi.default=void 0,Qn=qn(Ce()),Gn=r;na=bi.default=(0,Qn.default)((0,Gn.jsx)("path",{d:"m5 9 1.41 1.41L11 5.83V22h2V5.83l4.59 4.59L19 9l-7-7z"}),"North");var yi={},Jn=we;Object.defineProperty(yi,"__esModule",{value:!0});var ra=yi.default=void 0,In=Jn(Ce()),er=r;ra=yi.default=(0,In.default)((0,er.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload");var xi={},ir=we;Object.defineProperty(xi,"__esModule",{value:!0});var fi=xi.default=void 0,ar=ir(Ce()),nr=r;fi=xi.default=(0,ar.default)((0,nr.jsx)("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download");var wi={},rr=we;Object.defineProperty(wi,"__esModule",{value:!0});var ta=wi.default=void 0,tr=rr(Ce()),or=r;ta=wi.default=(0,tr.default)((0,or.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm4 18H6V4h7v5h5zM8 15.01l1.41 1.41L11 14.84V19h2v-4.16l1.59 1.59L16 15.01 12.01 11z"}),"UploadFile");const Zi=({onAssetImport:e,isFullPage:n=!1})=>{const[i,a]=x.useState(!1),[o,t]=x.useState(!1),[s,d]=x.useState(null),c=x.useRef(null),f=x.useRef(null),[l,p]=x.useState(!1),[v,g]=x.useState(!0),[S,C]=x.useState(0),[y,k]=x.useState([]),[M,T]=x.useState([]),[w,A]=x.useState([]),[R,N]=x.useState(!1),[L,B]=x.useState(!1),[H,F]=x.useState(null),{saveDataToIndexedDB:q,exportToZip:I}=E(),[$,ee]=x.useState("audio"),[te,Q]=x.useState(!1);x.useEffect(()=>{(async()=>{g(!0);const P=await O.hasAssets("audio"),_=await O.hasAssets("images"),u=await O.hasAssets("data");p(P||_||u),g(!1),await K()})()},[]);const K=async()=>{N(!0);try{const h=await O.getAssets("audio"),P=await O.getAssets("images"),_=await O.getAssets("data");k(h.map(u=>u.name)),T(P.map(u=>u.name)),A(_.map(u=>u.name))}catch(h){console.error("Error loading asset lists:",h)}finally{N(!1)}},je=`
Your zip file should contain:

1. /audio folder - with mp3, wav, or ogg files
2. /images folder - with jpg, png, or gif files
3. /data folder - with JSON files:
   - locations.json: Array of location objects with id, name, description
   - characters.json: Array of character objects

Example locations.json:
[
  {
    "id": "tavern",
    "name": "The Rusty Tankard",
    "description": "A cozy tavern with a fireplace.",
    "backgroundMusic": "tavern_ambience.mp3"
  }
]
  `,Pe=h=>{h.preventDefault(),a(!0)},ie=h=>{h.preventDefault(),a(!1)},Ae=async h=>{h.preventDefault(),a(!1);const P=h.dataTransfer.files;if(P.length===0)return;const _=P[0];await ae(_)},J=async h=>{const P=h.target.files;if(!P||P.length===0)return;const _=P[0];await ae(_)},ae=async h=>{if(!h.name.toLowerCase().endsWith(".zip")){d({success:!1,message:"Please upload a .zip file containing audio, images, and data folders."});return}t(!0),d(null);try{const P=await O.processZipFile(h);d(P),P.success&&(p(!0),await K(),e&&e())}catch(P){d({success:!1,message:`Error processing file: ${P instanceof Error?P.message:String(P)}`})}finally{t(!1),c.current&&(c.current.value="")}},Te=async()=>{t(!0);try{await O.clearAllAssets(),p(!1),k([]),T([]),A([]),d({success:!0,message:"All imported assets have been cleared."}),e&&e()}catch(h){d({success:!1,message:`Error clearing assets: ${h instanceof Error?h.message:String(h)}`})}finally{t(!1)}},De=()=>{d(null)},Ye=async()=>{t(!0),d(null);try{const h=await O.loadExampleData();d(h),h.success&&(p(!0),await K(),e&&e())}catch(h){d({success:!1,message:`Error creating empty structure: ${h instanceof Error?h.message:String(h)}`})}finally{t(!1)}},pe=(h,P)=>{C(P)},de=h=>{ee(h),Q(!0)},me=async h=>{const P=h.target.files;if(!P||P.length===0)return;const _=P[0];t(!0);try{const u=await O.addAsset($,_);d(u),u.success&&(p(!0),await K(),e&&e())}catch(u){d({success:!1,message:`Error adding asset: ${u instanceof Error?u.message:String(u)}`})}finally{t(!1),Q(!1),f.current&&(f.current.value="")}},ve=async(h,P)=>{t(!0);try{const _=await O.deleteAsset(h,P);if(d(_),_.success){await K();const u=await O.hasAssets("audio"),m=await O.hasAssets("images"),b=await O.hasAssets("data");p(u||m||b),e&&e()}}catch(_){d({success:!1,message:`Error deleting asset: ${_ instanceof Error?_.message:String(_)}`})}finally{t(!1)}},he=async()=>{B(!0);try{const h=await q();d(h)}catch(h){d({success:!1,message:`Error saving data: ${h instanceof Error?h.message:String(h)}`})}finally{B(!1)}},Ee=async()=>{B(!0);try{const h=await I();d({success:h.success,message:h.message}),h.success&&h.url&&F(h.url)}catch(h){d({success:!1,message:`Error exporting data: ${h instanceof Error?h.message:String(h)}`})}finally{B(!1)}},$e=()=>{if(H){const h=document.createElement("a");h.href=H,h.download="campaign-data.zip",document.body.appendChild(h),h.click(),document.body.removeChild(h)}},ue=(h,P)=>R?r.jsx(j,{sx:{display:"flex",justifyContent:"center",p:2},children:r.jsx(ke,{size:30})}):P.length===0?r.jsxs(z,{variant:"body2",sx:{p:2,textAlign:"center",color:"text.secondary"},children:["No ",h,' assets found. Add some using the "Add ',h,'" button.']}):r.jsx(Xe,{dense:!0,children:P.map(_=>r.jsxs(ye,{children:[r.jsx(xe,{primary:_,secondary:h==="data"?"JSON Data":`${h.charAt(0).toUpperCase()+h.slice(1)} File`}),r.jsx(ha,{children:r.jsx(ne,{edge:"end",onClick:()=>ve(h,_),children:r.jsx(Xi,{})})})]},_))});return v?r.jsxs(Ze,{elevation:3,sx:{p:2,backgroundColor:"rgba(45, 45, 45, 0.9)",transition:"all 0.3s ease",position:"relative",width:n?"100%":"auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[r.jsx(ke,{size:40}),r.jsx(z,{variant:"body1",sx:{mt:2},children:"Checking for stored assets..."})]}):r.jsxs(r.Fragment,{children:[r.jsxs(Ze,{elevation:3,sx:{p:2,backgroundColor:"rgba(45, 45, 45, 0.9)",transition:"all 0.3s ease",position:"relative",width:n?"100%":"auto"},children:[r.jsxs(j,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[r.jsx(z,{variant:"h6",children:"Asset Manager"}),r.jsx(ni,{title:je,arrow:!0,placement:"left",children:r.jsx(ne,{size:"small",children:r.jsx(za,{fontSize:"small"})})})]}),r.jsxs(Ve,{defaultExpanded:!l,sx:{mb:2,backgroundColor:"rgba(60, 60, 60, 0.7)"},children:[r.jsx(Ke,{expandIcon:r.jsx(ei,{}),children:r.jsx(z,{variant:"subtitle1",children:"Import ZIP File"})}),r.jsxs(Ue,{children:[r.jsxs(j,{sx:{border:"2px dashed",borderColor:i?"primary.main":"grey.500",borderRadius:1,p:2,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",cursor:"pointer",backgroundColor:i?"rgba(25, 118, 210, 0.1)":"transparent",transition:"all 0.3s ease",position:"relative"},onDragOver:Pe,onDragLeave:ie,onDrop:Ae,onClick:()=>{var h;return(h=c.current)==null?void 0:h.click()},children:[o?r.jsx(ke,{size:30,sx:{my:2}}):r.jsxs(r.Fragment,{children:[r.jsx(ra,{sx:{fontSize:40,color:"text.secondary",mb:1}}),r.jsx(z,{variant:"body1",gutterBottom:!0,children:"Drag & Drop a ZIP file here, or click to select"}),r.jsx(z,{variant:"body2",color:"textSecondary",children:"Your ZIP should contain audio/, images/, and data/ folders"})]}),r.jsx("input",{type:"file",ref:c,onChange:J,style:{display:"none"},accept:".zip"})]}),r.jsxs(j,{sx:{mt:2,display:"flex",justifyContent:"space-between"},children:[r.jsx(V,{variant:"outlined",color:"warning",startIcon:r.jsx(Xi,{}),onClick:Te,disabled:o||!l,children:"Clear All Assets"}),!l&&r.jsx(V,{variant:"outlined",color:"primary",onClick:Ye,disabled:o,children:"Create Empty Structure"})]})]})]}),r.jsxs(Ve,{sx:{mb:2,backgroundColor:"rgba(60, 60, 60, 0.7)"},children:[r.jsx(Ke,{expandIcon:r.jsx(ei,{}),children:r.jsx(z,{variant:"subtitle1",children:"Export Campaign"})}),r.jsxs(Ue,{children:[r.jsxs(j,{sx:{mb:2},children:[r.jsx(z,{variant:"body2",paragraph:!0,children:"Export your entire campaign as a ZIP file to backup your work or share it with others."}),r.jsxs(qe,{container:!0,spacing:2,children:[r.jsx(qe,{item:!0,xs:12,sm:6,children:r.jsx(V,{variant:"contained",color:"primary",fullWidth:!0,startIcon:r.jsx(fi,{}),onClick:Ee,disabled:L||!l,children:L?"Preparing ZIP...":"Export Campaign ZIP"})}),r.jsx(qe,{item:!0,xs:12,sm:6,children:r.jsx(V,{variant:"outlined",color:"primary",fullWidth:!0,startIcon:r.jsx(fi,{}),onClick:$e,disabled:!H,children:"Download ZIP"})})]})]}),r.jsx(V,{variant:"outlined",color:"success",fullWidth:!0,onClick:he,disabled:L,children:L?"Saving...":"Save Current Campaign State"})]})]}),r.jsxs(Ve,{sx:{backgroundColor:"rgba(60, 60, 60, 0.7)"},defaultExpanded:l,children:[r.jsx(Ke,{expandIcon:r.jsx(ei,{}),children:r.jsx(z,{variant:"subtitle1",children:"Manage Individual Assets"})}),r.jsx(Ue,{children:r.jsxs(j,{sx:{width:"100%"},children:[r.jsx(j,{sx:{borderBottom:1,borderColor:"divider"},children:r.jsxs(ri,{value:S,onChange:pe,children:[r.jsx(ce,{label:"Audio"}),r.jsx(ce,{label:"Images"}),r.jsx(ce,{label:"Data"})]})}),r.jsxs(j,{sx:{p:1},children:[r.jsxs(V,{variant:"outlined",color:"primary",startIcon:r.jsx(ta,{}),sx:{mb:1},onClick:()=>de(S===0?"audio":S===1?"images":"data"),children:["Add ",S===0?"Audio":S===1?"Image":"Data"," File"]}),r.jsx(j,{role:"tabpanel",hidden:S!==0,children:S===0&&ue("audio",y)}),r.jsx(j,{role:"tabpanel",hidden:S!==1,children:S===1&&ue("images",M)}),r.jsx(j,{role:"tabpanel",hidden:S!==2,children:S===2&&ue("data",w)})]})]})})]}),s&&r.jsxs(ma,{severity:s.success?"success":"error",sx:{mt:2},action:r.jsx(ne,{size:"small",onClick:De,children:r.jsx(mi,{fontSize:"small"})}),children:[r.jsx(va,{children:s.success?"Success":"Error"}),s.message]})]}),r.jsxs(ti,{open:te,onClose:()=>Q(!1),children:[r.jsxs(oi,{children:["Add ",$==="audio"?"Audio":$==="images"?"Image":"Data"," File"]}),r.jsxs(si,{children:[r.jsxs(z,{variant:"body2",sx:{mb:2},children:[$==="audio"&&"Select an audio file (MP3, WAV, OGG)",$==="images"&&"Select an image file (PNG, JPG, GIF)",$==="data"&&"Select a JSON data file"]}),r.jsxs(V,{variant:"contained",component:"label",fullWidth:!0,children:["Choose File",r.jsx("input",{type:"file",ref:f,hidden:!0,onChange:me,accept:$==="audio"?"audio/*":$==="images"?"image/*":".json"})]})]}),r.jsx(Ri,{children:r.jsx(V,{onClick:()=>Q(!1),children:"Cancel"})})]})]})};var Ci={},sr=we;Object.defineProperty(Ci,"__esModule",{value:!0});var oa=Ci.default=void 0,lr=sr(Ce()),dr=r;oa=Ci.default=(0,lr.default)((0,dr.jsx)("path",{d:"m21.9 21.9-8.49-8.49-9.82-9.82L2.1 2.1.69 3.51 3 5.83V19c0 1.1.9 2 2 2h13.17l2.31 2.31zM5 18l3.5-4.5 2.5 3.01L12.17 15l3 3zm16 .17L5.83 3H19c1.1 0 2 .9 2 2z"}),"ImageNotSupported");const gr=()=>{const e=E(u=>u.locations),n=E(u=>u.playTrack);E(u=>u.stopTrack);const i=E(u=>u.getSublocationsByParentId),a=E(u=>u.getAllTopLevelLocations),o=E(u=>u.refreshAssets);E(u=>u.hasAssets);const t=E(u=>u.isLoading),s=E(u=>u.characters),d=E(u=>u.saveDataToIndexedDB),c=E(u=>u.selectedLocationId),f=E(u=>u.setSelectedLocationId),[l,p]=x.useState(null),[v,g]=x.useState(!1),[S,C]=x.useState(!1),[y,k]=x.useState(!1),[M,T]=x.useState(!1),[w,A]=x.useState(null),[R,N]=x.useState(!1),L=x.useRef(null),B=x.useRef(null),[H,F]=x.useState(!1),[q,I]=x.useState([]),[$,ee]=x.useState([]),te=e.length>0,[Q,K]=x.useState(""),[je,Pe]=x.useState({}),[ie,Ae]=x.useState(0);x.useEffect(()=>{if(e.length>0)if(c){const u=e.find(m=>m.id===c);if(u)p(u),g(!0);else{const m=a();m.length>0&&(p(m[0]),f(m[0].id))}}else{const u=a();u.length>0&&(p(u[0]),f(u[0].id))}},[e,c]),x.useEffect(()=>{l&&((async()=>{F(!0);try{if(l.imageUrl){const m=await O.getAssetUrl("images",l.imageUrl);K(m)}else K("")}catch(m){console.error("Error loading image:",m),K("")}finally{F(!1)}})(),f(l.id))},[l==null?void 0:l.id,l==null?void 0:l.imageUrl]),x.useEffect(()=>{if(R){const u=async()=>{try{const b=await O.getAssets("audio");I(b.map(D=>D.name))}catch(b){console.error("Failed to load audio assets:",b),I([])}},m=async()=>{try{const b=await O.getAssets("images");ee(b.map(D=>D.name))}catch(b){console.error("Failed to load image assets:",b),ee([])}};u(),m()}},[R]);const J=async(u,m)=>{if(m.stopPropagation(),y){A(u),N(!0);return}if((l==null?void 0:l.id)!==u.id){if(p(u),g(!0),u.entrySound){const b=await O.getAssetUrl("audio",u.entrySound);b&&new Ea.Howl({src:[b],loop:!1,volume:E.getState().volume}).play()}if(u.backgroundMusic){const b=`/audio/${u.backgroundMusic}`,W=!(!!u.parentLocationId&&u.mixWithParent===!0);n(b,{replace:W,locationId:u.id})}}else g(!v)},ae=async()=>{if(await o(),l){const u=l.id;p(null),setTimeout(()=>{const m=e.find(b=>b.id===u);m&&p(m)},100)}},Te=u=>{if(!y||!l||!L.current||!B.current)return;const m=B.current.getBoundingClientRect(),b=(u.clientX-m.left)/m.width,D=(u.clientY-m.top)/m.height,W={name:"New Location",description:"Add a description",coordinates:[b,D],parentLocationId:l.id},Z=E.getState().addLocation;Z(W),E.getState().saveDataToIndexedDB()},De=(u,m)=>{if(!y)return;const b=new Image;b.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",m.dataTransfer.setDragImage(b,0,0),m.dataTransfer.setData("locationId",u),T(!0)},Ye=u=>{y&&u.preventDefault()},pe=u=>{if(!y||!L.current||!B.current)return;u.preventDefault();const m=u.dataTransfer.getData("locationId");if(!m||!E.getState().locations.find(ji=>ji.id===m))return;const W=B.current.getBoundingClientRect(),Z=(u.clientX-W.left)/W.width,ge=(u.clientY-W.top)/W.height,Se=E.getState().updateLocation;Se(m,{coordinates:[Z,ge]}),E.getState().saveDataToIndexedDB(),T(!1)},de=()=>{k(!y),R&&(N(!1),A(null))},me=async()=>{const u=await d();alert(u.message)},ve=()=>l?i(l.id).map(m=>{if(!m.coordinates)return null;const[b,D]=m.coordinates,W=(l==null?void 0:l.id)===m.id;return r.jsx(ni,{title:y?"Drag to move, click to edit":m.name,arrow:!0,placement:"top",children:r.jsxs(j,{sx:{position:"absolute",left:`${b*100}%`,top:`${D*100}%`,transform:"translate(-50%, -50%)",zIndex:5,cursor:y?"move":"pointer",transition:"all 0.2s ease-in-out","&:hover":{transform:"translate(-50%, -50%) scale(1.2)"}},onClick:Z=>J(m,Z),draggable:y,onDragStart:Z=>De(m.id,Z),children:[r.jsx(Me,{color:W?"primary":y?"secondary":"error",sx:{fontSize:W?"2.5rem":"2rem",filter:"drop-shadow(0px 0px 4px rgba(0, 0, 0, 0.9))"}}),r.jsx(z,{variant:"caption",sx:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",whiteSpace:"nowrap",backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white",padding:"2px 6px",borderRadius:"4px",fontSize:"0.7rem",fontWeight:"bold",textAlign:"center",maxWidth:"120px",overflow:"hidden",textOverflow:"ellipsis",filter:"drop-shadow(0px 0px 2px rgba(0, 0, 0, 0.5))"},children:m.name})]})},m.id)}):null,he=(u,m=0)=>{const b=i(u.id),D=b.length>0;return r.jsxs(re.Fragment,{children:[r.jsx(ye,{disablePadding:!0,sx:{pl:m*2},children:r.jsxs(Pa,{selected:(l==null?void 0:l.id)===u.id,onClick:W=>J(u,W),children:[r.jsx(Be,{sx:{minWidth:36},children:r.jsx(Me,{})}),r.jsx(xe,{primary:u.name}),D&&r.jsx(ne,{size:"small"})]})}),D&&r.jsx(Yi,{in:(l==null?void 0:l.id)===u.id,timeout:"auto",unmountOnExit:!0,children:r.jsx(Xe,{disablePadding:!0,children:b.map(W=>he(W,m+1))})})]},u.id)},Ee=()=>{if(!l)return null;E.getState().mapConfig.worldWidth,E.getState().mapConfig.worldHeight;const u=.3;return e.filter(m=>{var b;return((b=l.connectedLocations)==null?void 0:b.includes(m.id))&&m.id!==l.id}).map(m=>{if(!l.coordinates||!m.coordinates)return null;const[b,D]=l.coordinates,[W,Z]=m.coordinates,ge=W-b,Se=Z-D,sa=Math.atan2(Se,ge)*(180/Math.PI)+90,He=Math.sqrt(ge*ge+Se*Se),la=ge/He,da=Se/He,ua=.5,ca=.5,fa=ua+la*u,pa=ca+da*u;return r.jsx(ni,{title:`${m.name} (${He.toFixed(1)} meters)`,placement:"top",arrow:!0,children:r.jsx(ne,{onClick:Pi=>{Pi.stopPropagation(),J(m,Pi)},sx:{position:"absolute",zIndex:10,color:"white",backgroundColor:"rgba(0,0,0,0.5)","&:hover":{backgroundColor:"rgba(0,0,0,0.8)"},left:`${fa*100}%`,top:`${pa*100}%`,transform:"translate(-50%, -50%)"},children:r.jsx(na,{fontSize:"large",sx:{transform:`rotate(${sa}deg)`}})})},`tooltip-${m.id}`)})},$e=u=>{Pe(m=>({...m,[u]:!m[u]}))},ue=u=>s.filter(m=>m.locationId===u),h=u=>{const m=ue(u),b=i(u);let D=[...m];return b.forEach(W=>{const Z=h(W.id);D=[...D,...Z]}),D},P=()=>{if(!l)return null;const u=ue(l.id),m=h(l.id),b=m.length>u.length;return m.length===0?r.jsx(j,{sx:{p:2},children:r.jsx(z,{variant:"body2",color:"text.secondary",children:"No NPCs in this location"})}):r.jsx(j,{children:r.jsxs(Xe,{dense:!0,children:[u.length>0&&r.jsxs(r.Fragment,{children:[r.jsx(ye,{children:r.jsx(xe,{primary:`NPCs in ${l.name}`,primaryTypographyProps:{variant:"subtitle1",fontWeight:"bold"}})}),u.map(D=>r.jsxs(ye,{children:[r.jsx(Be,{children:D.type==="npc"?r.jsx(Ei,{fontSize:"small"}):r.jsx(zi,{fontSize:"small"})}),r.jsx(xe,{primary:D.name,secondary:D.description})]},D.id)),b&&r.jsx(Aa,{sx:{my:1}})]}),b&&_(l.id)]})})},_=u=>{const m=i(u);return r.jsx(r.Fragment,{children:m.map(b=>{const D=ue(b.id);if(D.length===0)return null;const W=je[b.id]||!1;return r.jsxs(re.Fragment,{children:[r.jsxs(ye,{button:!0,onClick:()=>$e(b.id),sx:{bgcolor:"background.default"},children:[r.jsx(Be,{children:r.jsx(Me,{fontSize:"small"})}),r.jsx(xe,{primary:`NPCs in ${b.name}`}),W?r.jsx(Ta,{}):r.jsx(Da,{})]}),r.jsxs(Yi,{in:W,timeout:"auto",unmountOnExit:!0,children:[r.jsx(Xe,{dense:!0,component:"div",disablePadding:!0,children:D.map(Z=>r.jsxs(ye,{sx:{pl:4},children:[r.jsx(Be,{children:Z.type==="npc"?r.jsx(Ei,{fontSize:"small"}):r.jsx(zi,{fontSize:"small"})}),r.jsx(xe,{primary:Z.name,secondary:Z.description})]},Z.id))}),_(b.id)]})]},b.id)})})};return t?r.jsxs(j,{sx:{height:"calc(100vh - 64px)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"background.default"},children:[r.jsx(ke,{size:60}),r.jsx(z,{variant:"h6",sx:{mt:2},children:"Loading your campaign..."})]}):te?r.jsxs(j,{sx:{display:"flex",height:"100%",overflow:"hidden"},children:[r.jsxs(Ze,{elevation:3,sx:{width:280,height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[r.jsxs(ri,{value:v?1:0,onChange:(u,m)=>g(m===1),variant:"fullWidth",children:[r.jsx(ce,{label:"Locations"}),r.jsx(ce,{label:"Details",disabled:!l})]}),v?r.jsxs(j,{sx:{flexGrow:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[r.jsxs(j,{sx:{p:2,borderBottom:"1px solid rgba(0, 0, 0, 0.12)"},children:[r.jsxs(j,{sx:{display:"flex",alignItems:"center",mb:1},children:[r.jsx(ne,{size:"small",onClick:()=>g(!1),sx:{mr:1},children:r.jsx(ga,{fontSize:"small"})}),r.jsx(z,{variant:"h6",noWrap:!0,children:l==null?void 0:l.name}),y&&r.jsx(ne,{size:"small",color:"primary",onClick:()=>{l&&(A(l),N(!0))},sx:{ml:"auto"},children:r.jsx(Ai,{fontSize:"small"})})]}),(l==null?void 0:l.description)&&r.jsx(z,{variant:"body2",color:"text.secondary",children:l.description})]}),r.jsxs(j,{sx:{overflow:"auto",flexGrow:1},children:[r.jsxs(ri,{value:ie,onChange:(u,m)=>Ae(m),variant:"fullWidth",sx:{borderBottom:1,borderColor:"divider"},children:[r.jsx(ce,{label:"Info"}),r.jsx(ce,{label:"NPCs"})]}),ie===0&&r.jsxs(j,{sx:{p:2},children:[(l==null?void 0:l.backgroundMusic)&&r.jsxs(j,{sx:{mb:2},children:[r.jsx(z,{variant:"subtitle2",children:"Background Music:"}),r.jsx(Qe,{icon:r.jsx(Ti,{}),label:l.backgroundMusic,size:"small",color:"primary",variant:"outlined",onClick:()=>{l!=null&&l.backgroundMusic&&n(l.backgroundMusic,{replace:!0,locationId:l.id,loop:!0})}})]}),(l==null?void 0:l.entrySound)&&r.jsxs(j,{sx:{mb:2},children:[r.jsx(z,{variant:"subtitle2",children:"Entry Sound:"}),r.jsx(Qe,{icon:r.jsx(Ti,{}),label:l.entrySound,size:"small",color:"secondary",variant:"outlined",onClick:()=>{l!=null&&l.entrySound&&n(l.entrySound,{replace:!1,locationId:l.id})}})]}),(l==null?void 0:l.connectedLocations)&&l.connectedLocations.length>0&&r.jsxs(j,{sx:{mb:2},children:[r.jsx(z,{variant:"subtitle2",children:"Connected Locations:"}),r.jsx(j,{sx:{display:"flex",flexWrap:"wrap",gap:1,mt:1},children:l.connectedLocations.map(u=>{const m=e.find(b=>b.id===u);return m?r.jsx(Qe,{icon:r.jsx(Me,{}),label:m.name,size:"small",color:"info",variant:"outlined",onClick:()=>J(m,{})},u):null})})]})]}),ie===1&&P()]})]}):r.jsx(Xe,{sx:{overflowY:"auto",flexGrow:1,"& .MuiListItemButton-root.Mui-selected":{bgcolor:"primary.light","&:hover":{bgcolor:"primary.light"}}},children:a().map(u=>he(u))})]}),r.jsxs(j,{sx:{flexGrow:1,position:"relative",height:"100%",overflow:"hidden"},children:[r.jsx(Sa,{ariaLabel:"Edit mode",sx:{position:"absolute",bottom:16,right:16,zIndex:100},icon:y?r.jsx(Di,{}):r.jsx(Ai,{}),onClick:de,children:y&&r.jsx(ba,{icon:r.jsx(ya,{}),tooltipTitle:"Save Changes",onClick:me})}),r.jsxs(j,{ref:B,sx:{width:"100%",height:"100%",position:"relative",bgcolor:"#2C3333",userSelect:"none",cursor:y?"crosshair":"default",backgroundSize:"cover",backgroundPosition:"center",overflow:"hidden"},children:[t?r.jsxs(j,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0, 0, 0, 0.2)"},children:[r.jsx(ke,{size:60}),r.jsx(z,{variant:"body1",sx:{mt:2},children:"Loading map..."})]}):!Q||!l?r.jsxs(j,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0, 0, 0, 0.1)"},children:[r.jsx(oa,{sx:{fontSize:60,opacity:.7}}),r.jsx(z,{variant:"body1",sx:{mt:2,opacity:.7},children:"No map image available"})]}):r.jsx(Hn,{initialScale:1,initialPositionX:0,initialPositionY:0,minScale:.5,maxScale:5,wheel:{step:.1},limitToBounds:!1,disablePadding:!0,disabled:y,children:()=>r.jsx(r.Fragment,{children:r.jsx(Un,{wrapperStyle:{width:"100%",height:"100%",position:"absolute",top:0,left:0,zIndex:0},contentStyle:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:r.jsxs(j,{sx:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"},onClick:y?Te:void 0,onDragOver:y?Ye:void 0,onDrop:y?pe:void 0,children:[r.jsx("img",{ref:L,src:Q,alt:(l==null?void 0:l.name)||"Map",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",position:"relative",zIndex:1},onLoad:()=>F(!1),onError:()=>F(!1)}),ve(),Ee()]})})})},"main-map"),!te&&!t&&r.jsx(j,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},children:r.jsxs(j,{sx:{textAlign:"center",maxWidth:400,p:3,bgcolor:"rgba(0,0,0,0.8)",color:"white",borderRadius:2},children:[r.jsx(z,{variant:"h5",gutterBottom:!0,children:"No locations found"}),r.jsx(z,{variant:"body1",paragraph:!0,children:"Your campaign doesn't have any locations yet. Import data or create locations in edit mode."}),r.jsx(V,{variant:"contained",color:"primary",sx:{mr:1},onClick:()=>C(!0),children:"Import Assets"}),r.jsx(V,{variant:"outlined",color:"secondary",onClick:de,children:y?"Exit Edit Mode":"Enter Edit Mode"})]})})]})]}),r.jsxs(ti,{open:R,onClose:()=>N(!1),maxWidth:"md",fullWidth:!0,children:[r.jsxs(oi,{children:["Edit Location",r.jsx(ne,{"aria-label":"close",onClick:()=>N(!1),sx:{position:"absolute",right:8,top:8},children:r.jsx(Di,{})})]}),r.jsx(si,{dividers:!0,children:w&&r.jsxs(xa,{spacing:2,children:[r.jsx(Ne,{label:"Name",fullWidth:!0,value:w.name,onChange:u=>A({...w,name:u.target.value})}),r.jsx(Ne,{label:"Description",fullWidth:!0,multiline:!0,rows:4,value:w.description,onChange:u=>A({...w,description:u.target.value})}),w&&w.coordinates&&r.jsxs(j,{sx:{display:"flex",gap:2},children:[r.jsx(Ne,{label:"X Coordinate",type:"number",InputProps:{inputProps:{min:0,max:1,step:.01}},value:w.coordinates[0],onChange:u=>{if(w.coordinates){const m=parseFloat(u.target.value),b=w.coordinates[1];A({...w,coordinates:[m,b]})}}}),r.jsx(Ne,{label:"Y Coordinate",type:"number",InputProps:{inputProps:{min:0,max:1,step:.01}},value:w.coordinates[1],onChange:u=>{if(w.coordinates){const m=w.coordinates[0],b=parseFloat(u.target.value);A({...w,coordinates:[m,b]})}}})]}),r.jsxs(Ge,{fullWidth:!0,children:[r.jsx(Je,{children:"Background Map Image"}),r.jsxs(Ie,{value:w.imageUrl||"",label:"Background Map Image",onChange:u=>A({...w,imageUrl:u.target.value||void 0}),children:[r.jsx(be,{value:"",children:"None"}),$.map(u=>r.jsx(be,{value:u,children:u},u))]})]}),r.jsxs(Ge,{fullWidth:!0,children:[r.jsx(Je,{children:"Background Music"}),r.jsxs(Ie,{value:w.backgroundMusic||"",label:"Background Music",onChange:u=>A({...w,backgroundMusic:u.target.value||void 0}),children:[r.jsx(be,{value:"",children:"None"}),q.map(u=>r.jsx(be,{value:u,children:u},u))]})]}),r.jsxs(Ge,{fullWidth:!0,children:[r.jsx(Je,{children:"Entry Sound"}),r.jsxs(Ie,{value:w.entrySound||"",label:"Entry Sound",onChange:u=>A({...w,entrySound:u.target.value||void 0}),children:[r.jsx(be,{value:"",children:"None"}),q.map(u=>r.jsx(be,{value:u,children:u},u))]})]}),r.jsx(wa,{control:r.jsx(Ca,{checked:w.mixWithParent||!1,onChange:u=>A({...w,mixWithParent:u.target.checked})}),label:"Mix audio with parent location"})]})}),r.jsxs(Ri,{children:[w&&r.jsx(V,{color:"error",startIcon:r.jsx(ja,{}),onClick:()=>{if(window.confirm("Are you sure you want to delete this location? This cannot be undone.")){const u=E.getState().deleteLocation;u(w.id),E.getState().saveDataToIndexedDB(),N(!1),A(null)}},children:"Delete"}),r.jsx(V,{onClick:()=>N(!1),children:"Cancel"}),r.jsx(V,{onClick:()=>{if(w){const u=E.getState().updateLocation;u(w.id,w),E.getState().saveDataToIndexedDB(),N(!1),A(null)}},variant:"contained",children:"Save"})]})]}),r.jsxs(ti,{open:S,onClose:()=>C(!1),maxWidth:"md",fullWidth:!0,children:[r.jsx(oi,{children:r.jsxs(j,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:["Asset Manager",r.jsx(ne,{edge:"end",onClick:()=>C(!1),children:r.jsx(mi,{})})]})}),r.jsx(si,{dividers:!0,children:r.jsx(Zi,{onAssetImport:ae})})]}),r.jsx(Ya,{})]}):r.jsx(j,{sx:{height:"calc(100vh - 64px)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:4,backgroundColor:"background.default"},children:r.jsxs(Ze,{elevation:3,sx:{maxWidth:600,width:"100%",p:4,display:"flex",flexDirection:"column",alignItems:"center",backgroundColor:"rgba(45, 45, 45, 0.9)"},children:[r.jsx(z,{variant:"h4",gutterBottom:!0,align:"center",sx:{mb:2},children:"Welcome to Pen & Paper Project"}),r.jsx(z,{variant:"body1",paragraph:!0,align:"center",children:"No campaign assets found. Please upload a zip file containing your campaign assets to get started."}),r.jsx(z,{variant:"body2",paragraph:!0,align:"center",color:"text.secondary",sx:{mb:3},children:'Your zip file should contain an "audio" folder for sound files, an "images" folder for location images, and a "data" folder with your "locations.json" and "characters.json" files.'}),r.jsx(Zi,{onAssetImport:ae,isFullPage:!0})]})})};export{gr as MapView};

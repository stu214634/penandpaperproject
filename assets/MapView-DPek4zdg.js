import{i as Hi,j as r,B as b,G as ji,d as P,P as Qe,O as Pi,Q as je,L as U,I as K,a0 as jn,a1 as Ue,a2 as ce,M as Ti,a3 as Ne,e as pe,l as Pe,m as Ge,a4 as Pn,n as Je,a5 as Tn,o as J,a6 as An,r as Ai,q as ee,a7 as zi,a8 as Yi,f as H,a9 as zn,g as fe,h as R,z as Ie,aa as ei,ab as ki,ac as _e,k as ge,ad as Yn,E as Di,y as Xi}from"./mui-vendor-BNyFSCPN.js";import{a as re,r as T,i as kn}from"./react-vendor-BzdEknB4.js";import{r as Ri,u as X,A as Ei,M as ie,d as Me,a as Dn,b as Be,c as xe,e as Xn}from"./index-B572UWve.js";import{h as En}from"./utilities-BTDtKTyc.js";import"./map-vendor-CMk8R3PE.js";var V=function(e,t){return Number(e.toFixed(t))},Wn=function(e,t){return t},E=function(e,t,i){i&&typeof i=="function"&&i(e,t)},Nn=function(e){return-Math.cos(e*Math.PI)/2+.5},_n=function(e){return e},Mn=function(e){return e*e},Bn=function(e){return e*(2-e)},On=function(e){return e<.5?2*e*e:-1+(4-2*e)*e},Ln=function(e){return e*e*e},Zn=function(e){return--e*e*e+1},Hn=function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},Rn=function(e){return e*e*e*e},Fn=function(e){return 1- --e*e*e*e},$n=function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},Vn=function(e){return e*e*e*e*e},Kn=function(e){return 1+--e*e*e*e*e},qn=function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e},Fi={easeOut:Nn,linear:_n,easeInQuad:Mn,easeOutQuad:Bn,easeInOutQuad:On,easeInCubic:Ln,easeOutCubic:Zn,easeInOutCubic:Hn,easeInQuart:Rn,easeOutQuart:Fn,easeInOutQuart:$n,easeInQuint:Vn,easeOutQuint:Kn,easeInOutQuint:qn},$i=function(e){typeof e=="number"&&cancelAnimationFrame(e)},q=function(e){e.mounted&&($i(e.animation),e.animate=!1,e.animation=null,e.velocity=null)};function Vi(e,t,i,n){if(e.mounted){var a=new Date().getTime(),o=1;q(e),e.animation=function(){if(!e.mounted)return $i(e.animation);var s=new Date().getTime()-a,l=s/i,c=Fi[t],m=c(l);s>=i?(n(o),e.animation=null):e.animation&&(n(m),requestAnimationFrame(e.animation))},requestAnimationFrame(e.animation)}}function Qn(e){var t=e.scale,i=e.positionX,n=e.positionY;return!(Number.isNaN(t)||Number.isNaN(i)||Number.isNaN(n))}function ae(e,t,i,n){var a=Qn(t);if(!(!e.mounted||!a)){var o=e.setTransformState,s=e.transformState,l=s.scale,c=s.positionX,m=s.positionY,f=t.scale-l,v=t.positionX-c,d=t.positionY-m;i===0?o(t.scale,t.positionX,t.positionY):Vi(e,n,i,function(y){var w=l+f*y,C=c+v*y,z=m+d*y;o(w,C,z)})}}function Un(e,t,i){var n=e.offsetWidth,a=e.offsetHeight,o=t.offsetWidth,s=t.offsetHeight,l=o*i,c=s*i,m=n-l,f=a-c;return{wrapperWidth:n,wrapperHeight:a,newContentWidth:l,newDiffWidth:m,newContentHeight:c,newDiffHeight:f}}var Gn=function(e,t,i,n,a,o,s){var l=e>t?i*(s?1:.5):0,c=n>a?o*(s?1:.5):0,m=e-t-l,f=l,v=n-a-c,d=c;return{minPositionX:m,maxPositionX:f,minPositionY:v,maxPositionY:d}},si=function(e,t){var i=e.wrapperComponent,n=e.contentComponent,a=e.setup.centerZoomedOut;if(!i||!n)throw new Error("Components are not mounted");var o=Un(i,n,t),s=o.wrapperWidth,l=o.wrapperHeight,c=o.newContentWidth,m=o.newDiffWidth,f=o.newContentHeight,v=o.newDiffHeight,d=Gn(s,c,m,l,f,v,!!a);return d},ri=function(e,t,i,n){return n?e<t?V(t,2):e>i?V(i,2):V(e,2):V(e,2)},me=function(e,t){var i=si(e,t);return e.bounds=i,i};function Ae(e,t,i,n,a,o,s){var l=i.minPositionX,c=i.minPositionY,m=i.maxPositionX,f=i.maxPositionY,v=0,d=0;s&&(v=a,d=o);var y=ri(e,l-v,m+v,n),w=ri(t,c-d,f+d,n);return{x:y,y:w}}function Ze(e,t,i,n,a,o){var s=e.transformState,l=s.scale,c=s.positionX,m=s.positionY,f=n-l;if(typeof t!="number"||typeof i!="number")return console.error("Mouse X and Y position were not provided!"),{x:c,y:m};var v=c-t*f,d=m-i*f,y=Ae(v,d,a,o,0,0,null);return y}function ze(e,t,i,n,a){var o=a?n:0,s=t-o;return!Number.isNaN(i)&&e>=i?i:!Number.isNaN(t)&&e<=s?s:e}var Wi=function(e,t){var i=e.setup.panning.excluded,n=e.isInitialized,a=e.wrapperComponent,o=t.target,s="shadowRoot"in o&&"composedPath"in t,l=s?t.composedPath().some(function(f){return f instanceof Element?a==null?void 0:a.contains(f):!1}):a==null?void 0:a.contains(o),c=n&&o&&l;if(!c)return!1;var m=He(o,i);return!m},Ni=function(e){var t=e.isInitialized,i=e.isPanning,n=e.setup,a=n.panning.disabled,o=t&&i&&!a;return!!o},Jn=function(e,t){var i=e.transformState,n=i.positionX,a=i.positionY;e.isPanning=!0;var o=t.clientX,s=t.clientY;e.startCoords={x:o-n,y:s-a}},In=function(e,t){var i=t.touches,n=e.transformState,a=n.positionX,o=n.positionY;e.isPanning=!0;var s=i.length===1;if(s){var l=i[0].clientX,c=i[0].clientY;e.startCoords={x:l-a,y:c-o}}};function er(e){var t=e.transformState,i=t.positionX,n=t.positionY,a=t.scale,o=e.setup,s=o.disabled,l=o.limitToBounds,c=o.centerZoomedOut,m=e.wrapperComponent;if(!(s||!m||!e.bounds)){var f=e.bounds,v=f.maxPositionX,d=f.minPositionX,y=f.maxPositionY,w=f.minPositionY,C=i>v||i<d,z=n>y||n<w,N=i>v?m.offsetWidth:e.setup.minPositionX||0,S=n>y?m.offsetHeight:e.setup.minPositionY||0,W=Ze(e,N,S,a,e.bounds,l||c),Q=W.x,L=W.y;return{scale:a,positionX:C?Q:i,positionY:z?L:n}}}function Ki(e,t,i,n,a){var o=e.setup.limitToBounds,s=e.wrapperComponent,l=e.bounds,c=e.transformState,m=c.scale,f=c.positionX,v=c.positionY;if(!(s===null||l===null||t===f&&i===v)){var d=Ae(t,i,l,o,n,a,s),y=d.x,w=d.y;e.setTransformState(m,y,w)}}var ir=function(e,t,i){var n=e.startCoords,a=e.transformState,o=e.setup.panning,s=o.lockAxisX,l=o.lockAxisY,c=a.positionX,m=a.positionY;if(!n)return{x:c,y:m};var f=t-n.x,v=i-n.y,d=s?c:f,y=l?m:v;return{x:d,y}},te=function(e,t){var i=e.setup,n=e.transformState,a=n.scale,o=i.minScale,s=i.disablePadding;return t>0&&a>=o&&!s?t:0},nr=function(e){var t=e.mounted,i=e.setup,n=i.disabled,a=i.velocityAnimation,o=e.transformState.scale,s=a.disabled,l=!s||o>1||!n||t;return!!l},rr=function(e){var t=e.mounted,i=e.velocity,n=e.bounds,a=e.setup,o=a.disabled,s=a.velocityAnimation,l=e.transformState.scale,c=s.disabled,m=!c||l>1||!o||t;return!(!m||!i||!n)};function tr(e,t){var i=e.setup.velocityAnimation,n=i.equalToMove,a=i.animationTime,o=i.sensitivity;return n?a*t*o:a}function _i(e,t,i,n,a,o,s,l,c,m){if(a){if(t>s&&i>s){var f=s+(e-s)*m;return f>c?c:f<s?s:f}if(t<o&&i<o){var f=o+(e-o)*m;return f<l?l:f>o?o:f}}return n?t:ri(e,o,s,a)}function ar(e,t){var i=1;return t?Math.min(i,e.offsetWidth/window.innerWidth):i}function or(e,t){var i=nr(e);if(i){var n=e.lastMousePosition,a=e.velocityTime,o=e.setup,s=e.wrapperComponent,l=o.velocityAnimation.equalToMove,c=Date.now();if(n&&a&&s){var m=ar(s,l),f=t.x-n.x,v=t.y-n.y,d=f/m,y=v/m,w=c-a,C=f*f+v*v,z=Math.sqrt(C)/w;e.velocity={velocityX:d,velocityY:y,total:z}}e.lastMousePosition=t,e.velocityTime=c}}function sr(e){var t=e.velocity,i=e.bounds,n=e.setup,a=e.wrapperComponent,o=rr(e);if(!(!o||!t||!i||!a)){var s=t.velocityX,l=t.velocityY,c=t.total,m=i.maxPositionX,f=i.minPositionX,v=i.maxPositionY,d=i.minPositionY,y=n.limitToBounds,w=n.alignmentAnimation,C=n.zoomAnimation,z=n.panning,N=z.lockAxisY,S=z.lockAxisX,W=C.animationType,Q=w.sizeX,L=w.sizeY,A=w.velocityAlignmentTime,B=A,F=tr(e,c),O=Math.max(F,B),$=te(e,Q),Z=te(e,L),oe=$*a.offsetWidth/100,G=Z*a.offsetHeight/100,Ye=m+oe,se=f-oe,ke=v+G,he=d-G,ye=e.transformState,De=new Date().getTime();Vi(e,W,O,function(be){var ve=e.transformState,Re=ve.scale,Y=ve.positionX,I=ve.positionY,Fe=new Date().getTime()-De,Se=Fe/B,M=Fi[w.animationType],Xe=1-M(Math.min(1,Se)),Ee=1-be,le=Y+s*Ee,de=I+l*Ee,$e=_i(le,ye.positionX,Y,S,y,f,m,se,Ye,Xe),Ve=_i(de,ye.positionY,I,N,y,d,v,he,ke,Xe);(Y!==le||I!==de)&&e.setTransformState(Re,$e,Ve)})}}function Mi(e,t){var i=e.transformState.scale;q(e),me(e,i),window.TouchEvent!==void 0&&t instanceof TouchEvent?In(e,t):Jn(e,t)}function li(e,t){var i=e.transformState.scale,n=e.setup,a=n.minScale,o=n.alignmentAnimation,s=o.disabled,l=o.sizeX,c=o.sizeY,m=o.animationTime,f=o.animationType,v=s||i<a||!l&&!c;if(!v){var d=er(e);d&&ae(e,d,t??m,f)}}function Bi(e,t,i){var n=e.startCoords,a=e.setup,o=a.alignmentAnimation,s=o.sizeX,l=o.sizeY;if(n){var c=ir(e,t,i),m=c.x,f=c.y,v=te(e,s),d=te(e,l);or(e,{x:m,y:f}),Ki(e,m,f,v,d)}}function lr(e){if(e.isPanning){var t=e.setup.panning.velocityDisabled,i=e.velocity,n=e.wrapperComponent,a=e.contentComponent;e.isPanning=!1,e.animate=!1,e.animation=null;var o=n==null?void 0:n.getBoundingClientRect(),s=a==null?void 0:a.getBoundingClientRect(),l=(o==null?void 0:o.width)||0,c=(o==null?void 0:o.height)||0,m=(s==null?void 0:s.width)||0,f=(s==null?void 0:s.height)||0,v=l<m||c<f,d=!t&&i&&(i==null?void 0:i.total)>.1&&v;d?sr(e):li(e)}}function di(e,t,i,n){var a=e.setup,o=a.minScale,s=a.maxScale,l=a.limitToBounds,c=ze(V(t,2),o,s,0,!1),m=me(e,c),f=Ze(e,i,n,c,m,l),v=f.x,d=f.y;return{scale:c,positionX:v,positionY:d}}function qi(e,t,i){var n=e.transformState.scale,a=e.wrapperComponent,o=e.setup,s=o.minScale,l=o.limitToBounds,c=o.zoomAnimation,m=c.disabled,f=c.animationTime,v=c.animationType,d=m||n>=s;if((n>=1||l)&&li(e),!(d||!a||!e.mounted)){var y=t||a.offsetWidth/2,w=i||a.offsetHeight/2,C=di(e,s,y,w);C&&ae(e,C,f,v)}}var ne=function(){return ne=Object.assign||function(t){for(var i,n=1,a=arguments.length;n<a;n++){i=arguments[n];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}return t},ne.apply(this,arguments)};function Oi(e,t,i){for(var n=0,a=t.length,o;n<a;n++)(o||!(n in t))&&(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}var Oe={scale:1,positionX:0,positionY:0},Te={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,allowLeftClickPan:!0,allowMiddleClickPan:!0,allowRightClickPan:!0,wheelPanning:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},ti={wrapperClass:"react-transform-wrapper",contentClass:"react-transform-component"},Qi=function(e){var t,i,n,a;return{previousScale:(t=e.initialScale)!==null&&t!==void 0?t:Oe.scale,scale:(i=e.initialScale)!==null&&i!==void 0?i:Oe.scale,positionX:(n=e.initialPositionX)!==null&&n!==void 0?n:Oe.positionX,positionY:(a=e.initialPositionY)!==null&&a!==void 0?a:Oe.positionY}},Li=function(e){var t=ne({},Te);return Object.keys(e).forEach(function(i){var n=typeof e[i]<"u",a=typeof Te[i]<"u";if(a&&n){var o=Object.prototype.toString.call(Te[i]),s=o==="[object Object]",l=o==="[object Array]";s?t[i]=ne(ne({},Te[i]),e[i]):l?t[i]=Oi(Oi([],Te[i],!0),e[i]):t[i]=e[i]}}),t},Ui=function(e,t,i){var n=e.transformState.scale,a=e.wrapperComponent,o=e.setup,s=o.maxScale,l=o.minScale,c=o.zoomAnimation,m=o.smooth,f=c.size;if(!a)throw new Error("Wrapper is not mounted");var v=m?n*Math.exp(t*i):n+t*i,d=ze(V(v,3),l,s,f,!1);return d};function Gi(e,t,i,n,a){var o=e.wrapperComponent,s=e.transformState,l=s.scale,c=s.positionX,m=s.positionY;if(!o)return console.error("No WrapperComponent found");var f=o.offsetWidth,v=o.offsetHeight,d=(f/2-c)/l,y=(v/2-m)/l,w=Ui(e,t,i),C=di(e,w,d,y);if(!C)return console.error("Error during zoom event. New transformation state was not calculated.");ae(e,C,n,a)}function Ji(e,t,i,n){var a=e.setup,o=e.wrapperComponent,s=a.limitToBounds,l=Qi(e.props),c=e.transformState,m=c.scale,f=c.positionX,v=c.positionY;if(o){var d=si(e,l.scale),y=Ae(l.positionX,l.positionY,d,s,0,0,o),w={scale:l.scale,positionX:y.x,positionY:y.y};m===l.scale&&f===l.positionX&&v===l.positionY||(n==null||n(),ae(e,w,t,i))}}function dr(e,t,i,n){var a=e.getBoundingClientRect(),o=t.getBoundingClientRect(),s=i.getBoundingClientRect(),l=o.x*n.scale,c=o.y*n.scale;return{x:(a.x-s.x+l)/n.scale,y:(a.y-s.y+c)/n.scale}}function ur(e,t,i){var n=e.wrapperComponent,a=e.contentComponent,o=e.transformState,s=e.setup,l=s.limitToBounds,c=s.minScale,m=s.maxScale;if(!n||!a)return o;var f=n.getBoundingClientRect(),v=t.getBoundingClientRect(),d=dr(t,n,a,o),y=d.x,w=d.y,C=v.width/o.scale,z=v.height/o.scale,N=n.offsetWidth/C,S=n.offsetHeight/z,W=ze(i||Math.min(N,S),c,m,0,!1),Q=(f.width-C*W)/2,L=(f.height-z*W)/2,A=(f.left-y)*W+Q,B=(f.top-w)*W+L,F=si(e,W),O=Ae(A,B,F,l,0,0,n),$=O.x,Z=O.y;return{positionX:$,positionY:Z,scale:W}}var cr=function(e){return function(t,i,n){t===void 0&&(t=.5),i===void 0&&(i=300),n===void 0&&(n="easeOut"),Gi(e,1,t,i,n)}},pr=function(e){return function(t,i,n){t===void 0&&(t=.5),i===void 0&&(i=300),n===void 0&&(n="easeOut"),Gi(e,-1,t,i,n)}},fr=function(e){return function(t,i,n,a,o){a===void 0&&(a=300),o===void 0&&(o="easeOut");var s=e.transformState,l=s.positionX,c=s.positionY,m=s.scale,f=e.wrapperComponent,v=e.contentComponent,d=e.setup.disabled;if(!(d||!f||!v)){var y={positionX:Number.isNaN(t)?l:t,positionY:Number.isNaN(i)?c:i,scale:Number.isNaN(n)?m:n};ae(e,y,a,o)}}},mr=function(e){return function(t,i){t===void 0&&(t=200),i===void 0&&(i="easeOut"),Ji(e,t,i)}},hr=function(e){return function(t,i,n){i===void 0&&(i=200),n===void 0&&(n="easeOut");var a=e.transformState,o=e.wrapperComponent,s=e.contentComponent;if(o&&s){var l=Ii(t||a.scale,o,s);ae(e,l,i,n)}}},vr=function(e){return function(t,i,n,a){n===void 0&&(n=600),a===void 0&&(a="easeOut"),q(e);var o=e.wrapperComponent,s=typeof t=="string"?document.getElementById(t):t;if(o&&s&&o.contains(s)){var l=ur(e,s,i);ae(e,l,n,a)}}},ai=function(e){return{instance:e,zoomIn:cr(e),zoomOut:pr(e),setTransform:fr(e),resetTransform:mr(e),centerView:hr(e),zoomToElement:vr(e)}},gr=function(e){return{instance:e,state:e.transformState}},D=function(e){var t={};return Object.assign(t,gr(e)),Object.assign(t,ai(e)),t},ii=!1;function ni(){try{var e={get passive(){return ii=!0,!1}};return e}catch{return ii=!1,ii}}var Le=".".concat(ti.wrapperClass),He=function(e,t){return t.some(function(i){return e.matches("".concat(Le," ").concat(i,", ").concat(Le," .").concat(i,", ").concat(Le," ").concat(i," *, ").concat(Le," .").concat(i," *"))})},oi=function(e){e&&clearTimeout(e)},xr=function(e,t,i){return"translate(".concat(e,"px, ").concat(t,"px) scale(").concat(i,")")},Ii=function(e,t,i){var n=i.offsetWidth*e,a=i.offsetHeight*e,o=(t.offsetWidth-n)/2,s=(t.offsetHeight-a)/2;return{scale:e,positionX:o,positionY:s}};function yr(e){return function(t){e.forEach(function(i){typeof i=="function"?i(t):i!=null&&(i.current=t)})}}var br=function(e,t){var i=e.setup.wheel,n=i.disabled,a=i.wheelDisabled,o=i.touchPadDisabled,s=i.excluded,l=e.isInitialized,c=e.isPanning,m=t.target,f=l&&!c&&!n&&m;if(!f||a&&!t.ctrlKey||o&&t.ctrlKey)return!1;var v=He(m,s);return!v},Sr=function(e){return e?e.deltaY<0?1:-1:0};function wr(e,t){var i=Sr(e),n=Wn(t,i);return n}function en(e,t,i){var n=t.getBoundingClientRect(),a=0,o=0;if("clientX"in e)a=(e.clientX-n.left)/i,o=(e.clientY-n.top)/i;else{var s=e.touches[0];a=(s.clientX-n.left)/i,o=(s.clientY-n.top)/i}return(Number.isNaN(a)||Number.isNaN(o))&&console.error("No mouse or touch offset found"),{x:a,y:o}}var Cr=function(e,t,i,n,a){var o=e.transformState.scale,s=e.wrapperComponent,l=e.setup,c=l.maxScale,m=l.minScale,f=l.zoomAnimation,v=l.disablePadding,d=f.size,y=f.disabled;if(!s)throw new Error("Wrapper is not mounted");var w=o+t*i,C=n?!1:!y,z=ze(V(w,3),m,c,d,C&&!v);return z},jr=function(e,t){var i=e.previousWheelEvent,n=e.transformState.scale,a=e.setup,o=a.maxScale,s=a.minScale;return i?n<o||n>s||Math.sign(i.deltaY)!==Math.sign(t.deltaY)||i.deltaY>0&&i.deltaY<t.deltaY||i.deltaY<0&&i.deltaY>t.deltaY||Math.sign(i.deltaY)!==Math.sign(t.deltaY):!1},Pr=function(e,t){var i=e.setup.pinch,n=i.disabled,a=i.excluded,o=e.isInitialized,s=t.target,l=o&&!n&&s;if(!l)return!1;var c=He(s,a);return!c},Tr=function(e){var t=e.setup.pinch.disabled,i=e.isInitialized,n=e.pinchStartDistance,a=i&&!t&&n;return!!a},Ar=function(e,t,i){var n=i.getBoundingClientRect(),a=e.touches,o=V(a[0].clientX-n.left,5),s=V(a[0].clientY-n.top,5),l=V(a[1].clientX-n.left,5),c=V(a[1].clientY-n.top,5);return{x:(o+l)/2/t,y:(s+c)/2/t}},nn=function(e){return Math.sqrt(Math.pow(e.touches[0].pageX-e.touches[1].pageX,2)+Math.pow(e.touches[0].pageY-e.touches[1].pageY,2))},zr=function(e,t){var i=e.pinchStartScale,n=e.pinchStartDistance,a=e.setup,o=a.maxScale,s=a.minScale,l=a.zoomAnimation,c=a.disablePadding,m=l.size,f=l.disabled;if(!i||n===null||!t)throw new Error("Pinch touches distance was not provided");if(t<0)return e.transformState.scale;var v=t/n,d=v*i;return ze(V(d,2),s,o,m,!f&&!c)},Yr=160,kr=100,Dr=function(e,t){var i=e.props,n=i.onWheelStart,a=i.onZoomStart;e.wheelStopEventTimer||(q(e),E(D(e),t,n),E(D(e),t,a))},Xr=function(e,t){var i=e.props,n=i.onWheel,a=i.onZoom,o=e.contentComponent,s=e.setup,l=e.transformState,c=l.scale,m=s.limitToBounds,f=s.centerZoomedOut,v=s.zoomAnimation,d=s.wheel,y=s.disablePadding,w=s.smooth,C=v.size,z=v.disabled,N=d.step,S=d.smoothStep;if(!o)throw new Error("Component not mounted");t.preventDefault(),t.stopPropagation();var W=wr(t,null),Q=w?S*Math.abs(t.deltaY):N,L=Cr(e,W,Q,!t.ctrlKey);if(c!==L){var A=me(e,L),B=en(t,o,c),F=z||C===0||f||y,O=m&&F,$=Ze(e,B.x,B.y,L,A,O),Z=$.x,oe=$.y;e.previousWheelEvent=t,e.setTransformState(L,Z,oe),E(D(e),t,n),E(D(e),t,a)}},Er=function(e,t){var i=e.props,n=i.onWheelStop,a=i.onZoomStop;oi(e.wheelAnimationTimer),e.wheelAnimationTimer=setTimeout(function(){e.mounted&&(qi(e,t.x,t.y),e.wheelAnimationTimer=null)},kr);var o=jr(e,t);o&&(oi(e.wheelStopEventTimer),e.wheelStopEventTimer=setTimeout(function(){e.mounted&&(e.wheelStopEventTimer=null,E(D(e),t,n),E(D(e),t,a))},Yr))},rn=function(e){for(var t=0,i=0,n=0;n<2;n+=1)t+=e.touches[n].clientX,i+=e.touches[n].clientY;var a=t/2,o=i/2;return{x:a,y:o}},Wr=function(e,t){var i=nn(t);e.pinchStartDistance=i,e.lastDistance=i,e.pinchStartScale=e.transformState.scale,e.isPanning=!1;var n=rn(t);e.pinchLastCenterX=n.x,e.pinchLastCenterY=n.y,q(e)},Nr=function(e,t){var i=e.contentComponent,n=e.pinchStartDistance,a=e.wrapperComponent,o=e.transformState.scale,s=e.setup,l=s.limitToBounds,c=s.centerZoomedOut,m=s.zoomAnimation,f=s.alignmentAnimation,v=m.disabled,d=m.size;if(!(n===null||!i)){var y=Ar(t,o,i);if(!(!Number.isFinite(y.x)||!Number.isFinite(y.y))){var w=nn(t),C=zr(e,w),z=rn(t),N=z.x-(e.pinchLastCenterX||0),S=z.y-(e.pinchLastCenterY||0);if(!(C===o&&N===0&&S===0)){e.pinchLastCenterX=z.x,e.pinchLastCenterY=z.y;var W=me(e,C),Q=v||d===0||c,L=l&&Q,A=Ze(e,y.x,y.y,C,W,L),B=A.x,F=A.y;e.pinchMidpoint=y,e.lastDistance=w;var O=f.sizeX,$=f.sizeY,Z=te(e,O),oe=te(e,$),G=B+N,Ye=F+S,se=Ae(G,Ye,W,l,Z,oe,a),ke=se.x,he=se.y;e.setTransformState(C,ke,he)}}}},_r=function(e){var t=e.pinchMidpoint;e.velocity=null,e.lastDistance=null,e.pinchMidpoint=null,e.pinchStartScale=null,e.pinchStartDistance=null,qi(e,t==null?void 0:t.x,t==null?void 0:t.y)},tn=function(e,t){var i=e.props.onZoomStop,n=e.setup.doubleClick.animationTime;oi(e.doubleClickStopEventTimer),e.doubleClickStopEventTimer=setTimeout(function(){e.doubleClickStopEventTimer=null,E(D(e),t,i)},n)},Mr=function(e,t){var i=e.props,n=i.onZoomStart,a=i.onZoom,o=e.setup.doubleClick,s=o.animationTime,l=o.animationType;E(D(e),t,n),Ji(e,s,l,function(){return E(D(e),t,a)}),tn(e,t)};function Br(e,t){return e==="toggle"?t===1?1:-1:e==="zoomOut"?-1:1}function Or(e,t){var i=e.setup,n=e.doubleClickStopEventTimer,a=e.transformState,o=e.contentComponent,s=a.scale,l=e.props,c=l.onZoomStart,m=l.onZoom,f=i.doubleClick,v=f.disabled,d=f.mode,y=f.step,w=f.animationTime,C=f.animationType;if(!v&&!n){if(d==="reset")return Mr(e,t);if(!o)return console.error("No ContentComponent found");var z=Br(d,e.transformState.scale),N=Ui(e,z,y);if(s!==N){E(D(e),t,c);var S=en(t,o,s),W=di(e,N,S.x,S.y);if(!W)return console.error("Error during zoom event. New transformation state was not calculated.");E(D(e),t,m),ae(e,W,w,C),tn(e,t)}}}var Lr=function(e,t){var i=e.isInitialized,n=e.setup,a=e.wrapperComponent,o=n.doubleClick,s=o.disabled,l=o.excluded,c=t.target,m=a==null?void 0:a.contains(c),f=i&&c&&m&&!s;if(!f)return!1;var v=He(c,l);return!v},Zr=function(){function e(t){var i=this;this.mounted=!0,this.pinchLastCenterX=null,this.pinchLastCenterY=null,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.isWheelPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){i.initializeWindowEvents()},this.unmount=function(){i.cleanupWindowEvents()},this.update=function(n){i.props=n,me(i,i.transformState.scale),i.setup=Li(n)},this.initializeWindowEvents=function(){var n,a,o=ni(),s=(n=i.wrapperComponent)===null||n===void 0?void 0:n.ownerDocument,l=s==null?void 0:s.defaultView;(a=i.wrapperComponent)===null||a===void 0||a.addEventListener("wheel",i.onWheelPanning,o),l==null||l.addEventListener("mousedown",i.onPanningStart,o),l==null||l.addEventListener("mousemove",i.onPanning,o),l==null||l.addEventListener("mouseup",i.onPanningStop,o),s==null||s.addEventListener("mouseleave",i.clearPanning,o),l==null||l.addEventListener("keyup",i.setKeyUnPressed,o),l==null||l.addEventListener("keydown",i.setKeyPressed,o)},this.cleanupWindowEvents=function(){var n,a,o=ni(),s=(n=i.wrapperComponent)===null||n===void 0?void 0:n.ownerDocument,l=s==null?void 0:s.defaultView;l==null||l.removeEventListener("mousedown",i.onPanningStart,o),l==null||l.removeEventListener("mousemove",i.onPanning,o),l==null||l.removeEventListener("mouseup",i.onPanningStop,o),s==null||s.removeEventListener("mouseleave",i.clearPanning,o),l==null||l.removeEventListener("keyup",i.setKeyUnPressed,o),l==null||l.removeEventListener("keydown",i.setKeyPressed,o),document.removeEventListener("mouseleave",i.clearPanning,o),q(i),(a=i.observer)===null||a===void 0||a.disconnect()},this.handleInitializeWrapperEvents=function(n){var a=ni();n.addEventListener("wheel",i.onWheelZoom,a),n.addEventListener("dblclick",i.onDoubleClick,a),n.addEventListener("touchstart",i.onTouchPanningStart,a),n.addEventListener("touchmove",i.onTouchPanning,a),n.addEventListener("touchend",i.onTouchPanningStop,a)},this.handleInitialize=function(n,a){var o=!1,s=i.setup.centerOnInit,l=function(c,m){for(var f=0,v=c;f<v.length;f++){var d=v[f];if(d.target===m)return!0}return!1};i.applyTransformation(),i.onInitCallbacks.forEach(function(c){c(D(i))}),i.observer=new ResizeObserver(function(c){if(l(c,n)||l(c,a))if(s&&!o){var m=a.offsetWidth,f=a.offsetHeight;(m>0||f>0)&&(o=!0,i.setCenter())}else q(i),me(i,i.transformState.scale),li(i,0)}),i.observer.observe(n),i.observer.observe(a)},this.onWheelZoom=function(n){var a=i.setup.disabled;if(!a){var o=br(i,n);if(o){var s=i.isPressingKeys(i.setup.wheel.activationKeys);s&&(Dr(i,n),Xr(i,n),Er(i,n))}}},this.onWheelPanning=function(n){var a=i.setup,o=a.disabled,s=a.wheel,l=a.panning;if(!(!i.wrapperComponent||!i.contentComponent||o||!s.wheelDisabled||l.disabled||!l.wheelPanning||n.ctrlKey)){n.preventDefault(),n.stopPropagation();var c=i.transformState,m=c.positionX,f=c.positionY,v=m-n.deltaX,d=f-n.deltaY,y=l.lockAxisX?m:v,w=l.lockAxisY?f:d,C=i.setup.alignmentAnimation,z=C.sizeX,N=C.sizeY,S=te(i,z),W=te(i,N);y===m&&w===f||Ki(i,y,w,S,W)}},this.onPanningStart=function(n){var a=i.setup.disabled,o=i.props.onPanningStart;if(!a){var s=Wi(i,n);if(s){var l=i.isPressingKeys(i.setup.panning.activationKeys);l&&(n.button===0&&!i.setup.panning.allowLeftClickPan||n.button===1&&!i.setup.panning.allowMiddleClickPan||n.button===2&&!i.setup.panning.allowRightClickPan||(n.preventDefault(),n.stopPropagation(),q(i),Mi(i,n),E(D(i),n,o)))}}},this.onPanning=function(n){var a=i.setup.disabled,o=i.props.onPanning;if(!a){var s=Ni(i);if(s){var l=i.isPressingKeys(i.setup.panning.activationKeys);l&&(n.preventDefault(),n.stopPropagation(),Bi(i,n.clientX,n.clientY),E(D(i),n,o))}}},this.onPanningStop=function(n){var a=i.props.onPanningStop;i.isPanning&&(lr(i),E(D(i),n,a))},this.onPinchStart=function(n){var a=i.setup.disabled,o=i.props,s=o.onPinchingStart,l=o.onZoomStart;if(!a){var c=Pr(i,n);c&&(Wr(i,n),q(i),E(D(i),n,s),E(D(i),n,l))}},this.onPinch=function(n){var a=i.setup.disabled,o=i.props,s=o.onPinching,l=o.onZoom;if(!a){var c=Tr(i);c&&(n.preventDefault(),n.stopPropagation(),Nr(i,n),E(D(i),n,s),E(D(i),n,l))}},this.onPinchStop=function(n){var a=i.props,o=a.onPinchingStop,s=a.onZoomStop;i.pinchStartScale&&(_r(i),E(D(i),n,o),E(D(i),n,s))},this.onTouchPanningStart=function(n){var a=i.setup.disabled,o=i.props.onPanningStart;if(!a){var s=Wi(i,n);if(s){var l=i.lastTouch&&+new Date-i.lastTouch<200&&n.touches.length===1;if(!l){i.lastTouch=+new Date,q(i);var c=n.touches,m=c.length===1,f=c.length===2;m&&(q(i),Mi(i,n),E(D(i),n,o)),f&&i.onPinchStart(n)}}}},this.onTouchPanning=function(n){var a=i.setup.disabled,o=i.props.onPanning;if(i.isPanning&&n.touches.length===1){if(a)return;var s=Ni(i);if(!s)return;n.preventDefault(),n.stopPropagation();var l=n.touches[0];Bi(i,l.clientX,l.clientY),E(D(i),n,o)}else n.touches.length>1&&i.onPinch(n)},this.onTouchPanningStop=function(n){i.onPanningStop(n),i.onPinchStop(n)},this.onDoubleClick=function(n){var a=i.setup.disabled;if(!a){var o=Lr(i,n);o&&Or(i,n)}},this.clearPanning=function(n){i.isPanning&&i.onPanningStop(n)},this.setKeyPressed=function(n){i.pressedKeys[n.key]=!0},this.setKeyUnPressed=function(n){i.pressedKeys[n.key]=!1},this.isPressingKeys=function(n){return n.length?!!n.find(function(a){return i.pressedKeys[a]}):!0},this.setTransformState=function(n,a,o){var s=i.props.onTransformed;if(!Number.isNaN(n)&&!Number.isNaN(a)&&!Number.isNaN(o)){n!==i.transformState.scale&&(i.transformState.previousScale=i.transformState.scale,i.transformState.scale=n),i.transformState.positionX=a,i.transformState.positionY=o,i.applyTransformation();var l=D(i);i.onChangeCallbacks.forEach(function(c){return c(l)}),E(l,{scale:n,positionX:a,positionY:o},s)}else console.error("Detected NaN set state values")},this.setCenter=function(){if(i.wrapperComponent&&i.contentComponent){var n=Ii(i.transformState.scale,i.wrapperComponent,i.contentComponent);i.setTransformState(n.scale,n.positionX,n.positionY)}},this.handleTransformStyles=function(n,a,o){return i.props.customTransform?i.props.customTransform(n,a,o):xr(n,a,o)},this.applyTransformation=function(){if(!(!i.mounted||!i.contentComponent)){var n=i.transformState,a=n.scale,o=n.positionX,s=n.positionY,l=i.handleTransformStyles(o,s,a);i.contentComponent.style.transform=l}},this.getContext=function(){return D(i)},this.onChange=function(n){return i.onChangeCallbacks.has(n)||i.onChangeCallbacks.add(n),function(){i.onChangeCallbacks.delete(n)}},this.onInit=function(n){return i.onInitCallbacks.has(n)||i.onInitCallbacks.add(n),function(){i.onInitCallbacks.delete(n)}},this.init=function(n,a){i.cleanupWindowEvents(),i.wrapperComponent=n,i.contentComponent=a,me(i,i.transformState.scale),i.handleInitializeWrapperEvents(n),i.handleInitialize(n,a),i.initializeWindowEvents(),i.isInitialized=!0;var o=D(i);E(o,void 0,i.props.onInit)},this.props=t,this.setup=Li(this.props),this.transformState=Qi(this.props)}return e}(),ui=re.createContext(null),Hr=function(e,t){return typeof e=="function"?e(t):e},Rr=re.forwardRef(function(e,t){var i=T.useRef(new Zr(e)).current,n=Hr(e.children,ai(i));return T.useImperativeHandle(t,function(){return ai(i)},[i]),T.useEffect(function(){i.update(e)},[i,e]),re.createElement(ui.Provider,{value:i},n)});re.forwardRef(function(e,t){var i=T.useRef(null),n=T.useContext(ui);return T.useEffect(function(){return n.onChange(function(a){if(i.current){var o=0,s=0;i.current.style.transform=n.handleTransformStyles(o,s,1/a.instance.transformState.scale)}})},[n]),re.createElement("div",ne({},e,{ref:yr([i,t])}))});function Fr(e,t){t===void 0&&(t={});var i=t.insertAt;if(!(typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",i==="top"&&n.firstChild?n.insertBefore(a,n.firstChild):n.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}var $r=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
  transform: translate3d(0, 0, 0);
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,Zi={wrapper:"transform-component-module_wrapper__SPB86",content:"transform-component-module_content__FBWxo"};Fr($r);var Vr=function(e){var t=e.children,i=e.wrapperClass,n=i===void 0?"":i,a=e.contentClass,o=a===void 0?"":a,s=e.wrapperStyle,l=e.contentStyle,c=e.wrapperProps,m=c===void 0?{}:c,f=e.contentProps,v=f===void 0?{}:f,d=T.useContext(ui),y=d.init,w=d.cleanupWindowEvents,C=T.useRef(null),z=T.useRef(null);return T.useEffect(function(){var N=C.current,S=z.current;return N!==null&&S!==null&&y&&(y==null||y(N,S)),function(){w==null||w()}},[]),re.createElement("div",ne({},m,{ref:C,className:"".concat(ti.wrapperClass," ").concat(Zi.wrapper," ").concat(n),style:s}),re.createElement("div",ne({},v,{ref:z,className:"".concat(ti.contentClass," ").concat(Zi.content," ").concat(o),style:l}),t))},ci={},Kr=Hi;Object.defineProperty(ci,"__esModule",{value:!0});var an=ci.default=void 0,qr=Kr(Ri()),Qr=r;an=ci.default=(0,qr.default)((0,Qr.jsx)("path",{d:"m5 9 1.41 1.41L11 5.83V22h2V5.83l4.59 4.59L19 9l-7-7z"}),"North");var pi={},Ur=Hi;Object.defineProperty(pi,"__esModule",{value:!0});var on=pi.default=void 0,Gr=Ur(Ri()),Jr=r;on=pi.default=(0,Gr.default)((0,Jr.jsx)("path",{d:"m21.9 21.9-8.49-8.49-9.82-9.82L2.1 2.1.69 3.51 3 5.83V19c0 1.1.9 2 2 2h13.17l2.31 2.31zM5 18l3.5-4.5 2.5 3.01L12.17 15l3 3zm16 .17L5.83 3H19c1.1 0 2 .9 2 2z"}),"ImageNotSupported");const tt=()=>{const e=kn(),t=X(u=>u.locations),i=X(u=>u.playTrack);X(u=>u.stopTrack);const n=X(u=>u.getSublocationsByParentId),a=X(u=>u.getAllTopLevelLocations),o=X(u=>u.refreshAssets);X(u=>u.hasAssets);const s=X(u=>u.isLoading),l=X(u=>u.characters),c=X(u=>u.combats),m=X(u=>u.saveDataToIndexedDB),f=X(u=>u.selectedLocationId),v=X(u=>u.setSelectedLocationId),[d,y]=T.useState(null),[w,C]=T.useState(!1),[z,N]=T.useState(!1),[S,W]=T.useState(!1),[Q,L]=T.useState(!1),[A,B]=T.useState(null),[F,O]=T.useState(!1),$=T.useRef(null),Z=T.useRef(null),[oe,G]=T.useState(!1),[Ye,se]=T.useState([]),[ke,he]=T.useState([]),ye=t.length>0,[De,be]=T.useState(""),[ve,Re]=T.useState({}),[Y,I]=T.useState(null),[Fe,Se]=T.useState(!1),[M,Xe]=T.useState(null),[Ee,le]=T.useState(!1),[de,$e]=T.useState(0),[Ve,We]=T.useState(!1);T.useEffect(()=>{if(t.length>0)if(f){const u=t.find(p=>p.id===f);if(u)y(u),C(!0);else{const p=a();p.length>0&&(y(p[0]),v(p[0].id))}}else{const u=a();u.length>0&&(y(u[0]),v(u[0].id))}},[t,f]),T.useEffect(()=>{d&&((async()=>{G(!0);try{if(d.imageUrl){const p=await Be.getAssetUrl("images",d.imageUrl);be(p)}else be("")}catch(p){console.error("Error loading image:",p),be("")}finally{G(!1)}})(),v(d.id))},[d==null?void 0:d.id,d==null?void 0:d.imageUrl]),T.useEffect(()=>{if(F){const u=async()=>{try{const h=await Be.getAssets("audio");se(h.map(g=>g.name))}catch(h){console.error("Failed to load audio assets:",h),se([])}},p=async()=>{try{const h=await Be.getAssets("images");he(h.map(g=>g.name))}catch(h){console.error("Failed to load image assets:",h),he([])}};u(),p()}},[F]);const we=async(u,p)=>{if(p.stopPropagation(),S){B(u),O(!0);return}if((d==null?void 0:d.id)!==u.id){if(y(u),C(!0),u.entrySound){const h=await Be.getAssetUrl("audio",u.entrySound);h&&new En.Howl({src:[h],loop:!1,volume:X.getState().volume}).play()}if(u.backgroundMusic){const h=`/audio/${u.backgroundMusic}`,j=!(!!u.parentLocationId&&u.mixWithParent===!0);i(h,{replace:j,locationId:u.id})}}else C(!w)},fi=async()=>{if(await o(),d){const u=d.id;y(null),setTimeout(()=>{const p=t.find(h=>h.id===u);p&&y(p)},100)}},sn=u=>{if(!S||!d||!$.current||!Z.current)return;const p=Z.current.getBoundingClientRect(),h=(u.clientX-p.left)/p.width,g=(u.clientY-p.top)/p.height,j={name:"New Location",description:"Add a description",coordinates:[h,g],parentLocationId:d.id},_=X.getState().addLocation;_(j),X.getState().saveDataToIndexedDB()},ln=(u,p)=>{if(!S)return;const h=new Image;h.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",p.dataTransfer.setDragImage(h,0,0),p.dataTransfer.setData("locationId",u),L(!0)},dn=u=>{S&&u.preventDefault()},un=u=>{if(!S||!$.current||!Z.current)return;u.preventDefault();const p=u.dataTransfer.getData("locationId");if(!p||!X.getState().locations.find(ue=>ue.id===p))return;const j=Z.current.getBoundingClientRect(),_=(u.clientX-j.left)/j.width,x=(u.clientY-j.top)/j.height,k=X.getState().updateLocation;k(p,{coordinates:[_,x]}),X.getState().saveDataToIndexedDB(),L(!1)},mi=()=>{W(!S),F&&(O(!1),B(null))},cn=async()=>{const u=await m();alert(u.message)},pn=()=>d?n(d.id).map(p=>{if(!p.coordinates)return null;const[h,g]=p.coordinates,j=(d==null?void 0:d.id)===p.id;return r.jsx(ee,{title:S?"Drag to move, click to edit":p.name,arrow:!0,placement:"top",children:r.jsxs(b,{sx:{position:"absolute",left:`${h*100}%`,top:`${g*100}%`,transform:"translate(-50%, -50%)",zIndex:5,cursor:S?"move":"pointer",transition:"all 0.2s ease-in-out","&:hover":{transform:"translate(-50%, -50%) scale(1.2)"}},onClick:_=>we(p,_),draggable:S,onDragStart:_=>ln(p.id,_),children:[r.jsx(Ne,{color:j?"primary":S?"secondary":"error",sx:{fontSize:j?"2.5rem":"2rem",filter:"drop-shadow(0px 0px 4px rgba(0, 0, 0, 0.9))"}}),r.jsx(P,{variant:"caption",sx:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",whiteSpace:"nowrap",backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white",padding:"2px 6px",borderRadius:"4px",fontSize:"0.7rem",fontWeight:"bold",textAlign:"center",maxWidth:"120px",overflow:"hidden",textOverflow:"ellipsis",filter:"drop-shadow(0px 0px 2px rgba(0, 0, 0, 0.5))"},children:p.name})]})},p.id)}):null,hi=(u,p=0)=>{const h=n(u.id),g=h.length>0;return r.jsxs(re.Fragment,{children:[r.jsx(H,{disablePadding:!0,sx:{pl:p*2},children:r.jsxs(zn,{selected:(d==null?void 0:d.id)===u.id,onClick:j=>we(u,j),children:[r.jsx(fe,{sx:{minWidth:36},children:r.jsx(Ne,{})}),r.jsx(R,{primary:u.name}),g&&r.jsx(K,{size:"small"})]})}),g&&r.jsx(Ie,{in:(d==null?void 0:d.id)===u.id,timeout:"auto",unmountOnExit:!0,children:r.jsx(U,{disablePadding:!0,children:h.map(j=>hi(j,p+1))})})]},u.id)},fn=()=>{if(!d)return null;X.getState().mapConfig.worldWidth,X.getState().mapConfig.worldHeight;const u=.3;return t.filter(p=>{var h;return((h=d.connectedLocations)==null?void 0:h.includes(p.id))&&p.id!==d.id}).map(p=>{if(!d.coordinates||!p.coordinates)return null;const[h,g]=d.coordinates,[j,_]=p.coordinates,x=j-h,k=_-g,Ce=Math.atan2(k,x)*(180/Math.PI)+90,qe=Math.sqrt(x*x+k*k),xn=x/qe,yn=k/qe,bn=.5,Sn=.5,wn=bn+xn*u,Cn=Sn+yn*u;return r.jsx(ee,{title:`${p.name} (${qe.toFixed(1)} meters)`,placement:"top",arrow:!0,children:r.jsx(K,{onClick:Ci=>{Ci.stopPropagation(),we(p,Ci)},sx:{position:"absolute",zIndex:10,color:"white",backgroundColor:"rgba(0,0,0,0.5)","&:hover":{backgroundColor:"rgba(0,0,0,0.8)"},left:`${wn*100}%`,top:`${Cn*100}%`,transform:"translate(-50%, -50%)"},children:r.jsx(an,{fontSize:"large",sx:{transform:`rotate(${Ce}deg)`}})})},`tooltip-${p.id}`)})},vi=u=>{Re(p=>({...p,[u]:!p[u]}))},Ke=u=>l.filter(p=>p.locationId===u),gi=u=>{const p=Ke(u),h=n(u);let g=[...p];return h.forEach(j=>{const _=gi(j.id);g=[...g,..._]}),g},xi=(u,p)=>{p.stopPropagation(),I(u),Se(!0)},mn=()=>{if(!d)return null;const u=Ke(d.id),p=gi(d.id),h=p.length>u.length;return p.length===0?r.jsx(b,{sx:{p:2},children:r.jsx(P,{variant:"body2",color:"text.secondary",children:"No NPCs in this location"})}):r.jsx(b,{children:r.jsxs(U,{dense:!0,children:[u.length>0&&r.jsxs(r.Fragment,{children:[r.jsx(H,{children:r.jsx(R,{primary:`NPCs in ${d.name}`,primaryTypographyProps:{variant:"subtitle1",fontWeight:"bold"}})}),u.map(g=>r.jsxs(H,{button:!0,onClick:j=>xi(g,j),sx:{cursor:"pointer"},children:[r.jsx(fe,{children:g.type==="npc"?r.jsx(ei,{fontSize:"small"}):g.type==="merchant"?r.jsx(ki,{fontSize:"small"}):r.jsx(xe,{color:"error",fontSize:"small"})}),r.jsx(R,{primary:r.jsxs(b,{sx:{display:"flex",alignItems:"center"},children:[g.name,g.descriptionType==="markdown"&&r.jsx(ee,{title:"Uses Markdown formatting",children:r.jsx(b,{component:"span",sx:{display:"flex",ml:1,color:"text.secondary"},children:r.jsx(_e,{fontSize:"small"})})})]}),secondary:r.jsx(b,{sx:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",lineHeight:1.2,fontSize:"0.875rem"},children:g.descriptionType==="markdown"?r.jsx(ie,{content:g.description.length>80?`${g.description.substring(0,80)}...`:g.description,sx:{fontSize:"0.8rem",lineHeight:1.2,"& h1, & h2, & h3, & h4, & h5, & h6":{fontSize:"0.9rem",my:.5},"& p":{my:.5}}}):g.description.length>80?`${g.description.substring(0,80)}...`:g.description})})]},g.id)),h&&r.jsx(ge,{sx:{my:1}})]}),h&&yi(d.id)]})})},yi=u=>{const p=n(u);return r.jsx(r.Fragment,{children:p.map(h=>{const g=Ke(h.id);if(g.length===0)return null;const j=`npc-section-${h.id}`,_=ve[j]||!1;return r.jsxs(b,{children:[r.jsxs(H,{button:!0,onClick:()=>vi(j),sx:{pl:2},children:[r.jsx(R,{primary:h.name,primaryTypographyProps:{variant:"subtitle2"}}),_?r.jsx(Di,{}):r.jsx(Xi,{})]}),r.jsx(Ie,{in:_,timeout:"auto",unmountOnExit:!0,children:r.jsx(U,{component:"div",disablePadding:!0,children:g.map(x=>r.jsxs(H,{button:!0,onClick:k=>xi(x,k),sx:{pl:4,cursor:"pointer"},children:[r.jsx(fe,{children:x.type==="npc"?r.jsx(ei,{fontSize:"small"}):x.type==="merchant"?r.jsx(ki,{fontSize:"small"}):r.jsx(xe,{color:"error",fontSize:"small"})}),r.jsx(R,{primary:r.jsxs(b,{sx:{display:"flex",alignItems:"center"},children:[x.name,x.descriptionType==="markdown"&&r.jsx(ee,{title:"Uses Markdown formatting",children:r.jsx(b,{component:"span",sx:{display:"flex",ml:1,color:"text.secondary"},children:r.jsx(_e,{fontSize:"small"})})})]}),secondary:r.jsx(b,{sx:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",lineHeight:1.2,fontSize:"0.875rem"},children:x.descriptionType==="markdown"?r.jsx(ie,{content:x.description.length>80?`${x.description.substring(0,80)}...`:x.description,sx:{fontSize:"0.8rem",lineHeight:1.2,"& h1, & h2, & h3, & h4, & h5, & h6":{fontSize:"0.9rem",my:.5},"& p":{my:.5}}}):x.description.length>80?`${x.description.substring(0,80)}...`:x.description})})]},x.id))})}),yi(h.id)]},h.id)})})},hn=()=>{var _;if(!Y)return null;const u=((_=t.find(x=>x.id===Y.locationId))==null?void 0:_.name)||"Unknown",p=X.getState().updateCharacter,h=()=>{if(!Y||!S)return;const x={id:crypto.randomUUID(),name:"New Item",description:"Item description",quantity:1},k=[...Y.inventory||[],x];p(Y.id,{inventory:k}),I({...Y,inventory:k})},g=(x,k)=>{if(!Y||!S)return;const ue=(Y.inventory||[]).map(Ce=>Ce.id===x?{...Ce,...k}:Ce);p(Y.id,{inventory:ue}),I({...Y,inventory:ue})},j=x=>{if(!Y||!S)return;const k=(Y.inventory||[]).filter(ue=>ue.id!==x);p(Y.id,{inventory:k}),I({...Y,inventory:k})};return r.jsxs(b,{sx:{p:2,minWidth:300,maxWidth:400},children:[r.jsxs(b,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[r.jsx(P,{variant:"h6",children:Y.name}),r.jsx(K,{onClick:()=>Se(!1),size:"small",children:r.jsx(Me,{})})]}),r.jsx(P,{variant:"subtitle1",color:"text.secondary",children:Y.type==="npc"?"NPC":Y.type==="merchant"?"Merchant":"Enemy"}),Y.descriptionType==="markdown"&&r.jsx(b,{sx:{mt:1,mb:2},children:r.jsx(ie,{content:Y.description})}),(!Y.descriptionType||Y.descriptionType!=="markdown")&&r.jsx(P,{variant:"body2",paragraph:!0,children:Y.description}),r.jsxs(b,{sx:{mb:2},children:[r.jsx(P,{variant:"subtitle2",children:"Location:"}),r.jsx(P,{variant:"body2",children:u})]}),r.jsx(ge,{sx:{my:2}}),r.jsxs(b,{sx:{mb:1,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx(P,{variant:"h6",children:"Inventory"}),S&&r.jsx(K,{size:"small",onClick:h,color:"primary",children:r.jsx(Xn,{})})]}),!Y.inventory||Y.inventory.length===0?r.jsx(P,{variant:"body2",color:"text.secondary",children:"No items in inventory"}):r.jsx(U,{dense:!0,children:Y.inventory.map(x=>r.jsx(H,{secondaryAction:S?r.jsx(K,{edge:"end",size:"small",onClick:()=>j(x.id),children:r.jsx(Yn,{fontSize:"small"})}):null,children:r.jsx(R,{primary:S?r.jsx(J,{size:"small",value:x.name,onChange:k=>g(x.id,{name:k.target.value}),fullWidth:!0,variant:"standard",margin:"dense"}):x.name,secondary:r.jsxs(r.Fragment,{children:[S?r.jsx(J,{size:"small",value:x.description,onChange:k=>g(x.id,{description:k.target.value}),fullWidth:!0,variant:"standard",margin:"dense",multiline:!0}):x.description,r.jsxs(b,{sx:{display:"flex",justifyContent:"space-between",mt:1},children:[r.jsxs(b,{children:["Qty: ",S?r.jsx(J,{size:"small",type:"number",value:x.quantity,onChange:k=>g(x.id,{quantity:parseInt(k.target.value)||0}),variant:"standard",sx:{width:50}}):x.quantity]}),x.price!==void 0&&r.jsxs(b,{children:["Price: ",S?r.jsx(J,{size:"small",type:"number",value:x.price,onChange:k=>g(x.id,{price:parseInt(k.target.value)||0}),variant:"standard",sx:{width:60}}):x.price]}),S&&x.price===void 0&&r.jsx(pe,{size:"small",onClick:()=>g(x.id,{price:0}),children:"Add Price"})]})]})})},x.id))})]})},bi=u=>{const p=c.filter(j=>j.locationId===u),h=n(u);let g=[...p];return h.forEach(j=>{const _=bi(j.id);g=[...g,..._]}),g},Si=(u,p)=>{p.stopPropagation(),Xe(u),le(!0)},vn=()=>{if(!d)return null;const u=c.filter(g=>g.locationId===d.id),p=bi(d.id),h=p.length>u.length;return p.length===0?r.jsx(b,{sx:{p:2},children:r.jsx(P,{variant:"body2",color:"text.secondary",children:"No combats in this location"})}):r.jsx(b,{children:r.jsxs(U,{dense:!0,children:[u.length>0&&r.jsxs(r.Fragment,{children:[r.jsx(H,{children:r.jsx(R,{primary:`Combats in ${d.name}`,primaryTypographyProps:{variant:"subtitle1",fontWeight:"bold"}})}),u.map(g=>r.jsxs(H,{button:!0,onClick:j=>Si(g,j),sx:{cursor:"pointer"},children:[r.jsx(fe,{children:r.jsx(xe,{color:"primary",fontSize:"small"})}),r.jsx(R,{primary:r.jsxs(b,{sx:{display:"flex",alignItems:"center"},children:[g.name,g.descriptionType==="markdown"&&r.jsx(ee,{title:"Uses Markdown formatting",children:r.jsx(b,{component:"span",sx:{display:"flex",ml:1,color:"text.secondary"},children:r.jsx(_e,{fontSize:"small"})})})]}),secondary:r.jsxs(b,{sx:{display:"flex",alignItems:"center",gap:.5},children:[r.jsx(ce,{size:"small",label:`Difficulty: ${g.difficulty||"Medium"}`,variant:"outlined"}),g.description&&g.descriptionType==="markdown"&&r.jsx(b,{sx:{display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical",overflow:"hidden",lineHeight:1.2,fontSize:"0.8rem",flex:1},children:r.jsx(ie,{content:g.description.length>40?`${g.description.substring(0,40)}...`:g.description,sx:{fontSize:"0.8rem",lineHeight:1.2,"& h1, & h2, & h3, & h4, & h5, & h6":{fontSize:"0.9rem",my:.5},"& p":{my:.5}}})})]})})]},g.id)),h&&r.jsx(ge,{sx:{my:1}})]}),h&&wi(d.id)]})})},wi=u=>{const p=n(u);return r.jsx(r.Fragment,{children:p.map(h=>{const g=c.filter(x=>x.locationId===h.id);if(g.length===0)return null;const j=`combat-section-${h.id}`,_=ve[j]||!1;return r.jsxs(b,{children:[r.jsxs(H,{button:!0,onClick:()=>vi(j),sx:{pl:2},children:[r.jsx(R,{primary:h.name,primaryTypographyProps:{variant:"subtitle2"}}),_?r.jsx(Di,{}):r.jsx(Xi,{})]}),r.jsx(Ie,{in:_,timeout:"auto",unmountOnExit:!0,children:r.jsx(U,{component:"div",disablePadding:!0,children:g.map(x=>r.jsxs(H,{button:!0,onClick:k=>Si(x,k),sx:{pl:4,cursor:"pointer"},children:[r.jsx(fe,{children:r.jsx(xe,{color:"primary",fontSize:"small"})}),r.jsx(R,{primary:r.jsxs(b,{sx:{display:"flex",alignItems:"center"},children:[x.name,x.descriptionType==="markdown"&&r.jsx(ee,{title:"Uses Markdown formatting",children:r.jsx(b,{component:"span",sx:{display:"flex",ml:1,color:"text.secondary"},children:r.jsx(_e,{fontSize:"small"})})})]}),secondary:r.jsxs(b,{sx:{display:"flex",alignItems:"center",gap:.5},children:[r.jsx(ce,{size:"small",label:`Difficulty: ${x.difficulty||"Medium"}`,variant:"outlined"}),x.description&&x.descriptionType==="markdown"&&r.jsx(b,{sx:{display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical",overflow:"hidden",lineHeight:1.2,fontSize:"0.8rem",flex:1},children:r.jsx(ie,{content:x.description.length>40?`${x.description.substring(0,40)}...`:x.description,sx:{fontSize:"0.8rem",lineHeight:1.2,"& h1, & h2, & h3, & h4, & h5, & h6":{fontSize:"0.9rem",my:.5},"& p":{my:.5}}})})]})})]},x.id))})}),wi(h.id)]},h.id)})})},gn=()=>{var p;if(!M)return null;const u=((p=t.find(h=>h.id===M.locationId))==null?void 0:p.name)||"Unknown";return r.jsxs(b,{sx:{p:2,minWidth:300,maxWidth:400},children:[r.jsxs(b,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[r.jsx(P,{variant:"h6",children:M.name}),r.jsx(K,{onClick:()=>le(!1),size:"small",children:r.jsx(Me,{})})]}),r.jsxs(P,{variant:"subtitle1",color:"text.secondary",children:["Difficulty: ",M.difficulty||"Medium"]}),M.descriptionType==="markdown"&&r.jsx(b,{sx:{mt:1,mb:2},children:r.jsx(ie,{content:M.description})}),(!M.descriptionType||M.descriptionType!=="markdown")&&r.jsx(P,{variant:"body2",paragraph:!0,children:M.description}),r.jsxs(b,{sx:{mb:2},children:[r.jsx(P,{variant:"subtitle2",children:"Location:"}),r.jsx(P,{variant:"body2",children:u})]}),r.jsx(pe,{variant:"contained",color:"primary",fullWidth:!0,startIcon:r.jsx(xe,{}),onClick:()=>{le(!1),e("/combat-session",{state:{combatId:M.id}})},sx:{mb:3},children:"Start Combat"}),r.jsx(ge,{sx:{my:2}}),r.jsx(P,{variant:"subtitle2",children:"Player Characters:"}),M.playerCharacters.length===0?r.jsx(P,{variant:"body2",color:"text.secondary",children:"No player characters assigned"}):r.jsx(U,{dense:!0,children:M.playerCharacters.map(h=>r.jsxs(H,{children:[r.jsx(fe,{children:r.jsx(ei,{fontSize:"small"})}),r.jsx(R,{primary:h.name})]},h.id))}),r.jsx(ge,{sx:{my:2}}),r.jsx(P,{variant:"subtitle2",children:"Enemies:"}),M.enemies.length===0?r.jsx(P,{variant:"body2",color:"text.secondary",children:"No enemies assigned"}):r.jsx(U,{dense:!0,children:Object.entries(M.enemies.reduce((h,g)=>(h[g.id]=h[g.id]||{enemy:g,count:0},h[g.id].count++,h),{})).map(([h,{enemy:g,count:j}])=>r.jsxs(H,{children:[r.jsx(fe,{children:r.jsx(xe,{color:"error",fontSize:"small"})}),r.jsx(R,{primary:`${g.name} ${j>1?`(x${j})`:""}`,secondary:`HP: ${g.hp}`})]},h))}),M.rewards&&M.rewards.length>0&&r.jsxs(r.Fragment,{children:[r.jsx(ge,{sx:{my:2}}),r.jsx(P,{variant:"subtitle2",children:"Rewards:"}),r.jsx(U,{dense:!0,children:M.rewards.map(h=>r.jsx(H,{children:r.jsx(R,{primary:h.name,secondary:`Quantity: ${h.quantity}`})},h.id))})]})]})};return s?r.jsxs(b,{sx:{height:"calc(100vh - 64px)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"background.default"},children:[r.jsx(ji,{size:60}),r.jsx(P,{variant:"h6",sx:{mt:2},children:"Loading your campaign..."})]}):ye?r.jsxs(b,{sx:{display:"flex",height:"100%",overflow:"hidden"},children:[r.jsxs(Qe,{elevation:3,sx:{width:280,height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",zIndex:1},children:[r.jsxs(Pi,{value:w?1:0,onChange:(u,p)=>C(p===1),variant:"fullWidth",children:[r.jsx(je,{label:"Locations"}),r.jsx(je,{label:"Details",disabled:!d})]}),w?r.jsxs(b,{sx:{flexGrow:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[r.jsxs(b,{sx:{p:2,borderBottom:"1px solid rgba(0, 0, 0, 0.12)"},children:[r.jsxs(b,{sx:{display:"flex",alignItems:"center",mb:1},children:[r.jsx(K,{size:"small",onClick:()=>C(!1),sx:{mr:1},children:r.jsx(jn,{fontSize:"small"})}),r.jsx(P,{variant:"h6",noWrap:!0,children:d==null?void 0:d.name}),S&&r.jsx(K,{size:"small",color:"primary",onClick:()=>{d&&(B(d),O(!0))},sx:{ml:"auto"},children:r.jsx(Ue,{fontSize:"small"})})]}),(d==null?void 0:d.description)&&r.jsxs(b,{onClick:()=>We(!0),sx:{cursor:"pointer","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"},borderRadius:1,p:1},children:[r.jsx(b,{sx:{display:"-webkit-box",WebkitLineClamp:4,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:r.jsx(ie,{content:d.description})}),d.description.length>200&&r.jsx(P,{variant:"caption",color:"primary",sx:{display:"block",mt:.5},children:"Click to view full description"})]})]}),r.jsxs(b,{sx:{overflow:"auto",flexGrow:1},children:[r.jsxs(Pi,{value:de,onChange:(u,p)=>$e(p),variant:"fullWidth",sx:{borderBottom:1,borderColor:"divider"},children:[r.jsx(je,{label:"Info"}),r.jsx(je,{label:"NPCs"}),r.jsx(je,{label:"Combats"})]}),de===0&&r.jsxs(b,{sx:{p:2},children:[(d==null?void 0:d.backgroundMusic)&&r.jsxs(b,{sx:{mb:2},children:[r.jsx(P,{variant:"subtitle2",children:"Background Music:"}),r.jsx(ce,{icon:r.jsx(Ti,{}),label:d.backgroundMusic,size:"small",color:"primary",variant:"outlined",onClick:()=>{d!=null&&d.backgroundMusic&&i(d.backgroundMusic,{replace:!0,locationId:d.id,loop:!0})}})]}),(d==null?void 0:d.entrySound)&&r.jsxs(b,{sx:{mb:2},children:[r.jsx(P,{variant:"subtitle2",children:"Entry Sound:"}),r.jsx(ce,{icon:r.jsx(Ti,{}),label:d.entrySound,size:"small",color:"secondary",variant:"outlined",onClick:()=>{d!=null&&d.entrySound&&i(d.entrySound,{replace:!1,locationId:d.id})}})]}),(d==null?void 0:d.connectedLocations)&&d.connectedLocations.length>0&&r.jsxs(b,{sx:{mb:2},children:[r.jsx(P,{variant:"subtitle2",children:"Connected Locations:"}),r.jsx(b,{sx:{display:"flex",flexWrap:"wrap",gap:1,mt:1},children:d.connectedLocations.map(u=>{const p=t.find(h=>h.id===u);return p?r.jsx(ce,{icon:r.jsx(Ne,{}),label:p.name,size:"small",color:"info",variant:"outlined",onClick:h=>we(p,h)},u):null})})]}),(d==null?void 0:d.sublocations)&&d.sublocations.length>0&&r.jsxs(b,{sx:{mb:2},children:[r.jsx(P,{variant:"subtitle2",children:"Sublocations:"}),r.jsx(b,{sx:{display:"flex",flexWrap:"wrap",gap:1,mt:1},children:d.sublocations.map(u=>{const p=t.find(h=>h.id===u.id);return p?r.jsx(ce,{icon:r.jsx(Ne,{}),label:p.name,size:"small",color:"info",variant:"outlined",onClick:h=>we(p,h)},u.id):null})})]})]}),de===1&&mn(),de===2&&vn()]})]}):r.jsx(U,{sx:{overflowY:"auto",flexGrow:1,"& .MuiListItemButton-root.Mui-selected":{bgcolor:"primary.light","&:hover":{bgcolor:"primary.light"}}},children:a().map(u=>hi(u))})]}),r.jsxs(b,{ref:Z,sx:{position:"relative",flex:1,height:"100%",overflow:"hidden",backgroundColor:"black",zIndex:1,cursor:S?"crosshair":"default"},onDragOver:dn,onDrop:un,onClick:sn,children:[s?r.jsxs(b,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0, 0, 0, 0.2)"},children:[r.jsx(ji,{size:60}),r.jsx(P,{variant:"body1",sx:{mt:2},children:"Loading map..."})]}):!De||!d?r.jsxs(b,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0, 0, 0, 0.1)"},children:[r.jsx(on,{sx:{fontSize:60,opacity:.7}}),r.jsx(P,{variant:"body1",sx:{mt:2,opacity:.7},children:"No map image available"})]}):r.jsx(Rr,{initialScale:1,initialPositionX:0,initialPositionY:0,minScale:.5,maxScale:5,wheel:{step:.1},limitToBounds:!1,disablePadding:!0,disabled:S,children:()=>r.jsx(r.Fragment,{children:r.jsx(Vr,{wrapperStyle:{width:"100%",height:"100%",position:"absolute",top:0,left:0,zIndex:0},contentStyle:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:r.jsxs(b,{sx:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"},children:[r.jsx("img",{ref:$,src:De,alt:(d==null?void 0:d.name)||"Map",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",position:"relative",zIndex:1},onLoad:()=>G(!1),onError:()=>G(!1)}),pn(),fn()]})})})},"main-map"),!ye&&!s&&r.jsx(b,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},children:r.jsxs(b,{sx:{textAlign:"center",maxWidth:400,p:3,bgcolor:"rgba(0,0,0,0.8)",color:"white",borderRadius:2},children:[r.jsx(P,{variant:"h5",gutterBottom:!0,children:"No locations found"}),r.jsx(P,{variant:"body1",paragraph:!0,children:"Your campaign doesn't have any locations yet. Import data or create locations in edit mode."}),r.jsx(pe,{variant:"contained",color:"primary",sx:{mr:1},onClick:()=>N(!0),children:"Import Assets"}),r.jsx(pe,{variant:"outlined",color:"secondary",onClick:mi,children:S?"Exit Edit Mode":"Enter Edit Mode"})]})})]}),r.jsxs(Pe,{open:F,onClose:()=>O(!1),maxWidth:"md",fullWidth:!0,children:[r.jsxs(Ge,{children:["Edit Location",r.jsx(K,{"aria-label":"close",onClick:()=>O(!1),sx:{position:"absolute",right:8,top:8},children:r.jsx(Pn,{})})]}),r.jsx(Je,{dividers:!0,children:A&&r.jsxs(Tn,{spacing:2,children:[r.jsx(J,{label:"Name",fullWidth:!0,value:A.name,onChange:u=>B({...A,name:u.target.value})}),r.jsx(J,{label:"Description",fullWidth:!0,multiline:!0,rows:4,value:A.description,onChange:u=>B({...A,description:u.target.value})}),r.jsx(An,{multiple:!0,options:t.filter(u=>u.id!==A.id),value:t.filter(u=>{var p;return((p=A.connectedLocations)==null?void 0:p.includes(u.id))||!1}),onChange:(u,p)=>B({...A,connectedLocations:p.map(h=>h.id)}),getOptionLabel:u=>u.name,renderInput:u=>r.jsx(J,{...u,label:"Connected Locations",fullWidth:!0,helperText:"Select locations that are connected to this one"}),isOptionEqualToValue:(u,p)=>u.id===p.id,renderTags:(u,p)=>u.map((h,g)=>T.createElement(ce,{label:h.name,...p({index:g}),key:h.id}))}),A.coordinates&&r.jsxs(b,{sx:{display:"flex",gap:2},children:[r.jsx(J,{label:"X Coordinate",type:"number",InputProps:{inputProps:{min:0,max:1,step:.01}},value:A.coordinates[0],onChange:u=>{if(A.coordinates){const p=parseFloat(u.target.value),h=A.coordinates[1];B({...A,coordinates:[p,h]})}}}),r.jsx(J,{label:"Y Coordinate",type:"number",InputProps:{inputProps:{min:0,max:1,step:.01}},value:A.coordinates[1],onChange:u=>{if(A.coordinates){const p=A.coordinates[0],h=parseFloat(u.target.value);B({...A,coordinates:[p,h]})}}})]})]})}),r.jsxs(Ai,{children:[r.jsx(pe,{onClick:()=>O(!1),children:"Cancel"}),r.jsx(pe,{onClick:()=>{if(A){const u=X.getState().updateLocation;u(A.id,{name:A.name,description:A.description,coordinates:A.coordinates,connectedLocations:A.connectedLocations}),X.getState().saveDataToIndexedDB(),O(!1)}},variant:"contained",color:"primary",children:"Save"})]})]}),r.jsxs(Pe,{open:z,onClose:()=>N(!1),maxWidth:"md",fullWidth:!0,children:[r.jsx(Ge,{children:r.jsxs(b,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:["Asset Manager",r.jsx(K,{edge:"end",onClick:()=>N(!1),children:r.jsx(Me,{})})]})}),r.jsx(Je,{dividers:!0,children:r.jsx(Ei,{onAssetImport:fi})})]}),r.jsx(Pe,{open:Fe,onClose:()=>Se(!1),maxWidth:"sm",fullWidth:!0,children:hn()}),r.jsx(Pe,{open:Ee,onClose:()=>le(!1),maxWidth:"sm",fullWidth:!0,children:gn()}),r.jsxs(Pe,{open:Ve,onClose:()=>We(!1),maxWidth:"md",fullWidth:!0,children:[r.jsxs(Ge,{children:[d==null?void 0:d.name," - Description",r.jsx(K,{"aria-label":"close",onClick:()=>We(!1),sx:{position:"absolute",right:8,top:8},children:r.jsx(Me,{})})]}),r.jsx(Je,{dividers:!0,children:r.jsx(ie,{content:(d==null?void 0:d.description)||""})}),r.jsx(Ai,{children:r.jsx(pe,{onClick:()=>We(!1),children:"Close"})})]}),r.jsx(Dn,{}),S&&r.jsxs(Qe,{elevation:4,sx:{position:"absolute",top:16,left:"50%",transform:"translateX(-50%)",zIndex:1100,padding:"8px 16px",backgroundColor:"rgba(0, 0, 0, 0.8)",color:"white",borderRadius:2,display:"flex",alignItems:"center",gap:1},children:[r.jsx(Ue,{fontSize:"small"}),r.jsx(P,{variant:"subtitle2",children:"Edit Mode Active"})]}),r.jsx(ee,{title:S?"Exit Edit Mode":"Enter Edit Mode to add, edit, and reposition locations on the map",placement:"left",children:r.jsx(zi,{color:S?"secondary":"primary","aria-label":"edit mode",sx:{position:"absolute",bottom:16,right:16,zIndex:1100},onClick:mi,children:S?r.jsx(Yi,{}):r.jsx(Ue,{})})}),S&&r.jsx(ee,{title:"Save all changes to your campaign",placement:"left",children:r.jsx(zi,{color:"success","aria-label":"save changes",sx:{position:"absolute",bottom:16,right:96,zIndex:1100},onClick:cn,children:r.jsx(Yi,{})})})]}):r.jsx(b,{sx:{height:"calc(100vh - 64px)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:4,backgroundColor:"background.default"},children:r.jsxs(Qe,{elevation:3,sx:{maxWidth:600,width:"100%",p:4,display:"flex",flexDirection:"column",alignItems:"center",backgroundColor:"rgba(45, 45, 45, 0.9)"},children:[r.jsx(P,{variant:"h4",gutterBottom:!0,align:"center",sx:{mb:2},children:"Welcome to Pen & Paper Project"}),r.jsx(P,{variant:"body1",paragraph:!0,align:"center",children:"No campaign assets found. Please upload a zip file containing your campaign assets to get started."}),r.jsx(P,{variant:"body2",paragraph:!0,align:"center",color:"text.secondary",sx:{mb:3},children:'Your zip file should contain an "audio" folder for sound files, an "images" folder for location images, and a "data" folder with your "locations.json" and "characters.json" files.'}),r.jsx(Ei,{onAssetImport:fi,isFullPage:!0})]})})};export{tt as MapView};
//# sourceMappingURL=MapView-DPek4zdg.js.map

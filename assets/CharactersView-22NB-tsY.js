import{i as w,j as e,B as c,d as l,e as h,G as ue,P as k,N as a,l as O,m as B,n as q,o as d,ae as v,af as f,ag as y,ah as o,a6 as g,q as L,I as C,r as R,ai as xe,R as me,X as je,Y as ve,a2 as S,k as fe,L as ye,f as V,h as G}from"./mui-vendor-BNyFSCPN.js";import{r as p}from"./react-vendor-BzdEknB4.js";import{r as D,u as ge,f as Ce,e as Y,g as Q,M as N,a as be,b as Ie,k as Te,c as Ae,l as ke,i as Se}from"./index-B0S_hfGj.js";import{d as Ne}from"./Edit-BJCRo16S.js";import"./map-vendor-CMk8R3PE.js";import"./utilities-BTDtKTyc.js";var _={},we=w;Object.defineProperty(_,"__esModule",{value:!0});var U=_.default=void 0,De=we(D()),_e=e;U=_.default=(0,De.default)((0,_e.jsx)("path",{d:"M20 4H4v2h16zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6zm-9 4H6v-4h6z"}),"Store");var P={},Pe=w;Object.defineProperty(P,"__esModule",{value:!0});var X=P.default=void 0,We=Pe(D()),$e=e;X=P.default=(0,We.default)((0,$e.jsx)("path",{d:"M20 2H4c-1 0-2 .9-2 2v3.01c0 .72.43 1.34 1 1.69V20c0 1.1 1.1 2 2 2h14c.9 0 2-.9 2-2V8.7c.57-.35 1-.97 1-1.69V4c0-1.1-1-2-2-2m-5 12H9v-2h6zm5-7H4V4l16-.02z"}),"Inventory");var W={},He=w;Object.defineProperty(W,"__esModule",{value:!0});var J=W.default=void 0,Me=He(D()),Ee=e;J=W.default=(0,Me.default)((0,Ee.jsx)("path",{d:"M21 6H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2m-10 7H8v3H6v-3H3v-2h3V8h2v3h3zm4.5 2c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5m4-3c-.83 0-1.5-.67-1.5-1.5S18.67 9 19.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5"}),"VideogameAsset");const Re=()=>{const[b,u]=p.useState(!1),[I,j]=p.useState(!1),[K,$]=p.useState(!1),[Z,ee]=p.useState(""),[H,M]=p.useState(!1),[E,te]=p.useState([]),{characters:T,addCharacter:se,updateCharacter:ie,deleteCharacter:ne,saveDataToIndexedDB:ae,locations:x}=ge(),[s,n]=p.useState({name:"",description:"",type:"npc",locationId:"",descriptionType:"markdown",descriptionAssetName:"",hp:10}),[z,re]=p.useState(null);p.useEffect(()=>{(b||I)&&(async()=>{const i=await Ie.getAssets("images");te(i.map(r=>r.name))})()},[b,I]);const le=()=>{const t={name:s.name,description:s.description,type:s.type,hp:typeof s.hp=="string"?parseInt(s.hp)||1:s.hp||1};s.locationId&&(t.locationId=s.locationId),t.descriptionType=s.descriptionType,s.descriptionAssetName&&(t.descriptionAssetName=s.descriptionAssetName),se(t),u(!1),A(),m("Character added successfully")},A=()=>{n({name:"",description:"",type:"npc",locationId:"",descriptionType:"markdown",descriptionAssetName:"",hp:10})},oe=t=>{const i=T.find(r=>r.id===t);i&&(re(t),n({name:i.name,description:i.description,type:i.type,locationId:i.locationId||"",descriptionType:i.descriptionType||"markdown",descriptionAssetName:i.descriptionAssetName||"",hp:i.hp}),j(!0))},de=()=>{if(z){const t={name:s.name,description:s.description,type:s.type,hp:typeof s.hp=="string"?parseInt(s.hp)||1:s.hp||1,descriptionType:s.descriptionType};s.locationId&&(t.locationId=s.locationId),s.descriptionAssetName&&(t.descriptionAssetName=s.descriptionAssetName),ie(z,t),j(!1),A(),m("Character updated successfully")}},ce=t=>{window.confirm("Are you sure you want to delete this character? This cannot be undone.")&&(ne(t),m("Character deleted successfully"))},pe=async()=>{M(!0);try{const t=await ae();m(t.message)}catch(t){m(`Error saving data: ${t instanceof Error?t.message:String(t)}`)}finally{M(!1)}},m=t=>{ee(t),$(!0)},F=()=>{$(!1)},he=t=>{const i=t.locationId?x.find(r=>r.id===t.locationId):null;return e.jsx(a,{item:!0,xs:12,sm:6,md:5,children:e.jsx(je,{children:e.jsx(ve,{children:e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs(c,{children:[e.jsx(l,{variant:"h6",children:t.name}),e.jsxs(c,{sx:{display:"flex",alignItems:"center",mt:1},children:[e.jsx(S,{icon:t.type==="npc"?e.jsx(Te,{}):t.type==="merchant"?e.jsx(U,{}):t.type==="enemy"?e.jsx(Ae,{}):e.jsx(J,{}),label:t.type==="npc"?"NPC":t.type==="merchant"?"Merchant":t.type==="enemy"?"Enemy":"Player",size:"small",color:t.type==="npc"?"primary":t.type==="merchant"?"secondary":t.type==="enemy"?"error":"success",variant:"outlined"}),i&&e.jsx(S,{icon:e.jsx(ke,{}),label:i.name,size:"small",color:"info",variant:"outlined",sx:{ml:1}}),e.jsx(S,{label:`HP: ${t.hp}`,size:"small",color:"default",variant:"outlined",sx:{ml:1}})]}),e.jsxs(c,{sx:{mt:1,mb:2},children:[t.descriptionType==="markdown"&&e.jsx(N,{content:t.description,sx:{"& table":{display:"block",maxWidth:"100%",overflow:"auto",whiteSpace:"nowrap"},"& th, & td":{px:1,py:.5,fontSize:"0.8rem"}}}),t.descriptionType!=="markdown"&&e.jsx(l,{variant:"body2",color:"text.secondary",children:t.description})]}),t.inventory&&t.inventory.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(fe,{sx:{my:2}}),e.jsxs(l,{variant:"subtitle2",gutterBottom:!0,children:[e.jsx(X,{fontSize:"small",sx:{verticalAlign:"middle",mr:.5}}),"Inventory (",t.inventory.length,")"]}),e.jsxs(ye,{dense:!0,children:[t.inventory.slice(0,3).map(r=>e.jsx(V,{disablePadding:!0,children:e.jsx(G,{primary:r.name,secondary:`Qty: ${r.quantity}${r.price?` - Price: ${r.price}`:""}`})},r.id)),t.inventory.length>3&&e.jsx(V,{disablePadding:!0,children:e.jsx(G,{primary:`+ ${t.inventory.length-3} more items`,primaryTypographyProps:{variant:"caption"}})})]})]})]}),e.jsxs(c,{children:[e.jsx(C,{onClick:()=>oe(t.id),children:e.jsx(Ne,{})}),e.jsx(C,{onClick:()=>ce(t.id),children:e.jsx(Se,{})})]})]})})})},t.id)};return e.jsxs(c,{sx:{p:3,maxWidth:1200,mx:"auto"},children:[e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(l,{variant:"h4",children:"Characters"}),e.jsxs(c,{children:[e.jsx(h,{variant:"outlined",color:"success",startIcon:e.jsx(Ce,{}),onClick:pe,disabled:H,sx:{mr:2},children:H?e.jsx(ue,{size:24}):"Save Changes"}),e.jsx(h,{variant:"contained",startIcon:e.jsx(Y,{}),onClick:()=>{A(),u(!0)},children:"Add Character"})]})]}),T.length===0?e.jsxs(k,{sx:{p:3,textAlign:"center"},children:[e.jsx(l,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No Characters Yet"}),e.jsx(l,{variant:"body1",color:"text.secondary",paragraph:!0,children:"Add your first character to get started."}),e.jsx(h,{variant:"contained",startIcon:e.jsx(Y,{}),onClick:()=>u(!0),children:"Add Character"})]}):e.jsx(a,{container:!0,spacing:3,children:T.map(t=>he(t))}),e.jsxs(O,{open:b,onClose:()=>u(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(B,{children:"Add New Character"}),e.jsx(q,{children:e.jsxs(a,{container:!0,spacing:2,sx:{mt:.5},children:[e.jsx(a,{item:!0,xs:12,md:8,children:e.jsx(d,{label:"Name",fullWidth:!0,value:s.name,onChange:t=>n({...s,name:t.target.value})})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsxs(v,{fullWidth:!0,children:[e.jsx(f,{children:"Character Type"}),e.jsxs(y,{value:s.type,label:"Character Type",onChange:t=>n({...s,type:t.target.value}),children:[e.jsx(o,{value:"npc",children:"NPC"}),e.jsx(o,{value:"merchant",children:"Merchant"}),e.jsx(o,{value:"enemy",children:"Enemy"}),e.jsx(o,{value:"player",children:"Player Character"})]})]})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(d,{label:"Hit Points (HP)",fullWidth:!0,value:s.hp,onChange:t=>{const i=t.target.value;if(i==="")n({...s,hp:""});else{const r=parseInt(i);isNaN(r)||n({...s,hp:r})}},onBlur:()=>{const t=s.hp;(t===""||t===null||isNaN(Number(t)))&&n({...s,hp:1})},helperText:"Minimum value is 1"})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(g,{options:x,value:x.find(t=>t.id===s.locationId)||null,onChange:(t,i)=>n({...s,locationId:(i==null?void 0:i.id)||""}),getOptionLabel:t=>t.name,renderInput:t=>e.jsx(d,{...t,label:"Location",fullWidth:!0}),isOptionEqualToValue:(t,i)=>t.id===i.id})}),e.jsx(a,{item:!0,xs:12,children:e.jsxs(v,{fullWidth:!0,children:[e.jsx(f,{children:"Description Type"}),e.jsxs(y,{value:s.descriptionType,label:"Description Type",onChange:t=>n({...s,descriptionType:t.target.value}),children:[e.jsx(o,{value:"markdown",children:"Markdown"}),e.jsx(o,{value:"image",children:"Image"}),e.jsx(o,{value:"pdf",children:"PDF"})]})]})}),s.descriptionType==="markdown"?e.jsxs(e.Fragment,{children:[e.jsxs(a,{item:!0,xs:12,children:[e.jsxs(c,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(l,{variant:"subtitle2",children:"Description"}),e.jsx(L,{title:e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"caption",sx:{display:"block",fontWeight:"bold"},children:"Markdown Table Example:"}),e.jsx(l,{variant:"caption",component:"pre",sx:{display:"block",mt:1,fontFamily:"monospace"},children:"| Header 1 | Header 2 | Header 3 |\\n | -------- | -------- | -------- |\\n | Cell 1   | Cell 2   | Cell 3   |\\n | Cell 4   | Cell 5   | Cell 6   |"})]}),children:e.jsx(C,{size:"small",sx:{ml:1},children:e.jsx(Q,{fontSize:"small"})})})]}),e.jsx(d,{multiline:!0,rows:6,fullWidth:!0,value:s.description,onChange:t=>n({...s,description:t.target.value})})]}),e.jsxs(a,{item:!0,xs:12,children:[e.jsx(l,{variant:"subtitle2",sx:{mt:1,mb:1},children:"Preview"}),e.jsx(k,{sx:{p:2,height:"200px",overflow:"auto",bgcolor:"background.default",border:1,borderColor:"divider"},children:e.jsx(N,{content:s.description})})]})]}):s.descriptionType==="image"||s.descriptionType==="pdf"?e.jsxs(e.Fragment,{children:[e.jsx(a,{item:!0,xs:12,children:e.jsx(g,{options:E,value:s.descriptionAssetName||null,onChange:(t,i)=>n({...s,descriptionAssetName:i||""}),renderInput:t=>e.jsx(d,{...t,label:"Description Asset",fullWidth:!0,helperText:`Select a ${s.descriptionType} file from assets`})})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(d,{label:"Brief Description",multiline:!0,rows:3,fullWidth:!0,value:s.description,onChange:t=>n({...s,description:t.target.value}),helperText:"Add a brief description text to show in lists"})})]}):null]})}),e.jsxs(R,{children:[e.jsx(h,{onClick:()=>u(!1),children:"Cancel"}),e.jsx(h,{onClick:le,variant:"contained",disabled:!s.name,children:"Add Character"})]})]}),e.jsxs(O,{open:I,onClose:()=>j(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(B,{children:"Edit Character"}),e.jsx(q,{children:e.jsxs(a,{container:!0,spacing:2,sx:{mt:.5},children:[e.jsx(a,{item:!0,xs:12,md:8,children:e.jsx(d,{label:"Name",fullWidth:!0,value:s.name,onChange:t=>n({...s,name:t.target.value})})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsxs(v,{fullWidth:!0,children:[e.jsx(f,{children:"Character Type"}),e.jsxs(y,{value:s.type,label:"Character Type",onChange:t=>n({...s,type:t.target.value}),children:[e.jsx(o,{value:"npc",children:"NPC"}),e.jsx(o,{value:"merchant",children:"Merchant"}),e.jsx(o,{value:"enemy",children:"Enemy"}),e.jsx(o,{value:"player",children:"Player Character"})]})]})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(d,{label:"Hit Points (HP)",fullWidth:!0,value:s.hp,onChange:t=>{const i=t.target.value;if(i==="")n({...s,hp:""});else{const r=parseInt(i);isNaN(r)||n({...s,hp:r})}},onBlur:()=>{const t=s.hp;(t===""||t===null||isNaN(Number(t)))&&n({...s,hp:1})},helperText:"Minimum value is 1"})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(g,{options:x,value:x.find(t=>t.id===s.locationId)||null,onChange:(t,i)=>n({...s,locationId:(i==null?void 0:i.id)||""}),getOptionLabel:t=>t.name,renderInput:t=>e.jsx(d,{...t,label:"Location",fullWidth:!0}),isOptionEqualToValue:(t,i)=>t.id===i.id})}),e.jsx(a,{item:!0,xs:12,children:e.jsxs(v,{fullWidth:!0,children:[e.jsx(f,{children:"Description Type"}),e.jsxs(y,{value:s.descriptionType,label:"Description Type",onChange:t=>n({...s,descriptionType:t.target.value}),children:[e.jsx(o,{value:"markdown",children:"Markdown"}),e.jsx(o,{value:"image",children:"Image"}),e.jsx(o,{value:"pdf",children:"PDF"})]})]})}),s.descriptionType==="markdown"?e.jsxs(e.Fragment,{children:[e.jsxs(a,{item:!0,xs:12,children:[e.jsxs(c,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(l,{variant:"subtitle2",children:"Description"}),e.jsx(L,{title:e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"caption",sx:{display:"block",fontWeight:"bold"},children:"Markdown Table Example:"}),e.jsx(l,{variant:"caption",component:"pre",sx:{display:"block",mt:1,fontFamily:"monospace"},children:"| Header 1 | Header 2 | Header 3 |\\n | -------- | -------- | -------- |\\n | Cell 1   | Cell 2   | Cell 3   |\\n | Cell 4   | Cell 5   | Cell 6   |"})]}),children:e.jsx(C,{size:"small",sx:{ml:1},children:e.jsx(Q,{fontSize:"small"})})})]}),e.jsx(d,{multiline:!0,rows:6,fullWidth:!0,value:s.description,onChange:t=>n({...s,description:t.target.value})})]}),e.jsxs(a,{item:!0,xs:12,children:[e.jsx(l,{variant:"subtitle2",sx:{mt:1,mb:1},children:"Preview"}),e.jsx(k,{sx:{p:2,height:"200px",overflow:"auto",bgcolor:"background.default",border:1,borderColor:"divider"},children:e.jsx(N,{content:s.description})})]})]}):s.descriptionType==="image"||s.descriptionType==="pdf"?e.jsxs(e.Fragment,{children:[e.jsx(a,{item:!0,xs:12,children:e.jsx(g,{options:E,value:s.descriptionAssetName||null,onChange:(t,i)=>n({...s,descriptionAssetName:i||""}),renderInput:t=>e.jsx(d,{...t,label:"Description Asset",fullWidth:!0,helperText:`Select a ${s.descriptionType} file from assets`})})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(d,{label:"Brief Description",multiline:!0,rows:3,fullWidth:!0,value:s.description,onChange:t=>n({...s,description:t.target.value}),helperText:"Add a brief description text to show in lists"})})]}):null]})}),e.jsxs(R,{children:[e.jsx(h,{onClick:()=>j(!1),children:"Cancel"}),e.jsx(h,{onClick:de,variant:"contained",disabled:!s.name,children:"Save Changes"})]})]}),e.jsx(xe,{open:K,autoHideDuration:6e3,onClose:F,children:e.jsx(me,{onClose:F,severity:"success",sx:{width:"100%"},children:Z})}),e.jsx(be,{})]})};export{Re as CharactersView};
//# sourceMappingURL=CharactersView-22NB-tsY.js.map

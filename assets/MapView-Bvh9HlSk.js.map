{"version":3,"file":"MapView-Bvh9HlSk.js","sources":["../../node_modules/react-zoom-pan-pinch/dist/index.esm.js","../../node_modules/@mui/icons-material/North.js","../../node_modules/@mui/icons-material/ImageNotSupported.js","../../src/pages/MapView.tsx"],"sourcesContent":["import React, { useRef, useImperativeHandle, useEffect, useContext, useLayoutEffect, useState, useCallback, useMemo } from 'react';\n\n/**\n * Rounds number to given decimal\n * eg. roundNumber(2.34343, 1) => 2.3\n */\nvar roundNumber = function (num, decimal) {\n    return Number(num.toFixed(decimal));\n};\n/**\n * Checks if value is number, if not it returns default value\n * 1# eg. checkIsNumber(2, 30) => 2\n * 2# eg. checkIsNumber(null, 30) => 30\n */\nvar checkIsNumber = function (num, defaultValue) {\n    return typeof num === \"number\" ? num : defaultValue;\n};\n\nvar handleCallback = function (context, event, callback) {\n    if (callback && typeof callback === \"function\") {\n        callback(context, event);\n    }\n};\n\n/* eslint-disable no-plusplus */\n/* eslint-disable no-param-reassign */\n/**\n * Functions should return denominator of the target value, which is the next animation step.\n * t is a value from 0 to 1, reflecting the percentage of animation status.\n */\nvar easeOut = function (t) {\n    return -Math.cos(t * Math.PI) / 2 + 0.5;\n};\n// linear\nvar linear = function (t) {\n    return t;\n};\n// accelerating from zero velocity\nvar easeInQuad = function (t) {\n    return t * t;\n};\n// decelerating to zero velocity\nvar easeOutQuad = function (t) {\n    return t * (2 - t);\n};\n// acceleration until halfway, then deceleration\nvar easeInOutQuad = function (t) {\n    return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n};\n// accelerating from zero velocity\nvar easeInCubic = function (t) {\n    return t * t * t;\n};\n// decelerating to zero velocity\nvar easeOutCubic = function (t) {\n    return --t * t * t + 1;\n};\n// acceleration until halfway, then deceleration\nvar easeInOutCubic = function (t) {\n    return t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\n};\n// accelerating from zero velocity\nvar easeInQuart = function (t) {\n    return t * t * t * t;\n};\n// decelerating to zero velocity\nvar easeOutQuart = function (t) {\n    return 1 - --t * t * t * t;\n};\n// acceleration until halfway, then deceleration\nvar easeInOutQuart = function (t) {\n    return t < 0.5 ? 8 * t * t * t * t : 1 - 8 * --t * t * t * t;\n};\n// accelerating from zero velocity\nvar easeInQuint = function (t) {\n    return t * t * t * t * t;\n};\n// decelerating to zero velocity\nvar easeOutQuint = function (t) {\n    return 1 + --t * t * t * t * t;\n};\n// acceleration until halfway, then deceleration\nvar easeInOutQuint = function (t) {\n    return t < 0.5 ? 16 * t * t * t * t * t : 1 + 16 * --t * t * t * t * t;\n};\nvar animations = {\n    easeOut: easeOut,\n    linear: linear,\n    easeInQuad: easeInQuad,\n    easeOutQuad: easeOutQuad,\n    easeInOutQuad: easeInOutQuad,\n    easeInCubic: easeInCubic,\n    easeOutCubic: easeOutCubic,\n    easeInOutCubic: easeInOutCubic,\n    easeInQuart: easeInQuart,\n    easeOutQuart: easeOutQuart,\n    easeInOutQuart: easeInOutQuart,\n    easeInQuint: easeInQuint,\n    easeOutQuint: easeOutQuint,\n    easeInOutQuint: easeInOutQuint,\n};\n\n/* eslint-disable no-param-reassign */\nvar handleCancelAnimationFrame = function (animation) {\n    if (typeof animation === \"number\") {\n        cancelAnimationFrame(animation);\n    }\n};\nvar handleCancelAnimation = function (contextInstance) {\n    if (!contextInstance.mounted)\n        return;\n    handleCancelAnimationFrame(contextInstance.animation);\n    // Clear animation state\n    contextInstance.animate = false;\n    contextInstance.animation = null;\n    contextInstance.velocity = null;\n};\nfunction handleSetupAnimation(contextInstance, animationName, animationTime, callback) {\n    if (!contextInstance.mounted)\n        return;\n    var startTime = new Date().getTime();\n    var lastStep = 1;\n    // if another animation is active\n    handleCancelAnimation(contextInstance);\n    // new animation\n    contextInstance.animation = function () {\n        if (!contextInstance.mounted) {\n            return handleCancelAnimationFrame(contextInstance.animation);\n        }\n        var frameTime = new Date().getTime() - startTime;\n        var animationProgress = frameTime / animationTime;\n        var animationType = animations[animationName];\n        var step = animationType(animationProgress);\n        if (frameTime >= animationTime) {\n            callback(lastStep);\n            contextInstance.animation = null;\n        }\n        else if (contextInstance.animation) {\n            callback(step);\n            requestAnimationFrame(contextInstance.animation);\n        }\n    };\n    requestAnimationFrame(contextInstance.animation);\n}\nfunction isValidTargetState(targetState) {\n    var scale = targetState.scale, positionX = targetState.positionX, positionY = targetState.positionY;\n    if (Number.isNaN(scale) ||\n        Number.isNaN(positionX) ||\n        Number.isNaN(positionY)) {\n        return false;\n    }\n    return true;\n}\nfunction animate(contextInstance, targetState, animationTime, animationName) {\n    var isValid = isValidTargetState(targetState);\n    if (!contextInstance.mounted || !isValid)\n        return;\n    var setTransformState = contextInstance.setTransformState;\n    var _a = contextInstance.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n    var scaleDiff = targetState.scale - scale;\n    var positionXDiff = targetState.positionX - positionX;\n    var positionYDiff = targetState.positionY - positionY;\n    if (animationTime === 0) {\n        setTransformState(targetState.scale, targetState.positionX, targetState.positionY);\n    }\n    else {\n        // animation start timestamp\n        handleSetupAnimation(contextInstance, animationName, animationTime, function (step) {\n            var newScale = scale + scaleDiff * step;\n            var newPositionX = positionX + positionXDiff * step;\n            var newPositionY = positionY + positionYDiff * step;\n            setTransformState(newScale, newPositionX, newPositionY);\n        });\n    }\n}\n\n/* eslint-disable no-param-reassign */\nfunction getComponentsSizes(wrapperComponent, contentComponent, newScale) {\n    var wrapperWidth = wrapperComponent.offsetWidth;\n    var wrapperHeight = wrapperComponent.offsetHeight;\n    var contentWidth = contentComponent.offsetWidth;\n    var contentHeight = contentComponent.offsetHeight;\n    var newContentWidth = contentWidth * newScale;\n    var newContentHeight = contentHeight * newScale;\n    var newDiffWidth = wrapperWidth - newContentWidth;\n    var newDiffHeight = wrapperHeight - newContentHeight;\n    return {\n        wrapperWidth: wrapperWidth,\n        wrapperHeight: wrapperHeight,\n        newContentWidth: newContentWidth,\n        newDiffWidth: newDiffWidth,\n        newContentHeight: newContentHeight,\n        newDiffHeight: newDiffHeight,\n    };\n}\nvar getBounds = function (wrapperWidth, newContentWidth, diffWidth, wrapperHeight, newContentHeight, diffHeight, centerZoomedOut) {\n    var scaleWidthFactor = wrapperWidth > newContentWidth\n        ? diffWidth * (centerZoomedOut ? 1 : 0.5)\n        : 0;\n    var scaleHeightFactor = wrapperHeight > newContentHeight\n        ? diffHeight * (centerZoomedOut ? 1 : 0.5)\n        : 0;\n    var minPositionX = wrapperWidth - newContentWidth - scaleWidthFactor;\n    var maxPositionX = scaleWidthFactor;\n    var minPositionY = wrapperHeight - newContentHeight - scaleHeightFactor;\n    var maxPositionY = scaleHeightFactor;\n    return { minPositionX: minPositionX, maxPositionX: maxPositionX, minPositionY: minPositionY, maxPositionY: maxPositionY };\n};\nvar calculateBounds = function (contextInstance, newScale) {\n    var wrapperComponent = contextInstance.wrapperComponent, contentComponent = contextInstance.contentComponent;\n    var centerZoomedOut = contextInstance.setup.centerZoomedOut;\n    if (!wrapperComponent || !contentComponent) {\n        throw new Error(\"Components are not mounted\");\n    }\n    var _a = getComponentsSizes(wrapperComponent, contentComponent, newScale), wrapperWidth = _a.wrapperWidth, wrapperHeight = _a.wrapperHeight, newContentWidth = _a.newContentWidth, newDiffWidth = _a.newDiffWidth, newContentHeight = _a.newContentHeight, newDiffHeight = _a.newDiffHeight;\n    var bounds = getBounds(wrapperWidth, newContentWidth, newDiffWidth, wrapperHeight, newContentHeight, newDiffHeight, Boolean(centerZoomedOut));\n    return bounds;\n};\n/**\n * Keeps value between given bounds, used for limiting view to given boundaries\n * 1# eg. boundLimiter(2, 0, 3, true) => 2\n * 2# eg. boundLimiter(4, 0, 3, true) => 3\n * 3# eg. boundLimiter(-2, 0, 3, true) => 0\n * 4# eg. boundLimiter(10, 0, 3, false) => 10\n */\nvar boundLimiter = function (value, minBound, maxBound, isActive) {\n    if (!isActive)\n        return roundNumber(value, 2);\n    if (value < minBound)\n        return roundNumber(minBound, 2);\n    if (value > maxBound)\n        return roundNumber(maxBound, 2);\n    return roundNumber(value, 2);\n};\nvar handleCalculateBounds = function (contextInstance, newScale) {\n    var bounds = calculateBounds(contextInstance, newScale);\n    // Save bounds\n    contextInstance.bounds = bounds;\n    return bounds;\n};\nfunction getMouseBoundedPosition(positionX, positionY, bounds, limitToBounds, paddingValueX, paddingValueY, wrapperComponent) {\n    var minPositionX = bounds.minPositionX, minPositionY = bounds.minPositionY, maxPositionX = bounds.maxPositionX, maxPositionY = bounds.maxPositionY;\n    var paddingX = 0;\n    var paddingY = 0;\n    if (wrapperComponent) {\n        paddingX = paddingValueX;\n        paddingY = paddingValueY;\n    }\n    var x = boundLimiter(positionX, minPositionX - paddingX, maxPositionX + paddingX, limitToBounds);\n    var y = boundLimiter(positionY, minPositionY - paddingY, maxPositionY + paddingY, limitToBounds);\n    return { x: x, y: y };\n}\n\nfunction handleCalculateZoomPositions(contextInstance, mouseX, mouseY, newScale, bounds, limitToBounds) {\n    var _a = contextInstance.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n    var scaleDifference = newScale - scale;\n    if (typeof mouseX !== \"number\" || typeof mouseY !== \"number\") {\n        console.error(\"Mouse X and Y position were not provided!\");\n        return { x: positionX, y: positionY };\n    }\n    var calculatedPositionX = positionX - mouseX * scaleDifference;\n    var calculatedPositionY = positionY - mouseY * scaleDifference;\n    // do not limit to bounds when there is padding animation,\n    // it causes animation strange behaviour\n    var newPositions = getMouseBoundedPosition(calculatedPositionX, calculatedPositionY, bounds, limitToBounds, 0, 0, null);\n    return newPositions;\n}\nfunction checkZoomBounds(zoom, minScale, maxScale, zoomPadding, enablePadding) {\n    var scalePadding = enablePadding ? zoomPadding : 0;\n    var minScaleWithPadding = minScale - scalePadding;\n    if (!Number.isNaN(maxScale) && zoom >= maxScale)\n        return maxScale;\n    if (!Number.isNaN(minScale) && zoom <= minScaleWithPadding)\n        return minScaleWithPadding;\n    return zoom;\n}\n\nvar isPanningStartAllowed = function (contextInstance, event) {\n    var excluded = contextInstance.setup.panning.excluded;\n    var isInitialized = contextInstance.isInitialized, wrapperComponent = contextInstance.wrapperComponent;\n    var target = event.target;\n    var targetIsShadowDom = \"shadowRoot\" in target && \"composedPath\" in event;\n    var isWrapperChild = targetIsShadowDom\n        ? event.composedPath().some(function (el) {\n            if (!(el instanceof Element)) {\n                return false;\n            }\n            return wrapperComponent === null || wrapperComponent === void 0 ? void 0 : wrapperComponent.contains(el);\n        })\n        : wrapperComponent === null || wrapperComponent === void 0 ? void 0 : wrapperComponent.contains(target);\n    var isAllowed = isInitialized && target && isWrapperChild;\n    if (!isAllowed)\n        return false;\n    var isExcluded = isExcludedNode(target, excluded);\n    if (isExcluded)\n        return false;\n    return true;\n};\nvar isPanningAllowed = function (contextInstance) {\n    var isInitialized = contextInstance.isInitialized, isPanning = contextInstance.isPanning, setup = contextInstance.setup;\n    var disabled = setup.panning.disabled;\n    var isAllowed = isInitialized && isPanning && !disabled;\n    if (!isAllowed)\n        return false;\n    return true;\n};\nvar handlePanningSetup = function (contextInstance, event) {\n    var _a = contextInstance.transformState, positionX = _a.positionX, positionY = _a.positionY;\n    contextInstance.isPanning = true;\n    // Panning with mouse\n    var x = event.clientX;\n    var y = event.clientY;\n    contextInstance.startCoords = { x: x - positionX, y: y - positionY };\n};\nvar handleTouchPanningSetup = function (contextInstance, event) {\n    var touches = event.touches;\n    var _a = contextInstance.transformState, positionX = _a.positionX, positionY = _a.positionY;\n    contextInstance.isPanning = true;\n    // Panning with touch\n    var oneFingerTouch = touches.length === 1;\n    if (oneFingerTouch) {\n        var x = touches[0].clientX;\n        var y = touches[0].clientY;\n        contextInstance.startCoords = { x: x - positionX, y: y - positionY };\n    }\n};\nfunction handlePanToBounds(contextInstance) {\n    var _a = contextInstance.transformState, positionX = _a.positionX, positionY = _a.positionY, scale = _a.scale;\n    var _b = contextInstance.setup, disabled = _b.disabled, limitToBounds = _b.limitToBounds, centerZoomedOut = _b.centerZoomedOut;\n    var wrapperComponent = contextInstance.wrapperComponent;\n    if (disabled || !wrapperComponent || !contextInstance.bounds)\n        return;\n    var _c = contextInstance.bounds, maxPositionX = _c.maxPositionX, minPositionX = _c.minPositionX, maxPositionY = _c.maxPositionY, minPositionY = _c.minPositionY;\n    var xChanged = positionX > maxPositionX || positionX < minPositionX;\n    var yChanged = positionY > maxPositionY || positionY < minPositionY;\n    var mousePosX = positionX > maxPositionX\n        ? wrapperComponent.offsetWidth\n        : contextInstance.setup.minPositionX || 0;\n    var mousePosY = positionY > maxPositionY\n        ? wrapperComponent.offsetHeight\n        : contextInstance.setup.minPositionY || 0;\n    var _d = handleCalculateZoomPositions(contextInstance, mousePosX, mousePosY, scale, contextInstance.bounds, limitToBounds || centerZoomedOut), x = _d.x, y = _d.y;\n    return {\n        scale: scale,\n        positionX: xChanged ? x : positionX,\n        positionY: yChanged ? y : positionY,\n    };\n}\nfunction handleNewPosition(contextInstance, newPositionX, newPositionY, paddingValueX, paddingValueY) {\n    var limitToBounds = contextInstance.setup.limitToBounds;\n    var wrapperComponent = contextInstance.wrapperComponent, bounds = contextInstance.bounds;\n    var _a = contextInstance.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n    if (wrapperComponent === null ||\n        bounds === null ||\n        (newPositionX === positionX && newPositionY === positionY)) {\n        return;\n    }\n    var _b = getMouseBoundedPosition(newPositionX, newPositionY, bounds, limitToBounds, paddingValueX, paddingValueY, wrapperComponent), x = _b.x, y = _b.y;\n    contextInstance.setTransformState(scale, x, y);\n}\nvar getPanningClientPosition = function (contextInstance, clientX, clientY) {\n    var startCoords = contextInstance.startCoords, transformState = contextInstance.transformState;\n    var panning = contextInstance.setup.panning;\n    var lockAxisX = panning.lockAxisX, lockAxisY = panning.lockAxisY;\n    var positionX = transformState.positionX, positionY = transformState.positionY;\n    if (!startCoords) {\n        return { x: positionX, y: positionY };\n    }\n    var mouseX = clientX - startCoords.x;\n    var mouseY = clientY - startCoords.y;\n    var newPositionX = lockAxisX ? positionX : mouseX;\n    var newPositionY = lockAxisY ? positionY : mouseY;\n    return { x: newPositionX, y: newPositionY };\n};\nvar getPaddingValue = function (contextInstance, size) {\n    var setup = contextInstance.setup, transformState = contextInstance.transformState;\n    var scale = transformState.scale;\n    var minScale = setup.minScale, disablePadding = setup.disablePadding;\n    if (size > 0 && scale >= minScale && !disablePadding) {\n        return size;\n    }\n    return 0;\n};\n\nvar isVelocityCalculationAllowed = function (contextInstance) {\n    var mounted = contextInstance.mounted;\n    var _a = contextInstance.setup, disabled = _a.disabled, velocityAnimation = _a.velocityAnimation;\n    var scale = contextInstance.transformState.scale;\n    var disabledVelocity = velocityAnimation.disabled;\n    var isAllowed = !disabledVelocity || scale > 1 || !disabled || mounted;\n    if (!isAllowed)\n        return false;\n    return true;\n};\nvar isVelocityAllowed = function (contextInstance) {\n    var mounted = contextInstance.mounted, velocity = contextInstance.velocity, bounds = contextInstance.bounds;\n    var _a = contextInstance.setup, disabled = _a.disabled, velocityAnimation = _a.velocityAnimation;\n    var scale = contextInstance.transformState.scale;\n    var disabledVelocity = velocityAnimation.disabled;\n    var isAllowed = !disabledVelocity || scale > 1 || !disabled || mounted;\n    if (!isAllowed)\n        return false;\n    if (!velocity || !bounds)\n        return false;\n    return true;\n};\nfunction getVelocityMoveTime(contextInstance, velocity) {\n    var velocityAnimation = contextInstance.setup.velocityAnimation;\n    var equalToMove = velocityAnimation.equalToMove, animationTime = velocityAnimation.animationTime, sensitivity = velocityAnimation.sensitivity;\n    if (equalToMove) {\n        return animationTime * velocity * sensitivity;\n    }\n    return animationTime;\n}\nfunction getVelocityPosition(newPosition, startPosition, currentPosition, isLocked, limitToBounds, minPosition, maxPosition, minTarget, maxTarget, step) {\n    if (limitToBounds) {\n        if (startPosition > maxPosition && currentPosition > maxPosition) {\n            var calculatedPosition = maxPosition + (newPosition - maxPosition) * step;\n            if (calculatedPosition > maxTarget)\n                return maxTarget;\n            if (calculatedPosition < maxPosition)\n                return maxPosition;\n            return calculatedPosition;\n        }\n        if (startPosition < minPosition && currentPosition < minPosition) {\n            var calculatedPosition = minPosition + (newPosition - minPosition) * step;\n            if (calculatedPosition < minTarget)\n                return minTarget;\n            if (calculatedPosition > minPosition)\n                return minPosition;\n            return calculatedPosition;\n        }\n    }\n    if (isLocked)\n        return startPosition;\n    return boundLimiter(newPosition, minPosition, maxPosition, limitToBounds);\n}\n\nfunction getSizeMultiplier(wrapperComponent, equalToMove) {\n    var defaultMultiplier = 1;\n    if (equalToMove) {\n        return Math.min(defaultMultiplier, wrapperComponent.offsetWidth / window.innerWidth);\n    }\n    return defaultMultiplier;\n}\nfunction handleCalculateVelocity(contextInstance, position) {\n    var isAllowed = isVelocityCalculationAllowed(contextInstance);\n    if (!isAllowed) {\n        return;\n    }\n    var lastMousePosition = contextInstance.lastMousePosition, velocityTime = contextInstance.velocityTime, setup = contextInstance.setup;\n    var wrapperComponent = contextInstance.wrapperComponent;\n    var equalToMove = setup.velocityAnimation.equalToMove;\n    var now = Date.now();\n    if (lastMousePosition && velocityTime && wrapperComponent) {\n        var sizeMultiplier = getSizeMultiplier(wrapperComponent, equalToMove);\n        var distanceX = position.x - lastMousePosition.x;\n        var distanceY = position.y - lastMousePosition.y;\n        var velocityX = distanceX / sizeMultiplier;\n        var velocityY = distanceY / sizeMultiplier;\n        var interval = now - velocityTime;\n        var speed = distanceX * distanceX + distanceY * distanceY;\n        var velocity = Math.sqrt(speed) / interval;\n        contextInstance.velocity = { velocityX: velocityX, velocityY: velocityY, total: velocity };\n    }\n    contextInstance.lastMousePosition = position;\n    contextInstance.velocityTime = now;\n}\nfunction handleVelocityPanning(contextInstance) {\n    var velocity = contextInstance.velocity, bounds = contextInstance.bounds, setup = contextInstance.setup, wrapperComponent = contextInstance.wrapperComponent;\n    var isAllowed = isVelocityAllowed(contextInstance);\n    if (!isAllowed || !velocity || !bounds || !wrapperComponent) {\n        return;\n    }\n    var velocityX = velocity.velocityX, velocityY = velocity.velocityY, total = velocity.total;\n    var maxPositionX = bounds.maxPositionX, minPositionX = bounds.minPositionX, maxPositionY = bounds.maxPositionY, minPositionY = bounds.minPositionY;\n    var limitToBounds = setup.limitToBounds, alignmentAnimation = setup.alignmentAnimation;\n    var zoomAnimation = setup.zoomAnimation, panning = setup.panning;\n    var lockAxisY = panning.lockAxisY, lockAxisX = panning.lockAxisX;\n    var animationType = zoomAnimation.animationType;\n    var sizeX = alignmentAnimation.sizeX, sizeY = alignmentAnimation.sizeY, velocityAlignmentTime = alignmentAnimation.velocityAlignmentTime;\n    var alignAnimationTime = velocityAlignmentTime;\n    var moveAnimationTime = getVelocityMoveTime(contextInstance, total);\n    var finalAnimationTime = Math.max(moveAnimationTime, alignAnimationTime);\n    var paddingValueX = getPaddingValue(contextInstance, sizeX);\n    var paddingValueY = getPaddingValue(contextInstance, sizeY);\n    var paddingX = (paddingValueX * wrapperComponent.offsetWidth) / 100;\n    var paddingY = (paddingValueY * wrapperComponent.offsetHeight) / 100;\n    var maxTargetX = maxPositionX + paddingX;\n    var minTargetX = minPositionX - paddingX;\n    var maxTargetY = maxPositionY + paddingY;\n    var minTargetY = minPositionY - paddingY;\n    var startState = contextInstance.transformState;\n    var startTime = new Date().getTime();\n    handleSetupAnimation(contextInstance, animationType, finalAnimationTime, function (step) {\n        var _a = contextInstance.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n        var frameTime = new Date().getTime() - startTime;\n        var animationProgress = frameTime / alignAnimationTime;\n        var alignAnimation = animations[alignmentAnimation.animationType];\n        var alignStep = 1 - alignAnimation(Math.min(1, animationProgress));\n        var customStep = 1 - step;\n        var newPositionX = positionX + velocityX * customStep;\n        var newPositionY = positionY + velocityY * customStep;\n        var currentPositionX = getVelocityPosition(newPositionX, startState.positionX, positionX, lockAxisX, limitToBounds, minPositionX, maxPositionX, minTargetX, maxTargetX, alignStep);\n        var currentPositionY = getVelocityPosition(newPositionY, startState.positionY, positionY, lockAxisY, limitToBounds, minPositionY, maxPositionY, minTargetY, maxTargetY, alignStep);\n        if (positionX !== newPositionX || positionY !== newPositionY) {\n            contextInstance.setTransformState(scale, currentPositionX, currentPositionY);\n        }\n    });\n}\n\nfunction handlePanningStart(contextInstance, event) {\n    var scale = contextInstance.transformState.scale;\n    handleCancelAnimation(contextInstance);\n    handleCalculateBounds(contextInstance, scale);\n    if (window.TouchEvent !== undefined && event instanceof TouchEvent) {\n        handleTouchPanningSetup(contextInstance, event);\n    }\n    else {\n        handlePanningSetup(contextInstance, event);\n    }\n}\nfunction handleAlignToBounds(contextInstance, customAnimationTime) {\n    var scale = contextInstance.transformState.scale;\n    var _a = contextInstance.setup, minScale = _a.minScale, alignmentAnimation = _a.alignmentAnimation;\n    var disabled = alignmentAnimation.disabled, sizeX = alignmentAnimation.sizeX, sizeY = alignmentAnimation.sizeY, animationTime = alignmentAnimation.animationTime, animationType = alignmentAnimation.animationType;\n    var isDisabled = disabled || scale < minScale || (!sizeX && !sizeY);\n    if (isDisabled)\n        return;\n    var targetState = handlePanToBounds(contextInstance);\n    if (targetState) {\n        animate(contextInstance, targetState, customAnimationTime !== null && customAnimationTime !== void 0 ? customAnimationTime : animationTime, animationType);\n    }\n}\nfunction handlePanning(contextInstance, clientX, clientY) {\n    var startCoords = contextInstance.startCoords, setup = contextInstance.setup;\n    var _a = setup.alignmentAnimation, sizeX = _a.sizeX, sizeY = _a.sizeY;\n    if (!startCoords)\n        return;\n    var _b = getPanningClientPosition(contextInstance, clientX, clientY), x = _b.x, y = _b.y;\n    var paddingValueX = getPaddingValue(contextInstance, sizeX);\n    var paddingValueY = getPaddingValue(contextInstance, sizeY);\n    handleCalculateVelocity(contextInstance, { x: x, y: y });\n    handleNewPosition(contextInstance, x, y, paddingValueX, paddingValueY);\n}\nfunction handlePanningEnd(contextInstance) {\n    if (contextInstance.isPanning) {\n        var velocityDisabled = contextInstance.setup.panning.velocityDisabled;\n        var velocity = contextInstance.velocity, wrapperComponent = contextInstance.wrapperComponent, contentComponent = contextInstance.contentComponent;\n        contextInstance.isPanning = false;\n        contextInstance.animate = false;\n        contextInstance.animation = null;\n        var wrapperRect = wrapperComponent === null || wrapperComponent === void 0 ? void 0 : wrapperComponent.getBoundingClientRect();\n        var contentRect = contentComponent === null || contentComponent === void 0 ? void 0 : contentComponent.getBoundingClientRect();\n        var wrapperWidth = (wrapperRect === null || wrapperRect === void 0 ? void 0 : wrapperRect.width) || 0;\n        var wrapperHeight = (wrapperRect === null || wrapperRect === void 0 ? void 0 : wrapperRect.height) || 0;\n        var contentWidth = (contentRect === null || contentRect === void 0 ? void 0 : contentRect.width) || 0;\n        var contentHeight = (contentRect === null || contentRect === void 0 ? void 0 : contentRect.height) || 0;\n        var isZoomed = wrapperWidth < contentWidth || wrapperHeight < contentHeight;\n        var shouldAnimate = !velocityDisabled && velocity && (velocity === null || velocity === void 0 ? void 0 : velocity.total) > 0.1 && isZoomed;\n        if (shouldAnimate) {\n            handleVelocityPanning(contextInstance);\n        }\n        else {\n            handleAlignToBounds(contextInstance);\n        }\n    }\n}\n\nfunction handleZoomToPoint(contextInstance, scale, mouseX, mouseY) {\n    var _a = contextInstance.setup, minScale = _a.minScale, maxScale = _a.maxScale, limitToBounds = _a.limitToBounds;\n    var newScale = checkZoomBounds(roundNumber(scale, 2), minScale, maxScale, 0, false);\n    var bounds = handleCalculateBounds(contextInstance, newScale);\n    var _b = handleCalculateZoomPositions(contextInstance, mouseX, mouseY, newScale, bounds, limitToBounds), x = _b.x, y = _b.y;\n    return { scale: newScale, positionX: x, positionY: y };\n}\nfunction handleAlignToScaleBounds(contextInstance, mousePositionX, mousePositionY) {\n    var scale = contextInstance.transformState.scale;\n    var wrapperComponent = contextInstance.wrapperComponent;\n    var _a = contextInstance.setup, minScale = _a.minScale, limitToBounds = _a.limitToBounds, zoomAnimation = _a.zoomAnimation;\n    var disabled = zoomAnimation.disabled, animationTime = zoomAnimation.animationTime, animationType = zoomAnimation.animationType;\n    var isDisabled = disabled || scale >= minScale;\n    if (scale >= 1 || limitToBounds) {\n        // fire fit to bounds animation\n        handleAlignToBounds(contextInstance);\n    }\n    if (isDisabled || !wrapperComponent || !contextInstance.mounted)\n        return;\n    var mouseX = mousePositionX || wrapperComponent.offsetWidth / 2;\n    var mouseY = mousePositionY || wrapperComponent.offsetHeight / 2;\n    var targetState = handleZoomToPoint(contextInstance, minScale, mouseX, mouseY);\n    if (targetState) {\n        animate(contextInstance, targetState, animationTime, animationType);\n    }\n}\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nfunction __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\ntypeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\n\nvar initialState = {\n    previousScale: 1,\n    scale: 1,\n    positionX: 0,\n    positionY: 0,\n};\nvar initialSetup = {\n    disabled: false,\n    minPositionX: null,\n    maxPositionX: null,\n    minPositionY: null,\n    maxPositionY: null,\n    minScale: 1,\n    maxScale: 8,\n    limitToBounds: true,\n    centerZoomedOut: false,\n    centerOnInit: false,\n    disablePadding: false,\n    smooth: true,\n    wheel: {\n        step: 0.2,\n        disabled: false,\n        smoothStep: 0.001,\n        wheelDisabled: false,\n        touchPadDisabled: false,\n        activationKeys: [],\n        excluded: [],\n    },\n    panning: {\n        disabled: false,\n        velocityDisabled: false,\n        lockAxisX: false,\n        lockAxisY: false,\n        allowLeftClickPan: true,\n        allowMiddleClickPan: true,\n        allowRightClickPan: true,\n        wheelPanning: false,\n        activationKeys: [],\n        excluded: [],\n    },\n    pinch: {\n        step: 5,\n        disabled: false,\n        excluded: [],\n    },\n    doubleClick: {\n        disabled: false,\n        step: 0.7,\n        mode: \"zoomIn\",\n        animationType: \"easeOut\",\n        animationTime: 200,\n        excluded: [],\n    },\n    zoomAnimation: {\n        disabled: false,\n        size: 0.4,\n        animationTime: 200,\n        animationType: \"easeOut\",\n    },\n    alignmentAnimation: {\n        disabled: false,\n        sizeX: 100,\n        sizeY: 100,\n        animationTime: 200,\n        velocityAlignmentTime: 400,\n        animationType: \"easeOut\",\n    },\n    velocityAnimation: {\n        disabled: false,\n        sensitivity: 1,\n        animationTime: 400,\n        animationType: \"easeOut\",\n        equalToMove: true,\n    },\n};\nvar baseClasses = {\n    wrapperClass: \"react-transform-wrapper\",\n    contentClass: \"react-transform-component\",\n};\n\nvar createState = function (props) {\n    var _a, _b, _c, _d;\n    return {\n        previousScale: (_a = props.initialScale) !== null && _a !== void 0 ? _a : initialState.scale,\n        scale: (_b = props.initialScale) !== null && _b !== void 0 ? _b : initialState.scale,\n        positionX: (_c = props.initialPositionX) !== null && _c !== void 0 ? _c : initialState.positionX,\n        positionY: (_d = props.initialPositionY) !== null && _d !== void 0 ? _d : initialState.positionY,\n    };\n};\nvar createSetup = function (props) {\n    var newSetup = __assign({}, initialSetup);\n    Object.keys(props).forEach(function (key) {\n        var validValue = typeof props[key] !== \"undefined\";\n        var validParameter = typeof initialSetup[key] !== \"undefined\";\n        if (validParameter && validValue) {\n            var dataType = Object.prototype.toString.call(initialSetup[key]);\n            var isObject = dataType === \"[object Object]\";\n            var isArray = dataType === \"[object Array]\";\n            if (isObject) {\n                newSetup[key] = __assign(__assign({}, initialSetup[key]), props[key]);\n            }\n            else if (isArray) {\n                newSetup[key] = __spreadArray(__spreadArray([], initialSetup[key], true), props[key], true);\n            }\n            else {\n                newSetup[key] = props[key];\n            }\n        }\n    });\n    return newSetup;\n};\n\nvar handleCalculateButtonZoom = function (contextInstance, delta, step) {\n    var scale = contextInstance.transformState.scale;\n    var wrapperComponent = contextInstance.wrapperComponent, setup = contextInstance.setup;\n    var maxScale = setup.maxScale, minScale = setup.minScale, zoomAnimation = setup.zoomAnimation, smooth = setup.smooth;\n    var size = zoomAnimation.size;\n    if (!wrapperComponent) {\n        throw new Error(\"Wrapper is not mounted\");\n    }\n    var targetScale = smooth\n        ? scale * Math.exp(delta * step)\n        : scale + delta * step;\n    var newScale = checkZoomBounds(roundNumber(targetScale, 3), minScale, maxScale, size, false);\n    return newScale;\n};\nfunction handleZoomToViewCenter(contextInstance, delta, step, animationTime, animationType) {\n    var wrapperComponent = contextInstance.wrapperComponent;\n    var _a = contextInstance.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n    if (!wrapperComponent)\n        return console.error(\"No WrapperComponent found\");\n    var wrapperWidth = wrapperComponent.offsetWidth;\n    var wrapperHeight = wrapperComponent.offsetHeight;\n    var mouseX = (wrapperWidth / 2 - positionX) / scale;\n    var mouseY = (wrapperHeight / 2 - positionY) / scale;\n    var newScale = handleCalculateButtonZoom(contextInstance, delta, step);\n    var targetState = handleZoomToPoint(contextInstance, newScale, mouseX, mouseY);\n    if (!targetState) {\n        return console.error(\"Error during zoom event. New transformation state was not calculated.\");\n    }\n    animate(contextInstance, targetState, animationTime, animationType);\n}\nfunction resetTransformations(contextInstance, animationTime, animationType, onResetTransformation) {\n    var setup = contextInstance.setup, wrapperComponent = contextInstance.wrapperComponent;\n    var limitToBounds = setup.limitToBounds;\n    var initialTransformation = createState(contextInstance.props);\n    var _a = contextInstance.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n    if (!wrapperComponent)\n        return;\n    var newBounds = calculateBounds(contextInstance, initialTransformation.scale);\n    var boundedPositions = getMouseBoundedPosition(initialTransformation.positionX, initialTransformation.positionY, newBounds, limitToBounds, 0, 0, wrapperComponent);\n    var newState = {\n        scale: initialTransformation.scale,\n        positionX: boundedPositions.x,\n        positionY: boundedPositions.y,\n    };\n    if (scale === initialTransformation.scale &&\n        positionX === initialTransformation.positionX &&\n        positionY === initialTransformation.positionY) {\n        return;\n    }\n    onResetTransformation === null || onResetTransformation === void 0 ? void 0 : onResetTransformation();\n    animate(contextInstance, newState, animationTime, animationType);\n}\nfunction getOffset(element, wrapper, content, state) {\n    var offset = element.getBoundingClientRect();\n    var wrapperOffset = wrapper.getBoundingClientRect();\n    var contentOffset = content.getBoundingClientRect();\n    var xOff = wrapperOffset.x * state.scale;\n    var yOff = wrapperOffset.y * state.scale;\n    return {\n        x: (offset.x - contentOffset.x + xOff) / state.scale,\n        y: (offset.y - contentOffset.y + yOff) / state.scale,\n    };\n}\nfunction calculateZoomToNode(contextInstance, node, customZoom) {\n    var wrapperComponent = contextInstance.wrapperComponent, contentComponent = contextInstance.contentComponent, transformState = contextInstance.transformState;\n    var _a = contextInstance.setup, limitToBounds = _a.limitToBounds, minScale = _a.minScale, maxScale = _a.maxScale;\n    if (!wrapperComponent || !contentComponent)\n        return transformState;\n    var wrapperRect = wrapperComponent.getBoundingClientRect();\n    var nodeRect = node.getBoundingClientRect();\n    var nodeOffset = getOffset(node, wrapperComponent, contentComponent, transformState);\n    var nodeLeft = nodeOffset.x;\n    var nodeTop = nodeOffset.y;\n    var nodeWidth = nodeRect.width / transformState.scale;\n    var nodeHeight = nodeRect.height / transformState.scale;\n    var scaleX = wrapperComponent.offsetWidth / nodeWidth;\n    var scaleY = wrapperComponent.offsetHeight / nodeHeight;\n    var newScale = checkZoomBounds(customZoom || Math.min(scaleX, scaleY), minScale, maxScale, 0, false);\n    var offsetX = (wrapperRect.width - nodeWidth * newScale) / 2;\n    var offsetY = (wrapperRect.height - nodeHeight * newScale) / 2;\n    var newPositionX = (wrapperRect.left - nodeLeft) * newScale + offsetX;\n    var newPositionY = (wrapperRect.top - nodeTop) * newScale + offsetY;\n    var bounds = calculateBounds(contextInstance, newScale);\n    var _b = getMouseBoundedPosition(newPositionX, newPositionY, bounds, limitToBounds, 0, 0, wrapperComponent), x = _b.x, y = _b.y;\n    return { positionX: x, positionY: y, scale: newScale };\n}\n\nvar zoomIn = function (contextInstance) {\n    return function (step, animationTime, animationType) {\n        if (step === void 0) { step = 0.5; }\n        if (animationTime === void 0) { animationTime = 300; }\n        if (animationType === void 0) { animationType = \"easeOut\"; }\n        handleZoomToViewCenter(contextInstance, 1, step, animationTime, animationType);\n    };\n};\nvar zoomOut = function (contextInstance) {\n    return function (step, animationTime, animationType) {\n        if (step === void 0) { step = 0.5; }\n        if (animationTime === void 0) { animationTime = 300; }\n        if (animationType === void 0) { animationType = \"easeOut\"; }\n        handleZoomToViewCenter(contextInstance, -1, step, animationTime, animationType);\n    };\n};\nvar setTransform = function (contextInstance) {\n    return function (newPositionX, newPositionY, newScale, animationTime, animationType) {\n        if (animationTime === void 0) { animationTime = 300; }\n        if (animationType === void 0) { animationType = \"easeOut\"; }\n        var _a = contextInstance.transformState, positionX = _a.positionX, positionY = _a.positionY, scale = _a.scale;\n        var wrapperComponent = contextInstance.wrapperComponent, contentComponent = contextInstance.contentComponent;\n        var disabled = contextInstance.setup.disabled;\n        if (disabled || !wrapperComponent || !contentComponent)\n            return;\n        var targetState = {\n            positionX: Number.isNaN(newPositionX) ? positionX : newPositionX,\n            positionY: Number.isNaN(newPositionY) ? positionY : newPositionY,\n            scale: Number.isNaN(newScale) ? scale : newScale,\n        };\n        animate(contextInstance, targetState, animationTime, animationType);\n    };\n};\nvar resetTransform = function (contextInstance) {\n    return function (animationTime, animationType) {\n        if (animationTime === void 0) { animationTime = 200; }\n        if (animationType === void 0) { animationType = \"easeOut\"; }\n        resetTransformations(contextInstance, animationTime, animationType);\n    };\n};\nvar centerView = function (contextInstance) {\n    return function (scale, animationTime, animationType) {\n        if (animationTime === void 0) { animationTime = 200; }\n        if (animationType === void 0) { animationType = \"easeOut\"; }\n        var transformState = contextInstance.transformState, wrapperComponent = contextInstance.wrapperComponent, contentComponent = contextInstance.contentComponent;\n        if (wrapperComponent && contentComponent) {\n            var targetState = getCenterPosition(scale || transformState.scale, wrapperComponent, contentComponent);\n            animate(contextInstance, targetState, animationTime, animationType);\n        }\n    };\n};\nvar zoomToElement = function (contextInstance) {\n    return function (node, scale, animationTime, animationType) {\n        if (animationTime === void 0) { animationTime = 600; }\n        if (animationType === void 0) { animationType = \"easeOut\"; }\n        handleCancelAnimation(contextInstance);\n        var wrapperComponent = contextInstance.wrapperComponent;\n        var target = typeof node === \"string\" ? document.getElementById(node) : node;\n        if (wrapperComponent && target && wrapperComponent.contains(target)) {\n            var targetState = calculateZoomToNode(contextInstance, target, scale);\n            animate(contextInstance, targetState, animationTime, animationType);\n        }\n    };\n};\n\nvar getControls = function (contextInstance) {\n    return {\n        instance: contextInstance,\n        zoomIn: zoomIn(contextInstance),\n        zoomOut: zoomOut(contextInstance),\n        setTransform: setTransform(contextInstance),\n        resetTransform: resetTransform(contextInstance),\n        centerView: centerView(contextInstance),\n        zoomToElement: zoomToElement(contextInstance),\n    };\n};\nvar getState = function (contextInstance) {\n    return {\n        instance: contextInstance,\n        state: contextInstance.transformState,\n    };\n};\nvar getContext = function (contextInstance) {\n    var ref = {};\n    Object.assign(ref, getState(contextInstance));\n    Object.assign(ref, getControls(contextInstance));\n    return ref;\n};\n\n// We want to make event listeners non-passive, and to do so have to check\n// that browsers support EventListenerOptions in the first place.\n// https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener#Safely_detecting_option_support\nvar passiveSupported = false;\nfunction makePassiveEventOption() {\n    try {\n        var options = {\n            get passive() {\n                // This function will be called when the browser\n                //   attempts to access the passive property.\n                passiveSupported = true;\n                return false;\n            },\n        };\n        return options;\n    }\n    catch (err) {\n        passiveSupported = false;\n        return passiveSupported;\n    }\n}\n\nvar matchPrefix = \".\".concat(baseClasses.wrapperClass);\nvar isExcludedNode = function (node, excluded) {\n    return excluded.some(function (exclude) {\n        return node.matches(\"\".concat(matchPrefix, \" \").concat(exclude, \", \").concat(matchPrefix, \" .\").concat(exclude, \", \").concat(matchPrefix, \" \").concat(exclude, \" *, \").concat(matchPrefix, \" .\").concat(exclude, \" *\"));\n    });\n};\nvar cancelTimeout = function (timeout) {\n    if (timeout) {\n        clearTimeout(timeout);\n    }\n};\n\nvar getTransformStyles = function (x, y, scale) {\n    // Standard translate prevents blurry svg on the safari\n    return \"translate(\".concat(x, \"px, \").concat(y, \"px) scale(\").concat(scale, \")\");\n};\nvar getMatrixTransformStyles = function (x, y, scale) {\n    // The shorthand for matrix does not work for Safari hence the need to explicitly use matrix3d\n    // Refer to https://developer.mozilla.org/en-US/docs/Web/CSS/transform-function/matrix\n    var a = scale;\n    var b = 0;\n    var c = 0;\n    var d = scale;\n    var tx = x;\n    var ty = y;\n    return \"matrix3d(\".concat(a, \", \").concat(b, \", 0, 0, \").concat(c, \", \").concat(d, \", 0, 0, 0, 0, 1, 0, \").concat(tx, \", \").concat(ty, \", 0, 1)\");\n};\nvar getCenterPosition = function (scale, wrapperComponent, contentComponent) {\n    var contentWidth = contentComponent.offsetWidth * scale;\n    var contentHeight = contentComponent.offsetHeight * scale;\n    var centerPositionX = (wrapperComponent.offsetWidth - contentWidth) / 2;\n    var centerPositionY = (wrapperComponent.offsetHeight - contentHeight) / 2;\n    return {\n        scale: scale,\n        positionX: centerPositionX,\n        positionY: centerPositionY,\n    };\n};\n\nfunction mergeRefs(refs) {\n    return function (value) {\n        refs.forEach(function (ref) {\n            if (typeof ref === \"function\") {\n                ref(value);\n            }\n            else if (ref != null) {\n                ref.current = value;\n            }\n        });\n    };\n}\n\nvar isWheelAllowed = function (contextInstance, event) {\n    var _a = contextInstance.setup.wheel, disabled = _a.disabled, wheelDisabled = _a.wheelDisabled, touchPadDisabled = _a.touchPadDisabled, excluded = _a.excluded;\n    var isInitialized = contextInstance.isInitialized, isPanning = contextInstance.isPanning;\n    var target = event.target;\n    var isAllowed = isInitialized && !isPanning && !disabled && target;\n    if (!isAllowed)\n        return false;\n    // Event ctrlKey detects if touchpad action is executing wheel or pinch gesture\n    if (wheelDisabled && !event.ctrlKey)\n        return false;\n    if (touchPadDisabled && event.ctrlKey)\n        return false;\n    var isExcluded = isExcludedNode(target, excluded);\n    if (isExcluded)\n        return false;\n    return true;\n};\nvar getDeltaY = function (event) {\n    if (event) {\n        return event.deltaY < 0 ? 1 : -1;\n    }\n    return 0;\n};\nfunction getDelta(event, customDelta) {\n    var deltaY = getDeltaY(event);\n    var delta = checkIsNumber(customDelta, deltaY);\n    return delta;\n}\nfunction getMousePosition(event, contentComponent, scale) {\n    var contentRect = contentComponent.getBoundingClientRect();\n    var mouseX = 0;\n    var mouseY = 0;\n    if (\"clientX\" in event) {\n        // mouse position x, y over wrapper component\n        mouseX = (event.clientX - contentRect.left) / scale;\n        mouseY = (event.clientY - contentRect.top) / scale;\n    }\n    else {\n        var touch = event.touches[0];\n        mouseX = (touch.clientX - contentRect.left) / scale;\n        mouseY = (touch.clientY - contentRect.top) / scale;\n    }\n    if (Number.isNaN(mouseX) || Number.isNaN(mouseY))\n        console.error(\"No mouse or touch offset found\");\n    return {\n        x: mouseX,\n        y: mouseY,\n    };\n}\nvar handleCalculateWheelZoom = function (contextInstance, delta, step, disable, getTarget) {\n    var scale = contextInstance.transformState.scale;\n    var wrapperComponent = contextInstance.wrapperComponent, setup = contextInstance.setup;\n    var maxScale = setup.maxScale, minScale = setup.minScale, zoomAnimation = setup.zoomAnimation, disablePadding = setup.disablePadding;\n    var size = zoomAnimation.size, disabled = zoomAnimation.disabled;\n    if (!wrapperComponent) {\n        throw new Error(\"Wrapper is not mounted\");\n    }\n    var targetScale = scale + delta * step;\n    if (getTarget)\n        return targetScale;\n    var paddingEnabled = disable ? false : !disabled;\n    var newScale = checkZoomBounds(roundNumber(targetScale, 3), minScale, maxScale, size, paddingEnabled && !disablePadding);\n    return newScale;\n};\nvar handleWheelZoomStop = function (contextInstance, event) {\n    var previousWheelEvent = contextInstance.previousWheelEvent;\n    var scale = contextInstance.transformState.scale;\n    var _a = contextInstance.setup, maxScale = _a.maxScale, minScale = _a.minScale;\n    if (!previousWheelEvent)\n        return false;\n    if (scale < maxScale || scale > minScale)\n        return true;\n    if (Math.sign(previousWheelEvent.deltaY) !== Math.sign(event.deltaY))\n        return true;\n    if (previousWheelEvent.deltaY > 0 && previousWheelEvent.deltaY < event.deltaY)\n        return true;\n    if (previousWheelEvent.deltaY < 0 && previousWheelEvent.deltaY > event.deltaY)\n        return true;\n    if (Math.sign(previousWheelEvent.deltaY) !== Math.sign(event.deltaY))\n        return true;\n    return false;\n};\n\nvar isPinchStartAllowed = function (contextInstance, event) {\n    var _a = contextInstance.setup.pinch, disabled = _a.disabled, excluded = _a.excluded;\n    var isInitialized = contextInstance.isInitialized;\n    var target = event.target;\n    var isAllowed = isInitialized && !disabled && target;\n    if (!isAllowed)\n        return false;\n    var isExcluded = isExcludedNode(target, excluded);\n    if (isExcluded)\n        return false;\n    return true;\n};\nvar isPinchAllowed = function (contextInstance) {\n    var disabled = contextInstance.setup.pinch.disabled;\n    var isInitialized = contextInstance.isInitialized, pinchStartDistance = contextInstance.pinchStartDistance;\n    var isAllowed = isInitialized && !disabled && pinchStartDistance;\n    if (!isAllowed)\n        return false;\n    return true;\n};\nvar calculateTouchMidPoint = function (event, scale, contentComponent) {\n    var contentRect = contentComponent.getBoundingClientRect();\n    var touches = event.touches;\n    var firstPointX = roundNumber(touches[0].clientX - contentRect.left, 5);\n    var firstPointY = roundNumber(touches[0].clientY - contentRect.top, 5);\n    var secondPointX = roundNumber(touches[1].clientX - contentRect.left, 5);\n    var secondPointY = roundNumber(touches[1].clientY - contentRect.top, 5);\n    return {\n        x: (firstPointX + secondPointX) / 2 / scale,\n        y: (firstPointY + secondPointY) / 2 / scale,\n    };\n};\nvar getTouchDistance = function (event) {\n    return Math.sqrt(Math.pow((event.touches[0].pageX - event.touches[1].pageX), 2) +\n        Math.pow((event.touches[0].pageY - event.touches[1].pageY), 2));\n};\nvar calculatePinchZoom = function (contextInstance, currentDistance) {\n    var pinchStartScale = contextInstance.pinchStartScale, pinchStartDistance = contextInstance.pinchStartDistance, setup = contextInstance.setup;\n    var maxScale = setup.maxScale, minScale = setup.minScale, zoomAnimation = setup.zoomAnimation, disablePadding = setup.disablePadding;\n    var size = zoomAnimation.size, disabled = zoomAnimation.disabled;\n    if (!pinchStartScale || pinchStartDistance === null || !currentDistance) {\n        throw new Error(\"Pinch touches distance was not provided\");\n    }\n    if (currentDistance < 0) {\n        return contextInstance.transformState.scale;\n    }\n    var touchProportion = currentDistance / pinchStartDistance;\n    var scaleDifference = touchProportion * pinchStartScale;\n    return checkZoomBounds(roundNumber(scaleDifference, 2), minScale, maxScale, size, !disabled && !disablePadding);\n};\n\nvar wheelStopEventTime = 160;\nvar wheelAnimationTime = 100;\nvar handleWheelStart = function (contextInstance, event) {\n    var _a = contextInstance.props, onWheelStart = _a.onWheelStart, onZoomStart = _a.onZoomStart;\n    if (!contextInstance.wheelStopEventTimer) {\n        handleCancelAnimation(contextInstance);\n        handleCallback(getContext(contextInstance), event, onWheelStart);\n        handleCallback(getContext(contextInstance), event, onZoomStart);\n    }\n};\nvar handleWheelZoom = function (contextInstance, event) {\n    var _a = contextInstance.props, onWheel = _a.onWheel, onZoom = _a.onZoom;\n    var contentComponent = contextInstance.contentComponent, setup = contextInstance.setup, transformState = contextInstance.transformState;\n    var scale = transformState.scale;\n    var limitToBounds = setup.limitToBounds, centerZoomedOut = setup.centerZoomedOut, zoomAnimation = setup.zoomAnimation, wheel = setup.wheel, disablePadding = setup.disablePadding, smooth = setup.smooth;\n    var size = zoomAnimation.size, disabled = zoomAnimation.disabled;\n    var step = wheel.step, smoothStep = wheel.smoothStep;\n    if (!contentComponent) {\n        throw new Error(\"Component not mounted\");\n    }\n    event.preventDefault();\n    event.stopPropagation();\n    var delta = getDelta(event, null);\n    var zoomStep = smooth ? smoothStep * Math.abs(event.deltaY) : step;\n    var newScale = handleCalculateWheelZoom(contextInstance, delta, zoomStep, !event.ctrlKey);\n    // if scale not change\n    if (scale === newScale)\n        return;\n    var bounds = handleCalculateBounds(contextInstance, newScale);\n    var mousePosition = getMousePosition(event, contentComponent, scale);\n    var isPaddingDisabled = disabled || size === 0 || centerZoomedOut || disablePadding;\n    var isLimitedToBounds = limitToBounds && isPaddingDisabled;\n    var _b = handleCalculateZoomPositions(contextInstance, mousePosition.x, mousePosition.y, newScale, bounds, isLimitedToBounds), x = _b.x, y = _b.y;\n    contextInstance.previousWheelEvent = event;\n    contextInstance.setTransformState(newScale, x, y);\n    handleCallback(getContext(contextInstance), event, onWheel);\n    handleCallback(getContext(contextInstance), event, onZoom);\n};\nvar handleWheelStop = function (contextInstance, event) {\n    var _a = contextInstance.props, onWheelStop = _a.onWheelStop, onZoomStop = _a.onZoomStop;\n    // fire animation\n    cancelTimeout(contextInstance.wheelAnimationTimer);\n    contextInstance.wheelAnimationTimer = setTimeout(function () {\n        if (!contextInstance.mounted)\n            return;\n        handleAlignToScaleBounds(contextInstance, event.x, event.y);\n        contextInstance.wheelAnimationTimer = null;\n    }, wheelAnimationTime);\n    // Wheel stop event\n    var hasStoppedZooming = handleWheelZoomStop(contextInstance, event);\n    if (hasStoppedZooming) {\n        cancelTimeout(contextInstance.wheelStopEventTimer);\n        contextInstance.wheelStopEventTimer = setTimeout(function () {\n            if (!contextInstance.mounted)\n                return;\n            contextInstance.wheelStopEventTimer = null;\n            handleCallback(getContext(contextInstance), event, onWheelStop);\n            handleCallback(getContext(contextInstance), event, onZoomStop);\n        }, wheelStopEventTime);\n    }\n};\n\nvar getTouchCenter = function (event) {\n    var totalX = 0;\n    var totalY = 0;\n    // Sum up the positions of all touches\n    for (var i = 0; i < 2; i += 1) {\n        totalX += event.touches[i].clientX;\n        totalY += event.touches[i].clientY;\n    }\n    // Calculate the average position\n    var x = totalX / 2;\n    var y = totalY / 2;\n    return { x: x, y: y };\n};\nvar handlePinchStart = function (contextInstance, event) {\n    var distance = getTouchDistance(event);\n    contextInstance.pinchStartDistance = distance;\n    contextInstance.lastDistance = distance;\n    contextInstance.pinchStartScale = contextInstance.transformState.scale;\n    contextInstance.isPanning = false;\n    var center = getTouchCenter(event);\n    contextInstance.pinchLastCenterX = center.x;\n    contextInstance.pinchLastCenterY = center.y;\n    handleCancelAnimation(contextInstance);\n};\nvar handlePinchZoom = function (contextInstance, event) {\n    var contentComponent = contextInstance.contentComponent, pinchStartDistance = contextInstance.pinchStartDistance, wrapperComponent = contextInstance.wrapperComponent;\n    var scale = contextInstance.transformState.scale;\n    var _a = contextInstance.setup, limitToBounds = _a.limitToBounds, centerZoomedOut = _a.centerZoomedOut, zoomAnimation = _a.zoomAnimation, alignmentAnimation = _a.alignmentAnimation;\n    var disabled = zoomAnimation.disabled, size = zoomAnimation.size;\n    // if one finger starts from outside of wrapper\n    if (pinchStartDistance === null || !contentComponent)\n        return;\n    var midPoint = calculateTouchMidPoint(event, scale, contentComponent);\n    // if touches goes off of the wrapper element\n    if (!Number.isFinite(midPoint.x) || !Number.isFinite(midPoint.y))\n        return;\n    var currentDistance = getTouchDistance(event);\n    var newScale = calculatePinchZoom(contextInstance, currentDistance);\n    var center = getTouchCenter(event);\n    // pan should be scale invariant.\n    var panX = center.x - (contextInstance.pinchLastCenterX || 0);\n    var panY = center.y - (contextInstance.pinchLastCenterY || 0);\n    if (newScale === scale && panX === 0 && panY === 0)\n        return;\n    contextInstance.pinchLastCenterX = center.x;\n    contextInstance.pinchLastCenterY = center.y;\n    var bounds = handleCalculateBounds(contextInstance, newScale);\n    var isPaddingDisabled = disabled || size === 0 || centerZoomedOut;\n    var isLimitedToBounds = limitToBounds && isPaddingDisabled;\n    var _b = handleCalculateZoomPositions(contextInstance, midPoint.x, midPoint.y, newScale, bounds, isLimitedToBounds), x = _b.x, y = _b.y;\n    contextInstance.pinchMidpoint = midPoint;\n    contextInstance.lastDistance = currentDistance;\n    var sizeX = alignmentAnimation.sizeX, sizeY = alignmentAnimation.sizeY;\n    var paddingValueX = getPaddingValue(contextInstance, sizeX);\n    var paddingValueY = getPaddingValue(contextInstance, sizeY);\n    var newPositionX = x + panX;\n    var newPositionY = y + panY;\n    var _c = getMouseBoundedPosition(newPositionX, newPositionY, bounds, limitToBounds, paddingValueX, paddingValueY, wrapperComponent), finalX = _c.x, finalY = _c.y;\n    contextInstance.setTransformState(newScale, finalX, finalY);\n};\nvar handlePinchStop = function (contextInstance) {\n    var pinchMidpoint = contextInstance.pinchMidpoint;\n    contextInstance.velocity = null;\n    contextInstance.lastDistance = null;\n    contextInstance.pinchMidpoint = null;\n    contextInstance.pinchStartScale = null;\n    contextInstance.pinchStartDistance = null;\n    handleAlignToScaleBounds(contextInstance, pinchMidpoint === null || pinchMidpoint === void 0 ? void 0 : pinchMidpoint.x, pinchMidpoint === null || pinchMidpoint === void 0 ? void 0 : pinchMidpoint.y);\n};\n\nvar handleDoubleClickStop = function (contextInstance, event) {\n    var onZoomStop = contextInstance.props.onZoomStop;\n    var animationTime = contextInstance.setup.doubleClick.animationTime;\n    cancelTimeout(contextInstance.doubleClickStopEventTimer);\n    contextInstance.doubleClickStopEventTimer = setTimeout(function () {\n        contextInstance.doubleClickStopEventTimer = null;\n        handleCallback(getContext(contextInstance), event, onZoomStop);\n    }, animationTime);\n};\nvar handleDoubleClickResetMode = function (contextInstance, event) {\n    var _a = contextInstance.props, onZoomStart = _a.onZoomStart, onZoom = _a.onZoom;\n    var _b = contextInstance.setup.doubleClick, animationTime = _b.animationTime, animationType = _b.animationType;\n    handleCallback(getContext(contextInstance), event, onZoomStart);\n    resetTransformations(contextInstance, animationTime, animationType, function () {\n        return handleCallback(getContext(contextInstance), event, onZoom);\n    });\n    handleDoubleClickStop(contextInstance, event);\n};\nfunction getDoubleClickScale(mode, scale) {\n    if (mode === \"toggle\") {\n        return scale === 1 ? 1 : -1;\n    }\n    return mode === \"zoomOut\" ? -1 : 1;\n}\nfunction handleDoubleClick(contextInstance, event) {\n    var setup = contextInstance.setup, doubleClickStopEventTimer = contextInstance.doubleClickStopEventTimer, transformState = contextInstance.transformState, contentComponent = contextInstance.contentComponent;\n    var scale = transformState.scale;\n    var _a = contextInstance.props, onZoomStart = _a.onZoomStart, onZoom = _a.onZoom;\n    var _b = setup.doubleClick, disabled = _b.disabled, mode = _b.mode, step = _b.step, animationTime = _b.animationTime, animationType = _b.animationType;\n    if (disabled)\n        return;\n    if (doubleClickStopEventTimer)\n        return;\n    if (mode === \"reset\") {\n        return handleDoubleClickResetMode(contextInstance, event);\n    }\n    if (!contentComponent)\n        return console.error(\"No ContentComponent found\");\n    var delta = getDoubleClickScale(mode, contextInstance.transformState.scale);\n    var newScale = handleCalculateButtonZoom(contextInstance, delta, step);\n    // stop execution when scale didn't change\n    if (scale === newScale)\n        return;\n    handleCallback(getContext(contextInstance), event, onZoomStart);\n    var mousePosition = getMousePosition(event, contentComponent, scale);\n    var targetState = handleZoomToPoint(contextInstance, newScale, mousePosition.x, mousePosition.y);\n    if (!targetState) {\n        return console.error(\"Error during zoom event. New transformation state was not calculated.\");\n    }\n    handleCallback(getContext(contextInstance), event, onZoom);\n    animate(contextInstance, targetState, animationTime, animationType);\n    handleDoubleClickStop(contextInstance, event);\n}\nvar isDoubleClickAllowed = function (contextInstance, event) {\n    var isInitialized = contextInstance.isInitialized, setup = contextInstance.setup, wrapperComponent = contextInstance.wrapperComponent;\n    var _a = setup.doubleClick, disabled = _a.disabled, excluded = _a.excluded;\n    var target = event.target;\n    var isWrapperChild = wrapperComponent === null || wrapperComponent === void 0 ? void 0 : wrapperComponent.contains(target);\n    var isAllowed = isInitialized && target && isWrapperChild && !disabled;\n    if (!isAllowed)\n        return false;\n    var isExcluded = isExcludedNode(target, excluded);\n    if (isExcluded)\n        return false;\n    return true;\n};\n\nvar ZoomPanPinch = /** @class */ (function () {\n    function ZoomPanPinch(props) {\n        var _this = this;\n        this.mounted = true;\n        this.pinchLastCenterX = null;\n        this.pinchLastCenterY = null;\n        this.onChangeCallbacks = new Set();\n        this.onInitCallbacks = new Set();\n        // Components\n        this.wrapperComponent = null;\n        this.contentComponent = null;\n        // Initialization\n        this.isInitialized = false;\n        this.bounds = null;\n        // wheel helpers\n        this.previousWheelEvent = null;\n        this.wheelStopEventTimer = null;\n        this.wheelAnimationTimer = null;\n        // panning helpers\n        this.isPanning = false;\n        this.isWheelPanning = false;\n        this.startCoords = null;\n        this.lastTouch = null;\n        // pinch helpers\n        this.distance = null;\n        this.lastDistance = null;\n        this.pinchStartDistance = null;\n        this.pinchStartScale = null;\n        this.pinchMidpoint = null;\n        // double click helpers\n        this.doubleClickStopEventTimer = null;\n        // velocity helpers\n        this.velocity = null;\n        this.velocityTime = null;\n        this.lastMousePosition = null;\n        // animations helpers\n        this.animate = false;\n        this.animation = null;\n        this.maxBounds = null;\n        // key press\n        this.pressedKeys = {};\n        this.mount = function () {\n            _this.initializeWindowEvents();\n        };\n        this.unmount = function () {\n            _this.cleanupWindowEvents();\n        };\n        this.update = function (newProps) {\n            _this.props = newProps;\n            handleCalculateBounds(_this, _this.transformState.scale);\n            _this.setup = createSetup(newProps);\n        };\n        this.initializeWindowEvents = function () {\n            var _a, _b;\n            var passive = makePassiveEventOption();\n            var currentDocument = (_a = _this.wrapperComponent) === null || _a === void 0 ? void 0 : _a.ownerDocument;\n            var currentWindow = currentDocument === null || currentDocument === void 0 ? void 0 : currentDocument.defaultView;\n            (_b = _this.wrapperComponent) === null || _b === void 0 ? void 0 : _b.addEventListener(\"wheel\", _this.onWheelPanning, passive);\n            // Panning on window to allow panning when mouse is out of component wrapper\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.addEventListener(\"mousedown\", _this.onPanningStart, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.addEventListener(\"mousemove\", _this.onPanning, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.addEventListener(\"mouseup\", _this.onPanningStop, passive);\n            currentDocument === null || currentDocument === void 0 ? void 0 : currentDocument.addEventListener(\"mouseleave\", _this.clearPanning, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.addEventListener(\"keyup\", _this.setKeyUnPressed, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.addEventListener(\"keydown\", _this.setKeyPressed, passive);\n        };\n        this.cleanupWindowEvents = function () {\n            var _a, _b;\n            var passive = makePassiveEventOption();\n            var currentDocument = (_a = _this.wrapperComponent) === null || _a === void 0 ? void 0 : _a.ownerDocument;\n            var currentWindow = currentDocument === null || currentDocument === void 0 ? void 0 : currentDocument.defaultView;\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.removeEventListener(\"mousedown\", _this.onPanningStart, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.removeEventListener(\"mousemove\", _this.onPanning, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.removeEventListener(\"mouseup\", _this.onPanningStop, passive);\n            currentDocument === null || currentDocument === void 0 ? void 0 : currentDocument.removeEventListener(\"mouseleave\", _this.clearPanning, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.removeEventListener(\"keyup\", _this.setKeyUnPressed, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.removeEventListener(\"keydown\", _this.setKeyPressed, passive);\n            document.removeEventListener(\"mouseleave\", _this.clearPanning, passive);\n            handleCancelAnimation(_this);\n            (_b = _this.observer) === null || _b === void 0 ? void 0 : _b.disconnect();\n        };\n        this.handleInitializeWrapperEvents = function (wrapper) {\n            // Zooming events on wrapper\n            var passive = makePassiveEventOption();\n            wrapper.addEventListener(\"wheel\", _this.onWheelZoom, passive);\n            wrapper.addEventListener(\"dblclick\", _this.onDoubleClick, passive);\n            wrapper.addEventListener(\"touchstart\", _this.onTouchPanningStart, passive);\n            wrapper.addEventListener(\"touchmove\", _this.onTouchPanning, passive);\n            wrapper.addEventListener(\"touchend\", _this.onTouchPanningStop, passive);\n        };\n        this.handleInitialize = function (wrapper, contentComponent) {\n            var isCentered = false;\n            var centerOnInit = _this.setup.centerOnInit;\n            var hasTarget = function (entries, target) {\n                // eslint-disable-next-line no-restricted-syntax\n                for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\n                    var entry = entries_1[_i];\n                    if (entry.target === target) {\n                        return true;\n                    }\n                }\n                return false;\n            };\n            _this.applyTransformation();\n            _this.onInitCallbacks.forEach(function (callback) {\n                callback(getContext(_this));\n            });\n            _this.observer = new ResizeObserver(function (entries) {\n                if (hasTarget(entries, wrapper) || hasTarget(entries, contentComponent)) {\n                    if (centerOnInit && !isCentered) {\n                        var currentWidth = contentComponent.offsetWidth;\n                        var currentHeight = contentComponent.offsetHeight;\n                        if (currentWidth > 0 || currentHeight > 0) {\n                            isCentered = true;\n                            _this.setCenter();\n                        }\n                    }\n                    else {\n                        handleCancelAnimation(_this);\n                        handleCalculateBounds(_this, _this.transformState.scale);\n                        handleAlignToBounds(_this, 0);\n                    }\n                }\n            });\n            // Start observing the target node for configured mutations\n            _this.observer.observe(wrapper);\n            _this.observer.observe(contentComponent);\n        };\n        /// ///////\n        // Zoom\n        /// ///////\n        this.onWheelZoom = function (event) {\n            var disabled = _this.setup.disabled;\n            if (disabled)\n                return;\n            var isAllowed = isWheelAllowed(_this, event);\n            if (!isAllowed)\n                return;\n            var keysPressed = _this.isPressingKeys(_this.setup.wheel.activationKeys);\n            if (!keysPressed)\n                return;\n            handleWheelStart(_this, event);\n            handleWheelZoom(_this, event);\n            handleWheelStop(_this, event);\n        };\n        /// ///////\n        // Pan\n        /// ///////\n        this.onWheelPanning = function (event) {\n            var _a = _this.setup, disabled = _a.disabled, wheel = _a.wheel, panning = _a.panning;\n            if (!_this.wrapperComponent ||\n                !_this.contentComponent ||\n                disabled ||\n                !wheel.wheelDisabled ||\n                panning.disabled ||\n                !panning.wheelPanning ||\n                event.ctrlKey) {\n                return;\n            }\n            event.preventDefault();\n            event.stopPropagation();\n            var _b = _this.transformState, positionX = _b.positionX, positionY = _b.positionY;\n            var mouseX = positionX - event.deltaX;\n            var mouseY = positionY - event.deltaY;\n            var newPositionX = panning.lockAxisX ? positionX : mouseX;\n            var newPositionY = panning.lockAxisY ? positionY : mouseY;\n            var _c = _this.setup.alignmentAnimation, sizeX = _c.sizeX, sizeY = _c.sizeY;\n            var paddingValueX = getPaddingValue(_this, sizeX);\n            var paddingValueY = getPaddingValue(_this, sizeY);\n            if (newPositionX === positionX && newPositionY === positionY)\n                return;\n            handleNewPosition(_this, newPositionX, newPositionY, paddingValueX, paddingValueY);\n        };\n        this.onPanningStart = function (event) {\n            var disabled = _this.setup.disabled;\n            var onPanningStart = _this.props.onPanningStart;\n            if (disabled)\n                return;\n            var isAllowed = isPanningStartAllowed(_this, event);\n            if (!isAllowed)\n                return;\n            var keysPressed = _this.isPressingKeys(_this.setup.panning.activationKeys);\n            if (!keysPressed)\n                return;\n            if (event.button === 0 && !_this.setup.panning.allowLeftClickPan)\n                return;\n            if (event.button === 1 && !_this.setup.panning.allowMiddleClickPan)\n                return;\n            if (event.button === 2 && !_this.setup.panning.allowRightClickPan)\n                return;\n            event.preventDefault();\n            event.stopPropagation();\n            handleCancelAnimation(_this);\n            handlePanningStart(_this, event);\n            handleCallback(getContext(_this), event, onPanningStart);\n        };\n        this.onPanning = function (event) {\n            var disabled = _this.setup.disabled;\n            var onPanning = _this.props.onPanning;\n            if (disabled)\n                return;\n            var isAllowed = isPanningAllowed(_this);\n            if (!isAllowed)\n                return;\n            var keysPressed = _this.isPressingKeys(_this.setup.panning.activationKeys);\n            if (!keysPressed)\n                return;\n            event.preventDefault();\n            event.stopPropagation();\n            handlePanning(_this, event.clientX, event.clientY);\n            handleCallback(getContext(_this), event, onPanning);\n        };\n        this.onPanningStop = function (event) {\n            var onPanningStop = _this.props.onPanningStop;\n            if (_this.isPanning) {\n                handlePanningEnd(_this);\n                handleCallback(getContext(_this), event, onPanningStop);\n            }\n        };\n        /// ///////\n        // Pinch\n        /// ///////\n        this.onPinchStart = function (event) {\n            var disabled = _this.setup.disabled;\n            var _a = _this.props, onPinchingStart = _a.onPinchingStart, onZoomStart = _a.onZoomStart;\n            if (disabled)\n                return;\n            var isAllowed = isPinchStartAllowed(_this, event);\n            if (!isAllowed)\n                return;\n            handlePinchStart(_this, event);\n            handleCancelAnimation(_this);\n            handleCallback(getContext(_this), event, onPinchingStart);\n            handleCallback(getContext(_this), event, onZoomStart);\n        };\n        this.onPinch = function (event) {\n            var disabled = _this.setup.disabled;\n            var _a = _this.props, onPinching = _a.onPinching, onZoom = _a.onZoom;\n            if (disabled)\n                return;\n            var isAllowed = isPinchAllowed(_this);\n            if (!isAllowed)\n                return;\n            event.preventDefault();\n            event.stopPropagation();\n            handlePinchZoom(_this, event);\n            handleCallback(getContext(_this), event, onPinching);\n            handleCallback(getContext(_this), event, onZoom);\n        };\n        this.onPinchStop = function (event) {\n            var _a = _this.props, onPinchingStop = _a.onPinchingStop, onZoomStop = _a.onZoomStop;\n            if (_this.pinchStartScale) {\n                handlePinchStop(_this);\n                handleCallback(getContext(_this), event, onPinchingStop);\n                handleCallback(getContext(_this), event, onZoomStop);\n            }\n        };\n        /// ///////\n        // Touch\n        /// ///////\n        this.onTouchPanningStart = function (event) {\n            var disabled = _this.setup.disabled;\n            var onPanningStart = _this.props.onPanningStart;\n            if (disabled)\n                return;\n            var isAllowed = isPanningStartAllowed(_this, event);\n            if (!isAllowed)\n                return;\n            var isDoubleTap = _this.lastTouch &&\n                +new Date() - _this.lastTouch < 200 &&\n                event.touches.length === 1;\n            if (!isDoubleTap) {\n                _this.lastTouch = +new Date();\n                handleCancelAnimation(_this);\n                var touches = event.touches;\n                var isPanningAction = touches.length === 1;\n                var isPinchAction = touches.length === 2;\n                if (isPanningAction) {\n                    handleCancelAnimation(_this);\n                    handlePanningStart(_this, event);\n                    handleCallback(getContext(_this), event, onPanningStart);\n                }\n                if (isPinchAction) {\n                    _this.onPinchStart(event);\n                }\n            }\n        };\n        this.onTouchPanning = function (event) {\n            var disabled = _this.setup.disabled;\n            var onPanning = _this.props.onPanning;\n            if (_this.isPanning && event.touches.length === 1) {\n                if (disabled)\n                    return;\n                var isAllowed = isPanningAllowed(_this);\n                if (!isAllowed)\n                    return;\n                event.preventDefault();\n                event.stopPropagation();\n                var touch = event.touches[0];\n                handlePanning(_this, touch.clientX, touch.clientY);\n                handleCallback(getContext(_this), event, onPanning);\n            }\n            else if (event.touches.length > 1) {\n                _this.onPinch(event);\n            }\n        };\n        this.onTouchPanningStop = function (event) {\n            _this.onPanningStop(event);\n            _this.onPinchStop(event);\n        };\n        /// ///////\n        // Double Click\n        /// ///////\n        this.onDoubleClick = function (event) {\n            var disabled = _this.setup.disabled;\n            if (disabled)\n                return;\n            var isAllowed = isDoubleClickAllowed(_this, event);\n            if (!isAllowed)\n                return;\n            handleDoubleClick(_this, event);\n        };\n        /// ///////\n        // Helpers\n        /// ///////\n        this.clearPanning = function (event) {\n            if (_this.isPanning) {\n                _this.onPanningStop(event);\n            }\n        };\n        this.setKeyPressed = function (e) {\n            _this.pressedKeys[e.key] = true;\n        };\n        this.setKeyUnPressed = function (e) {\n            _this.pressedKeys[e.key] = false;\n        };\n        this.isPressingKeys = function (keys) {\n            if (!keys.length) {\n                return true;\n            }\n            return Boolean(keys.find(function (key) { return _this.pressedKeys[key]; }));\n        };\n        this.setTransformState = function (scale, positionX, positionY) {\n            var onTransformed = _this.props.onTransformed;\n            if (!Number.isNaN(scale) &&\n                !Number.isNaN(positionX) &&\n                !Number.isNaN(positionY)) {\n                if (scale !== _this.transformState.scale) {\n                    _this.transformState.previousScale = _this.transformState.scale;\n                    _this.transformState.scale = scale;\n                }\n                _this.transformState.positionX = positionX;\n                _this.transformState.positionY = positionY;\n                _this.applyTransformation();\n                var ctx_1 = getContext(_this);\n                _this.onChangeCallbacks.forEach(function (callback) { return callback(ctx_1); });\n                handleCallback(ctx_1, { scale: scale, positionX: positionX, positionY: positionY }, onTransformed);\n            }\n            else {\n                console.error(\"Detected NaN set state values\");\n            }\n        };\n        this.setCenter = function () {\n            if (_this.wrapperComponent && _this.contentComponent) {\n                var targetState = getCenterPosition(_this.transformState.scale, _this.wrapperComponent, _this.contentComponent);\n                _this.setTransformState(targetState.scale, targetState.positionX, targetState.positionY);\n            }\n        };\n        this.handleTransformStyles = function (x, y, scale) {\n            if (_this.props.customTransform) {\n                return _this.props.customTransform(x, y, scale);\n            }\n            return getTransformStyles(x, y, scale);\n        };\n        this.applyTransformation = function () {\n            if (!_this.mounted || !_this.contentComponent)\n                return;\n            var _a = _this.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n            var transform = _this.handleTransformStyles(positionX, positionY, scale);\n            _this.contentComponent.style.transform = transform;\n        };\n        this.getContext = function () {\n            return getContext(_this);\n        };\n        /**\n         * Hooks\n         */\n        this.onChange = function (callback) {\n            if (!_this.onChangeCallbacks.has(callback)) {\n                _this.onChangeCallbacks.add(callback);\n            }\n            return function () {\n                _this.onChangeCallbacks.delete(callback);\n            };\n        };\n        this.onInit = function (callback) {\n            if (!_this.onInitCallbacks.has(callback)) {\n                _this.onInitCallbacks.add(callback);\n            }\n            return function () {\n                _this.onInitCallbacks.delete(callback);\n            };\n        };\n        /**\n         * Initialization\n         */\n        this.init = function (wrapperComponent, contentComponent) {\n            _this.cleanupWindowEvents();\n            _this.wrapperComponent = wrapperComponent;\n            _this.contentComponent = contentComponent;\n            handleCalculateBounds(_this, _this.transformState.scale);\n            _this.handleInitializeWrapperEvents(wrapperComponent);\n            _this.handleInitialize(wrapperComponent, contentComponent);\n            _this.initializeWindowEvents();\n            _this.isInitialized = true;\n            var ctx = getContext(_this);\n            handleCallback(ctx, undefined, _this.props.onInit);\n        };\n        this.props = props;\n        this.setup = createSetup(this.props);\n        this.transformState = createState(this.props);\n    }\n    return ZoomPanPinch;\n}());\n\nvar Context = React.createContext(null);\nvar getContent = function (children, ctx) {\n    if (typeof children === \"function\") {\n        return children(ctx);\n    }\n    return children;\n};\nvar TransformWrapper = React.forwardRef(function (props, ref) {\n    var instance = useRef(new ZoomPanPinch(props)).current;\n    var content = getContent(props.children, getControls(instance));\n    useImperativeHandle(ref, function () { return getControls(instance); }, [instance]);\n    useEffect(function () {\n        instance.update(props);\n    }, [instance, props]);\n    return React.createElement(Context.Provider, { value: instance }, content);\n});\n\nvar KeepScale = React.forwardRef(function (props, ref) {\n    var localRef = useRef(null);\n    var instance = useContext(Context);\n    useEffect(function () {\n        return instance.onChange(function (ctx) {\n            if (localRef.current) {\n                var positionX = 0;\n                var positionY = 0;\n                localRef.current.style.transform = instance.handleTransformStyles(positionX, positionY, 1 / ctx.instance.transformState.scale);\n            }\n        });\n    }, [instance]);\n    return React.createElement(\"div\", __assign({}, props, { ref: mergeRefs([localRef, ref]) }));\n});\n\nvar initialElementRect = {\n    width: 0,\n    height: 0,\n    y: 0,\n    x: 0,\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0,\n};\nvar useResize = function (ref, onResize, dependencies) {\n    var resizeObserverRef = useRef();\n    var rectRef = useRef(initialElementRect);\n    var didUnmount = useRef(false);\n    useLayoutEffect(function () {\n        var _a;\n        didUnmount.current = false;\n        if (!(\"ResizeObserver\" in window)) {\n            return;\n        }\n        if (ref) {\n            resizeObserverRef.current = new ResizeObserver(function (entries) {\n                var newSize = ref.getBoundingClientRect();\n                if (!Array.isArray(entries) ||\n                    !entries.length ||\n                    didUnmount.current ||\n                    (newSize.width === rectRef.current.width &&\n                        newSize.height === rectRef.current.height))\n                    return;\n                onResize(newSize, ref);\n                rectRef.current = newSize;\n            });\n            (_a = resizeObserverRef.current) === null || _a === void 0 ? void 0 : _a.observe(ref);\n        }\n        return function () {\n            var _a;\n            didUnmount.current = true;\n            if (ref) {\n                (_a = resizeObserverRef.current) === null || _a === void 0 ? void 0 : _a.unobserve(ref);\n            }\n        };\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, __spreadArray([onResize, ref], dependencies, true));\n};\n\nvar previewStyles = {\n    position: \"absolute\",\n    zIndex: 2,\n    top: \"0px\",\n    left: \"0px\",\n    boxSizing: \"border-box\",\n    border: \"3px solid red\",\n    transformOrigin: \"0% 0%\",\n    boxShadow: \"rgba(0,0,0,0.2) 0 0 0 10000000px\",\n};\nvar MiniMap = function (_a) {\n    var _b = _a.width, width = _b === void 0 ? 200 : _b, _c = _a.height, height = _c === void 0 ? 200 : _c, _d = _a.borderColor, borderColor = _d === void 0 ? \"red\" : _d, children = _a.children, rest = __rest(_a, [\"width\", \"height\", \"borderColor\", \"children\"]);\n    var _e = useState(false), initialized = _e[0], setInitialized = _e[1];\n    var instance = useTransformContext();\n    var miniMapInstance = useRef(null);\n    var mainRef = useRef(null);\n    var wrapperRef = useRef(null);\n    var previewRef = useRef(null);\n    var getViewportSize = useCallback(function () {\n        if (instance.wrapperComponent) {\n            var rect = instance.wrapperComponent.getBoundingClientRect();\n            return {\n                width: rect.width,\n                height: rect.height,\n            };\n        }\n        return {\n            width: 0,\n            height: 0,\n        };\n    }, [instance.wrapperComponent]);\n    var getContentSize = useCallback(function () {\n        if (instance.contentComponent) {\n            var rect = instance.contentComponent.getBoundingClientRect();\n            return {\n                width: rect.width / instance.transformState.scale,\n                height: rect.height / instance.transformState.scale,\n            };\n        }\n        return {\n            width: 0,\n            height: 0,\n        };\n    }, [instance.contentComponent, instance.transformState.scale]);\n    var computeMiniMapScale = useCallback(function () {\n        var contentSize = getContentSize();\n        var scaleX = width / contentSize.width;\n        var scaleY = height / contentSize.height;\n        var scale = scaleY > scaleX ? scaleX : scaleY;\n        return scale;\n    }, [getContentSize, height, width]);\n    var computeMiniMapSize = function () {\n        var contentSize = getContentSize();\n        var scaleX = width / contentSize.width;\n        var scaleY = height / contentSize.height;\n        if (scaleY > scaleX) {\n            return { width: width, height: contentSize.height * scaleX };\n        }\n        return { width: contentSize.width * scaleY, height: height };\n    };\n    var computeMiniMapStyle = function () {\n        var scale = computeMiniMapScale();\n        var style = {\n            transform: \"scale(\".concat(scale || 1, \")\"),\n            transformOrigin: \"0% 0%\",\n            position: \"absolute\",\n            boxSizing: \"border-box\",\n            zIndex: 1,\n            overflow: \"hidden\",\n        };\n        Object.keys(style).forEach(function (key) {\n            if (wrapperRef.current) {\n                wrapperRef.current.style[key] = style[key];\n            }\n        });\n    };\n    var transformMiniMap = function () {\n        computeMiniMapStyle();\n        var miniSize = computeMiniMapSize();\n        var wrapSize = getContentSize();\n        if (wrapperRef.current) {\n            wrapperRef.current.style.width = \"\".concat(wrapSize.width, \"px\");\n            wrapperRef.current.style.height = \"\".concat(wrapSize.height, \"px\");\n        }\n        if (mainRef.current) {\n            mainRef.current.style.width = \"\".concat(miniSize.width, \"px\");\n            mainRef.current.style.height = \"\".concat(miniSize.height, \"px\");\n        }\n        if (previewRef.current) {\n            var size = getViewportSize();\n            var scale = computeMiniMapScale();\n            var previewScale = scale * (1 / instance.transformState.scale);\n            var transform = instance.handleTransformStyles(-instance.transformState.positionX * previewScale, -instance.transformState.positionY * previewScale, 1);\n            previewRef.current.style.transform = transform;\n            previewRef.current.style.width = \"\".concat(size.width * previewScale, \"px\");\n            previewRef.current.style.height = \"\".concat(size.height * previewScale, \"px\");\n        }\n    };\n    var initialize = function () {\n        transformMiniMap();\n    };\n    useTransformEffect(function () {\n        transformMiniMap();\n    });\n    useTransformInit(function () {\n        initialize();\n        setInitialized(true);\n    });\n    useResize(instance.contentComponent, initialize, [initialized]);\n    useEffect(function () {\n        return instance.onChange(function (zpp) {\n            var scale = computeMiniMapScale();\n            if (miniMapInstance.current) {\n                miniMapInstance.current.instance.transformState.scale =\n                    zpp.instance.transformState.scale;\n                miniMapInstance.current.instance.transformState.positionX =\n                    zpp.instance.transformState.positionX * scale;\n                miniMapInstance.current.instance.transformState.positionY =\n                    zpp.instance.transformState.positionY * scale;\n            }\n        });\n    }, [computeMiniMapScale, instance, miniMapInstance]);\n    var wrapperStyle = useMemo(function () {\n        return {\n            position: \"relative\",\n            zIndex: 2,\n            overflow: \"hidden\",\n        };\n    }, []);\n    return (React.createElement(\"div\", __assign({}, rest, { ref: mainRef, style: wrapperStyle, className: \"rzpp-mini-map \".concat(rest.className || \"\") }),\n        React.createElement(\"div\", __assign({}, rest, { ref: wrapperRef, className: \"rzpp-wrapper\" }), children),\n        React.createElement(\"div\", { className: \"rzpp-preview\", ref: previewRef, style: __assign(__assign({}, previewStyles), { borderColor: borderColor }) })));\n};\n\nfunction styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar css_248z = \".transform-component-module_wrapper__SPB86 {\\n  position: relative;\\n  width: -moz-fit-content;\\n  width: fit-content;\\n  height: -moz-fit-content;\\n  height: fit-content;\\n  overflow: hidden;\\n  -webkit-touch-callout: none; /* iOS Safari */\\n  -webkit-user-select: none; /* Safari */\\n  -khtml-user-select: none; /* Konqueror HTML */\\n  -moz-user-select: none; /* Firefox */\\n  -ms-user-select: none; /* Internet Explorer/Edge */\\n  user-select: none;\\n  margin: 0;\\n  padding: 0;\\n  transform: translate3d(0, 0, 0);\\n}\\n.transform-component-module_content__FBWxo {\\n  display: flex;\\n  flex-wrap: wrap;\\n  width: -moz-fit-content;\\n  width: fit-content;\\n  height: -moz-fit-content;\\n  height: fit-content;\\n  margin: 0;\\n  padding: 0;\\n  transform-origin: 0% 0%;\\n}\\n.transform-component-module_content__FBWxo img {\\n  pointer-events: none;\\n}\\n\";\nvar styles = {\"wrapper\":\"transform-component-module_wrapper__SPB86\",\"content\":\"transform-component-module_content__FBWxo\"};\nstyleInject(css_248z);\n\nvar TransformComponent = function (_a) {\n    var children = _a.children, _b = _a.wrapperClass, wrapperClass = _b === void 0 ? \"\" : _b, _c = _a.contentClass, contentClass = _c === void 0 ? \"\" : _c, wrapperStyle = _a.wrapperStyle, contentStyle = _a.contentStyle, _d = _a.wrapperProps, wrapperProps = _d === void 0 ? {} : _d, _e = _a.contentProps, contentProps = _e === void 0 ? {} : _e;\n    var _f = useContext(Context), init = _f.init, cleanupWindowEvents = _f.cleanupWindowEvents;\n    var wrapperRef = useRef(null);\n    var contentRef = useRef(null);\n    useEffect(function () {\n        var wrapper = wrapperRef.current;\n        var content = contentRef.current;\n        if (wrapper !== null && content !== null && init) {\n            init === null || init === void 0 ? void 0 : init(wrapper, content);\n        }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        return function () {\n            cleanupWindowEvents === null || cleanupWindowEvents === void 0 ? void 0 : cleanupWindowEvents();\n        };\n    }, []);\n    return (React.createElement(\"div\", __assign({}, wrapperProps, { ref: wrapperRef, className: \"\".concat(baseClasses.wrapperClass, \" \").concat(styles.wrapper, \" \").concat(wrapperClass), style: wrapperStyle }),\n        React.createElement(\"div\", __assign({}, contentProps, { ref: contentRef, className: \"\".concat(baseClasses.contentClass, \" \").concat(styles.content, \" \").concat(contentClass), style: contentStyle }), children)));\n};\n\nvar useTransformContext = function () {\n    var libraryContext = useContext(Context);\n    if (!libraryContext) {\n        throw new Error(\"Transform context must be placed inside TransformWrapper\");\n    }\n    return libraryContext;\n};\n\nvar useControls = function () {\n    var libraryContext = useTransformContext();\n    return getControls(libraryContext);\n};\n\nvar useTransformInit = function (callback) {\n    var libraryContext = useTransformContext();\n    useEffect(function () {\n        var unmountCallback;\n        var unmount;\n        if (libraryContext.contentComponent && libraryContext.wrapperComponent) {\n            unmountCallback = callback(getState(libraryContext));\n        }\n        else {\n            unmount = libraryContext.onInit(function (ref) {\n                unmountCallback = callback(getState(ref.instance));\n            });\n        }\n        return function () {\n            unmount === null || unmount === void 0 ? void 0 : unmount();\n            unmountCallback === null || unmountCallback === void 0 ? void 0 : unmountCallback();\n        };\n    }, []);\n};\n\nvar useTransformEffect = function (callback) {\n    var libraryContext = useTransformContext();\n    useEffect(function () {\n        var unmountCallback;\n        var unmount = libraryContext.onChange(function (ref) {\n            unmountCallback = callback(getState(ref.instance));\n        });\n        return function () {\n            unmount();\n            unmountCallback === null || unmountCallback === void 0 ? void 0 : unmountCallback();\n        };\n    }, [callback, libraryContext]);\n};\n\nfunction useTransformComponent(callback) {\n    var libraryContext = useTransformContext();\n    var _a = useState(callback(getState(libraryContext))), transformRender = _a[0], setTransformRender = _a[1];\n    useEffect(function () {\n        var mounted = true;\n        var unmount = libraryContext.onChange(function (ref) {\n            if (mounted) {\n                setTransformRender(callback(getState(ref.instance)));\n            }\n        });\n        return function () {\n            unmount();\n            mounted = false;\n        };\n    }, [callback, libraryContext]);\n    return transformRender;\n}\n\nexport { Context, KeepScale, MiniMap, TransformComponent, TransformWrapper, getCenterPosition, getMatrixTransformStyles, getTransformStyles, useControls, useTransformComponent, useTransformContext, useTransformEffect, useTransformInit };\n//# sourceMappingURL=index.esm.js.map\n","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"m5 9 1.41 1.41L11 5.83V22h2V5.83l4.59 4.59L19 9l-7-7z\"\n}), 'North');","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"m21.9 21.9-8.49-8.49-9.82-9.82L2.1 2.1.69 3.51 3 5.83V19c0 1.1.9 2 2 2h13.17l2.31 2.31zM5 18l3.5-4.5 2.5 3.01L12.17 15l3 3zm16 .17L5.83 3H19c1.1 0 2 .9 2 2z\"\n}), 'ImageNotSupported');","import React, { useState, useRef, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { \r\n  Box, \r\n  Typography, \r\n  Button, \r\n  Paper, \r\n  IconButton, \r\n  List,\r\n  ListItem,\r\n  ListItemText,\r\n  Collapse,\r\n  ListItemButton,\r\n  ListItemIcon,\r\n  Tooltip,\r\n  CircularProgress,\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  DialogActions,\r\n  TextField,\r\n  FormControlLabel,\r\n  Checkbox,\r\n  Select,\r\n  MenuItem,\r\n  FormControl,\r\n  InputLabel,\r\n  Stack,\r\n  SpeedDial,\r\n  SpeedDialIcon,\r\n  SpeedDialAction,\r\n  Grid,\r\n  ListItemSecondaryAction,\r\n  Divider,\r\n  Card,\r\n  CardHeader,\r\n  CardContent,\r\n  CardActions,\r\n  Drawer,\r\n  Tabs,\r\n  Tab,\r\n  Chip,\r\n  Autocomplete,\r\n  Fab\r\n} from '@mui/material';\r\nimport CloseIcon from '@mui/icons-material/Close';\r\nimport AddIcon from '@mui/icons-material/Add';\r\nimport RemoveIcon from '@mui/icons-material/Remove';\r\nimport RestartAltIcon from '@mui/icons-material/RestartAlt';\r\nimport { TransformWrapper, TransformComponent } from 'react-zoom-pan-pinch';\r\nimport { useStore } from '../store';\r\nimport { CustomLocation, Character, Item, Combat } from '../store';\r\nimport NorthIcon from '@mui/icons-material/North';\r\nimport { Howl } from 'howler';\r\nimport { AudioTrackPanel } from '../components/AudioTrackPanel';\r\nimport { AssetDropZone } from '../components/AssetDropZone';\r\nimport { AssetManager } from '../services/assetManager';\r\nimport ImageNotSupportedIcon from '@mui/icons-material/ImageNotSupported';\r\nimport SportsKabaddiIcon from '@mui/icons-material/SportsKabaddi';\r\nimport { \r\n  PlaceOutlined as PlaceIcon,\r\n  ArrowUpward as ArrowUpwardIcon,\r\n  ArrowDownward as ArrowDownwardIcon,\r\n  ArrowBack as ArrowBackIcon,\r\n  ArrowForward as ArrowForwardIcon,\r\n  Edit as EditIcon,\r\n  Save as SaveIcon,\r\n  Cancel as CancelIcon,\r\n  Delete as DeleteIcon,\r\n  MusicNote as MusicNoteIcon,\r\n  Person as PersonIcon,\r\n  Store as MerchantIcon,\r\n  ExpandMore as ExpandMoreIcon,\r\n  ExpandLess as ExpandLessIcon\r\n} from '@mui/icons-material';\r\n\r\nexport const MapView: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const locations = useStore((state) => state.locations);\r\n  const playTrack = useStore((state) => state.playTrack);\r\n  const stopTrack = useStore((state) => state.stopTrack);\r\n  const getSublocationsByParentId = useStore((state) => state.getSublocationsByParentId);\r\n  const getAllTopLevelLocations = useStore((state) => state.getAllTopLevelLocations);\r\n  const refreshAssets = useStore((state) => state.refreshAssets);\r\n  const hasAssets = useStore((state) => state.hasAssets);\r\n  const isLoading = useStore((state) => state.isLoading);\r\n  const characters = useStore((state) => state.characters);\r\n  const combats = useStore((state) => state.combats);\r\n  const saveDataToIndexedDB = useStore((state) => state.saveDataToIndexedDB);\r\n  \r\n  // Get only the selected location ID from the store\r\n  const selectedLocationId = useStore((state) => state.selectedLocationId);\r\n  const setSelectedLocationId = useStore((state) => state.setSelectedLocationId);\r\n  \r\n  // State for location and details\r\n  const [selectedLocation, setSelectedLocation] = useState<CustomLocation | null>(null);\r\n  const [showDetails, setShowDetails] = useState(false);\r\n  // Asset manager panel is shown by default if no assets are available\r\n  const [showAssetManager, setShowAssetManager] = useState(false);\r\n  \r\n  // Edit mode state\r\n  const [editMode, setEditMode] = useState(false);\r\n  const [isDragging, setIsDragging] = useState(false);\r\n  const [editingLocation, setEditingLocation] = useState<CustomLocation | null>(null);\r\n  const [showEditDialog, setShowEditDialog] = useState(false);\r\n  const imageRef = useRef<HTMLImageElement>(null);\r\n  const mapContainerRef = useRef<HTMLDivElement>(null);\r\n  \r\n  // Additional state for image loading\r\n  const [isImageLoading, setIsImageLoading] = useState(false);\r\n  \r\n  // State for audio assets\r\n  const [audioAssets, setAudioAssets] = useState<string[]>([]);\r\n  \r\n  // State for image assets\r\n  const [imageAssets, setImageAssets] = useState<string[]>([]);\r\n  \r\n  // Additional checks for the empty state\r\n  const hasLocations = locations.length > 0;\r\n  \r\n  // Background image handling with state\r\n  const [imageUrl, setImageUrl] = useState<string>('');\r\n  \r\n  // State for expanded NPC sections\r\n  const [expandedNpcSections, setExpandedNpcSections] = useState<{[key: string]: boolean}>({});\r\n  \r\n  // State for selected NPC and its details panel\r\n  const [selectedNpc, setSelectedNpc] = useState<Character | null>(null);\r\n  const [showNpcDetails, setShowNpcDetails] = useState(false);\r\n  \r\n  // State for selected Combat and its details panel\r\n  const [selectedCombat, setSelectedCombat] = useState<Combat | null>(null);\r\n  const [showCombatDetails, setShowCombatDetails] = useState(false);\r\n  \r\n  // Additional state for the UI\r\n  const [detailsTab, setDetailsTab] = useState(0);\r\n  \r\n  // Additional state for description dialog\r\n  const [showDescriptionDialog, setShowDescriptionDialog] = useState(false);\r\n  \r\n  // Effect to initialize the selected location from the saved state\r\n  useEffect(() => {\r\n    if (locations.length > 0) {\r\n      if (selectedLocationId) {\r\n        // If we have a saved location ID, try to load that location\r\n        const savedLocation = locations.find(loc => loc.id === selectedLocationId);\r\n        if (savedLocation) {\r\n          setSelectedLocation(savedLocation);\r\n          setShowDetails(true);\r\n        } else {\r\n          // If saved location doesn't exist anymore, load the first location\r\n          const topLocations = getAllTopLevelLocations();\r\n          if (topLocations.length > 0) {\r\n            setSelectedLocation(topLocations[0]);\r\n            setSelectedLocationId(topLocations[0].id);\r\n          }\r\n        }\r\n      } else {\r\n        // No saved location, load the first one\r\n        const topLocations = getAllTopLevelLocations();\r\n        if (topLocations.length > 0) {\r\n          setSelectedLocation(topLocations[0]);\r\n          setSelectedLocationId(topLocations[0].id);\r\n        }\r\n      }\r\n    }\r\n  }, [locations, selectedLocationId]);\r\n  \r\n  // Effect to load the image when the selected location changes\r\n  useEffect(() => {\r\n    if (selectedLocation) {\r\n      const loadImage = async () => {\r\n        setIsImageLoading(true);\r\n        try {\r\n          // Use the location's imageUrl property if available\r\n          if (selectedLocation.imageUrl) {\r\n            const url = await AssetManager.getAssetUrl('images', selectedLocation.imageUrl);\r\n            setImageUrl(url);\r\n          } else {\r\n            // Clear the image URL if no image is selected\r\n            setImageUrl('');\r\n          }\r\n        } catch (error) {\r\n          console.error('Error loading image:', error);\r\n          setImageUrl('');\r\n        } finally {\r\n          setIsImageLoading(false);\r\n        }\r\n      };\r\n      loadImage();\r\n      \r\n      // Save the selected location ID in the store\r\n      setSelectedLocationId(selectedLocation.id);\r\n    }\r\n  }, [selectedLocation?.id, selectedLocation?.imageUrl]);\r\n  \r\n  // Load available audio assets when the edit dialog opens\r\n  useEffect(() => {\r\n    if (showEditDialog) {\r\n      const loadAudioAssets = async () => {\r\n        try {\r\n          const assets = await AssetManager.getAssets('audio');\r\n          setAudioAssets(assets.map(asset => asset.name));\r\n        } catch (error) {\r\n          console.error('Failed to load audio assets:', error);\r\n          setAudioAssets([]);\r\n        }\r\n      };\r\n      \r\n      const loadImageAssets = async () => {\r\n        try {\r\n          const assets = await AssetManager.getAssets('images');\r\n          setImageAssets(assets.map(asset => asset.name));\r\n        } catch (error) {\r\n          console.error('Failed to load image assets:', error);\r\n          setImageAssets([]);\r\n        }\r\n      };\r\n      \r\n      loadAudioAssets();\r\n      loadImageAssets();\r\n    }\r\n  }, [showEditDialog]);\r\n  \r\n  // Handle location selection\r\n  const handleLocationClick = async (location: CustomLocation, e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    \r\n    // If in edit mode, show edit dialog instead of regular selection\r\n    if (editMode) {\r\n      setEditingLocation(location);\r\n      setShowEditDialog(true);\r\n      return;\r\n    }\r\n    \r\n    if (selectedLocation?.id !== location.id) {\r\n      setSelectedLocation(location);\r\n      setShowDetails(true);\r\n      \r\n      // Play entry sound if available\r\n      if (location.entrySound) {\r\n        const soundUrl = await AssetManager.getAssetUrl('audio', location.entrySound);\r\n        \r\n        // Only try to play the sound if a URL was returned\r\n        if (soundUrl) {\r\n          const locationSound = new Howl({\r\n            src: [soundUrl],\r\n            loop: false,\r\n            volume: useStore.getState().volume,\r\n          });\r\n          locationSound.play();\r\n        }\r\n      }\r\n      \r\n      if (location.backgroundMusic) {\r\n        // Use AssetManager to check if the audio exists before trying to play it\r\n        const audioPath = `/audio/${location.backgroundMusic}`;\r\n        const isSublocation = !!location.parentLocationId;\r\n        // Only pass replace: false if this is a sublocation with mixWithParent: true\r\n        const replace = !(isSublocation && location.mixWithParent === true);\r\n        playTrack(audioPath, { \r\n          replace: replace, \r\n          locationId: location.id \r\n        });\r\n      }\r\n    } else {\r\n      setShowDetails(!showDetails);\r\n    }\r\n  };\r\n\r\n  // Handle asset import\r\n  const handleAssetImport = async () => {\r\n    // Refresh the data in the store\r\n    await refreshAssets();\r\n    \r\n    // Reset the selected location to force a re-render\r\n    if (selectedLocation) {\r\n      const locationId = selectedLocation.id;\r\n      setSelectedLocation(null);\r\n      \r\n      // Find the location in the refreshed data\r\n      setTimeout(() => {\r\n        const refreshedLocation = locations.find(loc => loc.id === locationId);\r\n        if (refreshedLocation) {\r\n          setSelectedLocation(refreshedLocation);\r\n        }\r\n      }, 100);\r\n    }\r\n  };\r\n  \r\n  // Handle map click to add a new location in edit mode\r\n  const handleMapClick = (e: React.MouseEvent) => {\r\n    if (!editMode || !selectedLocation || !imageRef.current || !mapContainerRef.current) return;\r\n    \r\n    // Get mouse coordinates relative to the image\r\n    const rect = mapContainerRef.current.getBoundingClientRect();\r\n    const x = (e.clientX - rect.left) / rect.width;\r\n    const y = (e.clientY - rect.top) / rect.height;\r\n    \r\n    // Create a new location with default values\r\n    const newLocationData: Omit<CustomLocation, 'id'> = {\r\n      name: 'New Location',\r\n      description: 'Add a description',\r\n      coordinates: [x, y],\r\n      parentLocationId: selectedLocation.id,\r\n    };\r\n    \r\n    // Add the new location to the store\r\n    const addLocation = useStore.getState().addLocation;\r\n    addLocation(newLocationData);\r\n    \r\n    // Save to IndexedDB\r\n    useStore.getState().saveDataToIndexedDB();\r\n  };\r\n  \r\n  // Handle location drag events\r\n  const handleDragStart = (locationId: string, e: React.DragEvent) => {\r\n    if (!editMode) return;\r\n    \r\n    // Set a transparent drag image (prevents the default element preview)\r\n    const img = new Image();\r\n    img.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\r\n    e.dataTransfer.setDragImage(img, 0, 0);\r\n    \r\n    e.dataTransfer.setData('locationId', locationId);\r\n    setIsDragging(true);\r\n  };\r\n  \r\n  const handleDragOver = (e: React.DragEvent) => {\r\n    if (!editMode) return;\r\n    e.preventDefault();\r\n  };\r\n  \r\n  const handleDrop = (e: React.DragEvent) => {\r\n    if (!editMode || !imageRef.current || !mapContainerRef.current) return;\r\n    e.preventDefault();\r\n    \r\n    const locationId = e.dataTransfer.getData('locationId');\r\n    if (!locationId) return;\r\n    \r\n    // Get the location to update\r\n    const locations = useStore.getState().locations;\r\n    const locationToUpdate = locations.find(loc => loc.id === locationId);\r\n    if (!locationToUpdate) return;\r\n    \r\n    // Calculate new coordinates\r\n    const rect = mapContainerRef.current.getBoundingClientRect();\r\n    const x = (e.clientX - rect.left) / rect.width;\r\n    const y = (e.clientY - rect.top) / rect.height;\r\n    \r\n    // Update location coordinates\r\n    const updateLocationFn = useStore.getState().updateLocation;\r\n    updateLocationFn(locationId, { coordinates: [x, y] });\r\n    \r\n    // Save to IndexedDB\r\n    useStore.getState().saveDataToIndexedDB();\r\n    \r\n    setIsDragging(false);\r\n  };\r\n  \r\n  // Toggle edit mode\r\n  const toggleEditMode = () => {\r\n    setEditMode(!editMode);\r\n    \r\n    // Close edit dialog if open\r\n    if (showEditDialog) {\r\n      setShowEditDialog(false);\r\n      setEditingLocation(null);\r\n    }\r\n  };\r\n  \r\n  // Function to save data\r\n  const handleSaveData = async () => {\r\n    const result = await saveDataToIndexedDB();\r\n    alert(result.message);\r\n  };\r\n  \r\n  // Render location markers on the map\r\n  const renderLocationMarkers = () => {\r\n    if (!selectedLocation) return null;\r\n\r\n    const sublocations = getSublocationsByParentId(selectedLocation.id);\r\n\r\n    return sublocations.map((sublocation) => {\r\n      if (!sublocation.coordinates) return null;\r\n\r\n      const [relX, relY] = sublocation.coordinates;\r\n      const isSelected = selectedLocation?.id === sublocation.id;\r\n\r\n      return (\r\n        <Tooltip \r\n          key={sublocation.id} \r\n          title={editMode ? \"Drag to move, click to edit\" : sublocation.name}\r\n          arrow\r\n          placement=\"top\"\r\n        >\r\n          <Box\r\n            sx={{\r\n              position: 'absolute',\r\n              left: `${relX * 100}%`,\r\n              top: `${relY * 100}%`,\r\n              transform: 'translate(-50%, -50%)',\r\n              zIndex: 5,\r\n              cursor: editMode ? 'move' : 'pointer',\r\n              transition: 'all 0.2s ease-in-out',\r\n              '&:hover': {\r\n                transform: 'translate(-50%, -50%) scale(1.2)',\r\n              }\r\n            }}\r\n            onClick={(e) => handleLocationClick(sublocation, e)}\r\n            draggable={editMode}\r\n            onDragStart={(e) => handleDragStart(sublocation.id, e)}\r\n          >\r\n            <PlaceIcon \r\n              color={isSelected ? \"primary\" : editMode ? \"secondary\" : \"error\"} \r\n              sx={{ \r\n                fontSize: isSelected ? '2.5rem' : '2rem',\r\n                filter: 'drop-shadow(0px 0px 4px rgba(0, 0, 0, 0.9))'\r\n              }} \r\n            />\r\n            <Typography\r\n              variant=\"caption\"\r\n              sx={{\r\n                position: 'absolute',\r\n                top: '100%',\r\n                left: '50%',\r\n                transform: 'translateX(-50%)',\r\n                whiteSpace: 'nowrap',\r\n                backgroundColor: 'rgba(0, 0, 0, 0.7)',\r\n                color: 'white',\r\n                padding: '2px 6px',\r\n                borderRadius: '4px',\r\n                fontSize: '0.7rem',\r\n                fontWeight: 'bold',\r\n                textAlign: 'center',\r\n                maxWidth: '120px',\r\n                overflow: 'hidden',\r\n                textOverflow: 'ellipsis',\r\n                filter: 'drop-shadow(0px 0px 2px rgba(0, 0, 0, 0.5))'\r\n              }}\r\n            >\r\n              {sublocation.name}\r\n            </Typography>\r\n          </Box>\r\n        </Tooltip>\r\n      );\r\n    });\r\n  };\r\n  \r\n  // Recursive function to render location hierarchy\r\n  const renderLocationItem = (location: CustomLocation, depth = 0) => {\r\n    const sublocations = getSublocationsByParentId(location.id);\r\n    const hasSublocations = sublocations.length > 0;\r\n    \r\n    return (\r\n      <React.Fragment key={location.id}>\r\n        <ListItem \r\n          disablePadding \r\n          sx={{ pl: depth * 2 }}\r\n        >\r\n          <ListItemButton \r\n            selected={selectedLocation?.id === location.id}\r\n            onClick={(e) => handleLocationClick(location, e)}\r\n          >\r\n            <ListItemIcon sx={{ minWidth: 36 }}>\r\n              <PlaceIcon />\r\n            </ListItemIcon>\r\n            <ListItemText primary={location.name} />\r\n            {hasSublocations && (\r\n              <IconButton \r\n                size=\"small\" \r\n              >\r\n              </IconButton>\r\n            )}\r\n          </ListItemButton>\r\n        </ListItem>\r\n        \r\n        {hasSublocations && (\r\n          <Collapse in={selectedLocation?.id === location.id} timeout=\"auto\" unmountOnExit>\r\n            <List disablePadding>\r\n              {sublocations.map((subloc) => renderLocationItem(subloc, depth + 1))}\r\n            </List>\r\n          </Collapse>\r\n        )}\r\n      </React.Fragment>\r\n    );\r\n  };\r\n  \r\n  // Add new helper function inside the component\r\n  const calculateEdgeIntersection = (\r\n    currentX: number,\r\n    currentY: number,\r\n    dx: number,\r\n    dy: number\r\n  ) => {\r\n    let tMin = Infinity;\r\n    let edgeX = currentX + dx;\r\n    let edgeY = currentY + dy;\r\n\r\n    // Check horizontal boundaries\r\n    if (dx !== 0) {\r\n      // x=0 boundary\r\n      const tX0 = (0 - currentX) / dx;\r\n      if (tX0 > 0) {\r\n        const y = currentY + tX0 * dy;\r\n        if (y >= 0 && y <= 1 && tX0 < tMin) {\r\n          tMin = tX0;\r\n          edgeX = 0;\r\n          edgeY = y;\r\n        }\r\n      }\r\n\r\n      // x=1 boundary\r\n      const tX1 = (1 - currentX) / dx;\r\n      if (tX1 > 0) {\r\n        const y = currentY + tX1 * dy;\r\n        if (y >= 0 && y <= 1 && tX1 < tMin) {\r\n          tMin = tX1;\r\n          edgeX = 1;\r\n          edgeY = y;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Check vertical boundaries\r\n    if (dy !== 0) {\r\n      // y=0 boundary\r\n      const tY0 = (0 - currentY) / dy;\r\n      if (tY0 > 0) {\r\n        const x = currentX + tY0 * dx;\r\n        if (x >= 0 && x <= 1 && tY0 < tMin) {\r\n          tMin = tY0;\r\n          edgeX = x;\r\n          edgeY = 0;\r\n        }\r\n      }\r\n\r\n      // y=1 boundary\r\n      const tY1 = (1 - currentY) / dy;\r\n      if (tY1 > 0) {\r\n        const x = currentX + tY1 * dx;\r\n        if (x >= 0 && x <= 1 && tY1 < tMin) {\r\n          tMin = tY1;\r\n          edgeX = x;\r\n          edgeY = 1;\r\n        }\r\n      }\r\n    }\r\n\r\n    return { x: edgeX, y: edgeY };\r\n  };\r\n\r\n  // Add these helper functions at the top of the component\r\n  const normalizeCoordinate = (coord: number, max: number) => {\r\n    return Math.min(Math.max(coord / max, 0), 1);\r\n  };\r\n\r\n  // Update the getDirectionalArrows function\r\n  const getDirectionalArrows = () => {\r\n    if (!selectedLocation) return null;\r\n\r\n    const worldWidth = useStore.getState().mapConfig.worldWidth;\r\n    const worldHeight = useStore.getState().mapConfig.worldHeight;\r\n    const circleRadius = 0.3; // Increased from 0.1 to 30% of container size\r\n\r\n    return locations\r\n      .filter(loc => \r\n        selectedLocation.connectedLocations?.includes(loc.id) &&\r\n        loc.id !== selectedLocation.id\r\n      )\r\n      .map(connectedLoc => {\r\n        if (!selectedLocation.coordinates || !connectedLoc.coordinates) return null;\r\n\r\n        // Get original coordinates\r\n        const [currentX, currentY] = selectedLocation.coordinates;\r\n        const [targetX, targetY] = connectedLoc.coordinates;\r\n\r\n        // Calculate direction vector\r\n        const dx = targetX - currentX;\r\n        const dy = targetY - currentY;\r\n        \r\n        // Calculate angle for rotation\r\n        const angleRad = Math.atan2(dy, dx);\r\n        const angleDeg = angleRad * (180 / Math.PI) + 90;\r\n\r\n        // Calculate normalized position on circle\r\n        const distance = Math.sqrt(dx*dx + dy*dy);\r\n        const normalizedDx = dx / distance;\r\n        const normalizedDy = dy / distance;\r\n\r\n        // Get normalized coordinates for MAP CENTER (0.5, 0.5)\r\n        const mapCenterX = 0.5;\r\n        const mapCenterY = 0.5;\r\n\r\n        // Position on circle edge relative to map center\r\n        const arrowX = mapCenterX + normalizedDx * circleRadius;\r\n        const arrowY = mapCenterY + normalizedDy * circleRadius;\r\n\r\n        return (\r\n          <Tooltip \r\n            key={`tooltip-${connectedLoc.id}`}\r\n            title={`${connectedLoc.name} (${distance.toFixed(1)} meters)`}\r\n            placement=\"top\"\r\n            arrow\r\n          >\r\n            <IconButton\r\n              onClick={(e) => {\r\n                e.stopPropagation();\r\n                handleLocationClick(connectedLoc, e);\r\n              }}\r\n              sx={{\r\n                position: 'absolute',\r\n                zIndex: 10,\r\n                color: 'white',\r\n                backgroundColor: 'rgba(0,0,0,0.5)',\r\n                '&:hover': {\r\n                  backgroundColor: 'rgba(0,0,0,0.8)'\r\n                },\r\n                left: `${arrowX * 100}%`,\r\n                top: `${arrowY * 100}%`,\r\n                transform: 'translate(-50%, -50%)'\r\n              }}\r\n            >\r\n              <NorthIcon \r\n                fontSize=\"large\" \r\n                sx={{ transform: `rotate(${angleDeg}deg)` }} \r\n              />\r\n            </IconButton>\r\n          </Tooltip>\r\n        );\r\n      });\r\n  };\r\n  \r\n  // Toggle expanded state for NPC sections\r\n  const toggleNpcSection = (sectionId: string) => {\r\n    setExpandedNpcSections(prev => ({\r\n      ...prev,\r\n      [sectionId]: !prev[sectionId]\r\n    }));\r\n  };\r\n  \r\n  // Get characters for a specific location\r\n  const getCharactersByLocationId = (locationId: string) => {\r\n    return characters.filter(char => char.locationId === locationId);\r\n  };\r\n  \r\n  // Get all characters in a location and its sublocations\r\n  const getAllCharactersInLocationHierarchy = (locationId: string) => {\r\n    const directCharacters = getCharactersByLocationId(locationId);\r\n    const sublocations = getSublocationsByParentId(locationId);\r\n    \r\n    let allCharacters = [...directCharacters];\r\n    \r\n    // Recursively get characters from sublocations\r\n    sublocations.forEach(sublocation => {\r\n      const sublocationCharacters = getAllCharactersInLocationHierarchy(sublocation.id);\r\n      allCharacters = [...allCharacters, ...sublocationCharacters];\r\n    });\r\n    \r\n    return allCharacters;\r\n  };\r\n  \r\n  // Handle clicking on an NPC to show its details\r\n  const handleNpcClick = (npc: Character, e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    setSelectedNpc(npc);\r\n    setShowNpcDetails(true);\r\n  };\r\n  \r\n  // Modify the renderNpcsPanel function to include click handlers\r\n  const renderNpcsPanel = () => {\r\n    if (!selectedLocation) return null;\r\n    \r\n    const directNpcs = getCharactersByLocationId(selectedLocation.id);\r\n    const allNpcs = getAllCharactersInLocationHierarchy(selectedLocation.id);\r\n    const hasSublocationsWithNpcs = allNpcs.length > directNpcs.length;\r\n    \r\n    if (allNpcs.length === 0) {\r\n      return (\r\n        <Box sx={{ p: 2 }}>\r\n          <Typography variant=\"body2\" color=\"text.secondary\">\r\n            No NPCs in this location\r\n          </Typography>\r\n        </Box>\r\n      );\r\n    }\r\n    \r\n    return (\r\n      <Box>\r\n        <List dense>\r\n          {directNpcs.length > 0 && (\r\n            <>\r\n              <ListItem>\r\n                <ListItemText \r\n                  primary={`NPCs in ${selectedLocation.name}`} \r\n                  primaryTypographyProps={{ variant: 'subtitle1', fontWeight: 'bold' }}\r\n                />\r\n              </ListItem>\r\n              {directNpcs.map(npc => (\r\n                <ListItem \r\n                  key={npc.id} \r\n                  button \r\n                  onClick={(e) => handleNpcClick(npc, e)}\r\n                  sx={{ cursor: 'pointer' }}\r\n                >\r\n                  <ListItemIcon>\r\n                    {npc.type === 'npc' ? <PersonIcon fontSize=\"small\" /> : \r\n                     npc.type === 'merchant' ? <MerchantIcon fontSize=\"small\" /> :\r\n                     <SportsKabaddiIcon color=\"error\" fontSize=\"small\" />}\r\n                  </ListItemIcon>\r\n                  <ListItemText primary={npc.name} secondary={npc.description} />\r\n                </ListItem>\r\n              ))}\r\n              {hasSublocationsWithNpcs && <Divider sx={{ my: 1 }} />}\r\n            </>\r\n          )}\r\n          \r\n          {hasSublocationsWithNpcs && renderSublocationsNpcs(selectedLocation.id)}\r\n        </List>\r\n      </Box>\r\n    );\r\n  };\r\n  \r\n  // Modify the renderSublocationsNpcs function to include click handlers\r\n  const renderSublocationsNpcs = (locationId: string) => {\r\n    const sublocations = getSublocationsByParentId(locationId);\r\n    \r\n    return (\r\n      <>\r\n        {sublocations.map(sublocation => {\r\n          const npcs = getCharactersByLocationId(sublocation.id);\r\n          \r\n          if (npcs.length === 0) {\r\n            return null;\r\n          }\r\n          \r\n          const sectionId = `npc-section-${sublocation.id}`;\r\n          const isExpanded = expandedNpcSections[sectionId] || false;\r\n          \r\n          return (\r\n            <Box key={sublocation.id}>\r\n              <ListItem \r\n                button \r\n                onClick={() => toggleNpcSection(sectionId)}\r\n                sx={{ pl: 2 }}\r\n              >\r\n                <ListItemText \r\n                  primary={sublocation.name} \r\n                  primaryTypographyProps={{ variant: 'subtitle2' }}\r\n                />\r\n                {isExpanded ? <ExpandLessIcon /> : <ExpandMoreIcon />}\r\n              </ListItem>\r\n              \r\n              <Collapse in={isExpanded} timeout=\"auto\" unmountOnExit>\r\n                <List component=\"div\" disablePadding>\r\n                  {npcs.map(npc => (\r\n                    <ListItem \r\n                      key={npc.id}\r\n                      button\r\n                      onClick={(e) => handleNpcClick(npc, e)}\r\n                      sx={{ pl: 4, cursor: 'pointer' }}\r\n                    >\r\n                      <ListItemIcon>\r\n                        {npc.type === 'npc' ? <PersonIcon fontSize=\"small\" /> : \r\n                         npc.type === 'merchant' ? <MerchantIcon fontSize=\"small\" /> :\r\n                         <SportsKabaddiIcon color=\"error\" fontSize=\"small\" />}\r\n                      </ListItemIcon>\r\n                      <ListItemText primary={npc.name} />\r\n                    </ListItem>\r\n                  ))}\r\n                </List>\r\n              </Collapse>\r\n              \r\n              {renderSublocationsNpcs(sublocation.id)}\r\n            </Box>\r\n          );\r\n        })}\r\n      </>\r\n    );\r\n  };\r\n\r\n  // Create a function to render the NPC details panel\r\n  const renderNpcDetailsPanel = () => {\r\n    if (!selectedNpc) return null;\r\n    \r\n    const locationName = locations.find(loc => loc.id === selectedNpc.locationId)?.name || 'Unknown';\r\n    const updateCharacter = useStore.getState().updateCharacter;\r\n    \r\n    // Function to add new item in edit mode\r\n    const handleAddItem = () => {\r\n      if (!selectedNpc || !editMode) return;\r\n      \r\n      const newItem: Item = {\r\n        id: crypto.randomUUID(),\r\n        name: 'New Item',\r\n        description: 'Item description',\r\n        quantity: 1\r\n      };\r\n      \r\n      const updatedInventory = [...(selectedNpc.inventory || []), newItem];\r\n      updateCharacter(selectedNpc.id, { inventory: updatedInventory });\r\n      setSelectedNpc({...selectedNpc, inventory: updatedInventory});\r\n    };\r\n    \r\n    // Function to update item in edit mode\r\n    const handleUpdateItem = (itemId: string, itemData: Partial<Item>) => {\r\n      if (!selectedNpc || !editMode) return;\r\n      \r\n      const updatedInventory = (selectedNpc.inventory || []).map(item => \r\n        item.id === itemId ? {...item, ...itemData} : item\r\n      );\r\n      \r\n      updateCharacter(selectedNpc.id, { inventory: updatedInventory });\r\n      setSelectedNpc({...selectedNpc, inventory: updatedInventory});\r\n    };\r\n    \r\n    // Function to delete item in edit mode\r\n    const handleDeleteItem = (itemId: string) => {\r\n      if (!selectedNpc || !editMode) return;\r\n      \r\n      const updatedInventory = (selectedNpc.inventory || []).filter(item => item.id !== itemId);\r\n      updateCharacter(selectedNpc.id, { inventory: updatedInventory });\r\n      setSelectedNpc({...selectedNpc, inventory: updatedInventory});\r\n    };\r\n    \r\n    return (\r\n      <Box sx={{ p: 2, minWidth: 300, maxWidth: 400 }}>\r\n        <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\r\n          <Typography variant=\"h6\">{selectedNpc.name}</Typography>\r\n          <IconButton onClick={() => setShowNpcDetails(false)} size=\"small\">\r\n            <CloseIcon />\r\n          </IconButton>\r\n        </Box>\r\n        \r\n        <Typography variant=\"subtitle1\" color=\"text.secondary\">{selectedNpc.type === 'npc' ? 'NPC' : \r\n         selectedNpc.type === 'merchant' ? 'Merchant' : 'Enemy'}</Typography>\r\n        <Typography variant=\"body2\" paragraph>{selectedNpc.description}</Typography>\r\n        \r\n        <Box sx={{ mb: 2 }}>\r\n          <Typography variant=\"subtitle2\">Location:</Typography>\r\n          <Typography variant=\"body2\">{locationName}</Typography>\r\n        </Box>\r\n        \r\n        <Divider sx={{ my: 2 }} />\r\n        \r\n        <Box sx={{ mb: 1, display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n          <Typography variant=\"h6\">Inventory</Typography>\r\n          {editMode && (\r\n            <IconButton size=\"small\" onClick={handleAddItem} color=\"primary\">\r\n              <AddIcon />\r\n            </IconButton>\r\n          )}\r\n        </Box>\r\n        \r\n        {(!selectedNpc.inventory || selectedNpc.inventory.length === 0) ? (\r\n          <Typography variant=\"body2\" color=\"text.secondary\">No items in inventory</Typography>\r\n        ) : (\r\n          <List dense>\r\n            {selectedNpc.inventory.map((item: Item) => (\r\n              <ListItem \r\n                key={item.id}\r\n                secondaryAction={editMode ? (\r\n                  <IconButton edge=\"end\" size=\"small\" onClick={() => handleDeleteItem(item.id)}>\r\n                    <DeleteIcon fontSize=\"small\" />\r\n                  </IconButton>\r\n                ) : null}\r\n              >\r\n                <ListItemText \r\n                  primary={\r\n                    editMode ? (\r\n                      <TextField\r\n                        size=\"small\"\r\n                        value={item.name}\r\n                        onChange={(e) => handleUpdateItem(item.id, { name: e.target.value })}\r\n                        fullWidth\r\n                        variant=\"standard\"\r\n                        margin=\"dense\"\r\n                      />\r\n                    ) : item.name\r\n                  }\r\n                  secondary={\r\n                    <>\r\n                      {editMode ? (\r\n                        <TextField\r\n                          size=\"small\"\r\n                          value={item.description}\r\n                          onChange={(e) => handleUpdateItem(item.id, { description: e.target.value })}\r\n                          fullWidth\r\n                          variant=\"standard\"\r\n                          margin=\"dense\"\r\n                          multiline\r\n                        />\r\n                      ) : item.description}\r\n                      <Box sx={{ display: 'flex', justifyContent: 'space-between', mt: 1 }}>\r\n                        <Box>\r\n                          Qty: {editMode ? (\r\n                            <TextField\r\n                              size=\"small\"\r\n                              type=\"number\"\r\n                              value={item.quantity}\r\n                              onChange={(e) => handleUpdateItem(item.id, { quantity: parseInt(e.target.value) || 0 })}\r\n                              variant=\"standard\"\r\n                              sx={{ width: 50 }}\r\n                            />\r\n                          ) : item.quantity}\r\n                        </Box>\r\n                        {item.price !== undefined && (\r\n                          <Box>\r\n                            Price: {editMode ? (\r\n                              <TextField\r\n                                size=\"small\"\r\n                                type=\"number\"\r\n                                value={item.price}\r\n                                onChange={(e) => handleUpdateItem(item.id, { price: parseInt(e.target.value) || 0 })}\r\n                                variant=\"standard\"\r\n                                sx={{ width: 60 }}\r\n                              />\r\n                            ) : item.price}\r\n                          </Box>\r\n                        )}\r\n                        {editMode && item.price === undefined && (\r\n                          <Button \r\n                            size=\"small\" \r\n                            onClick={() => handleUpdateItem(item.id, { price: 0 })}\r\n                          >\r\n                            Add Price\r\n                          </Button>\r\n                        )}\r\n                      </Box>\r\n                    </>\r\n                  }\r\n                />\r\n              </ListItem>\r\n            ))}\r\n          </List>\r\n        )}\r\n      </Box>\r\n    );\r\n  };\r\n  \r\n  // Get combats for a specific location and its sublocations\r\n  const getCombatsByLocationHierarchy = (locationId: string) => {\r\n    const directCombats = combats.filter(combat => combat.locationId === locationId);\r\n    const sublocations = getSublocationsByParentId(locationId);\r\n    \r\n    let allCombats = [...directCombats];\r\n    \r\n    // Recursively get combats from sublocations\r\n    sublocations.forEach(sublocation => {\r\n      const sublocationCombats = getCombatsByLocationHierarchy(sublocation.id);\r\n      allCombats = [...allCombats, ...sublocationCombats];\r\n    });\r\n    \r\n    return allCombats;\r\n  };\r\n  \r\n  // Handle clicking on a combat to show its details\r\n  const handleCombatClick = (combat: Combat, e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    setSelectedCombat(combat);\r\n    setShowCombatDetails(true);\r\n  };\r\n  \r\n  // Render the combats panel showing combats in the current location\r\n  const renderCombatsPanel = () => {\r\n    if (!selectedLocation) return null;\r\n    \r\n    const directCombats = combats.filter(combat => combat.locationId === selectedLocation.id);\r\n    const allCombats = getCombatsByLocationHierarchy(selectedLocation.id);\r\n    const hasSublocationsWithCombats = allCombats.length > directCombats.length;\r\n    \r\n    if (allCombats.length === 0) {\r\n      return (\r\n        <Box sx={{ p: 2 }}>\r\n          <Typography variant=\"body2\" color=\"text.secondary\">\r\n            No combats in this location\r\n          </Typography>\r\n        </Box>\r\n      );\r\n    }\r\n    \r\n    return (\r\n      <Box>\r\n        <List dense>\r\n          {directCombats.length > 0 && (\r\n            <>\r\n              <ListItem>\r\n                <ListItemText \r\n                  primary={`Combats in ${selectedLocation.name}`} \r\n                  primaryTypographyProps={{ variant: 'subtitle1', fontWeight: 'bold' }}\r\n                />\r\n              </ListItem>\r\n              {directCombats.map(combat => (\r\n                <ListItem \r\n                  key={combat.id} \r\n                  button \r\n                  onClick={(e) => handleCombatClick(combat, e)}\r\n                  sx={{ cursor: 'pointer' }}\r\n                >\r\n                  <ListItemIcon>\r\n                    <SportsKabaddiIcon color=\"primary\" fontSize=\"small\" />\r\n                  </ListItemIcon>\r\n                  <ListItemText \r\n                    primary={combat.name} \r\n                    secondary={`Difficulty: ${combat.difficulty || 'Medium'}`} \r\n                  />\r\n                </ListItem>\r\n              ))}\r\n              {hasSublocationsWithCombats && <Divider sx={{ my: 1 }} />}\r\n            </>\r\n          )}\r\n          \r\n          {hasSublocationsWithCombats && renderSubLocationsCombats(selectedLocation.id)}\r\n        </List>\r\n      </Box>\r\n    );\r\n  };\r\n  \r\n  // Render combats in sublocations\r\n  const renderSubLocationsCombats = (locationId: string) => {\r\n    const sublocations = getSublocationsByParentId(locationId);\r\n    \r\n    return (\r\n      <>\r\n        {sublocations.map(sublocation => {\r\n          const locationCombats = combats.filter(combat => combat.locationId === sublocation.id);\r\n          \r\n          if (locationCombats.length === 0) {\r\n            return null;\r\n          }\r\n          \r\n          const sectionId = `combat-section-${sublocation.id}`;\r\n          const isExpanded = expandedNpcSections[sectionId] || false;\r\n          \r\n          return (\r\n            <Box key={sublocation.id}>\r\n              <ListItem \r\n                button \r\n                onClick={() => toggleNpcSection(sectionId)}\r\n                sx={{ pl: 2 }}\r\n              >\r\n                <ListItemText \r\n                  primary={sublocation.name} \r\n                  primaryTypographyProps={{ variant: 'subtitle2' }}\r\n                />\r\n                {isExpanded ? <ExpandLessIcon /> : <ExpandMoreIcon />}\r\n              </ListItem>\r\n              \r\n              <Collapse in={isExpanded} timeout=\"auto\" unmountOnExit>\r\n                <List component=\"div\" disablePadding>\r\n                  {locationCombats.map(combat => (\r\n                    <ListItem \r\n                      key={combat.id}\r\n                      button\r\n                      onClick={(e) => handleCombatClick(combat, e)}\r\n                      sx={{ pl: 4, cursor: 'pointer' }}\r\n                    >\r\n                      <ListItemIcon>\r\n                        <SportsKabaddiIcon color=\"primary\" fontSize=\"small\" />\r\n                      </ListItemIcon>\r\n                      <ListItemText \r\n                        primary={combat.name}\r\n                        secondary={`Difficulty: ${combat.difficulty || 'Medium'}`} \r\n                      />\r\n                    </ListItem>\r\n                  ))}\r\n                </List>\r\n              </Collapse>\r\n              \r\n              {renderSubLocationsCombats(sublocation.id)}\r\n            </Box>\r\n          );\r\n        })}\r\n      </>\r\n    );\r\n  };\r\n  \r\n  // Render the combat details panel\r\n  const renderCombatDetailsPanel = () => {\r\n    if (!selectedCombat) return null;\r\n    \r\n    const locationName = locations.find(loc => loc.id === selectedCombat.locationId)?.name || 'Unknown';\r\n    \r\n    return (\r\n      <Box sx={{ p: 2, minWidth: 300, maxWidth: 400 }}>\r\n        <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\r\n          <Typography variant=\"h6\">{selectedCombat.name}</Typography>\r\n          <IconButton onClick={() => setShowCombatDetails(false)} size=\"small\">\r\n            <CloseIcon />\r\n          </IconButton>\r\n        </Box>\r\n        \r\n        <Typography variant=\"subtitle1\" color=\"text.secondary\">\r\n          Difficulty: {selectedCombat.difficulty || 'Medium'}\r\n        </Typography>\r\n        <Typography variant=\"body2\" paragraph>{selectedCombat.description}</Typography>\r\n        \r\n        <Box sx={{ mb: 2 }}>\r\n          <Typography variant=\"subtitle2\">Location:</Typography>\r\n          <Typography variant=\"body2\">{locationName}</Typography>\r\n        </Box>\r\n        \r\n        {/* Add Start Combat button at the top of the details */}\r\n        <Button \r\n          variant=\"contained\" \r\n          color=\"primary\" \r\n          fullWidth \r\n          startIcon={<SportsKabaddiIcon />}\r\n          onClick={() => {\r\n            setShowCombatDetails(false);\r\n            // Navigate to the combat session view with the selected combat ID\r\n            navigate('/combat-session', { state: { combatId: selectedCombat.id } });\r\n          }}\r\n          sx={{ mb: 3 }}\r\n        >\r\n          Start Combat\r\n        </Button>\r\n        \r\n        <Divider sx={{ my: 2 }} />\r\n        \r\n        <Typography variant=\"subtitle2\">Player Characters:</Typography>\r\n        {selectedCombat.playerCharacters.length === 0 ? (\r\n          <Typography variant=\"body2\" color=\"text.secondary\">No player characters assigned</Typography>\r\n        ) : (\r\n          <List dense>\r\n            {selectedCombat.playerCharacters.map(character => (\r\n              <ListItem key={character.id}>\r\n                <ListItemIcon>\r\n                  <PersonIcon fontSize=\"small\" />\r\n                </ListItemIcon>\r\n                <ListItemText primary={character.name} />\r\n              </ListItem>\r\n            ))}\r\n          </List>\r\n        )}\r\n        \r\n        <Divider sx={{ my: 2 }} />\r\n        \r\n        <Typography variant=\"subtitle2\">Enemies:</Typography>\r\n        {selectedCombat.enemies.length === 0 ? (\r\n          <Typography variant=\"body2\" color=\"text.secondary\">No enemies assigned</Typography>\r\n        ) : (\r\n          <List dense>\r\n            {/* Group enemies by name and count them */}\r\n            {Object.entries(\r\n              selectedCombat.enemies.reduce((acc, enemy) => {\r\n                acc[enemy.id] = acc[enemy.id] || { enemy, count: 0 };\r\n                acc[enemy.id].count++;\r\n                return acc;\r\n              }, {} as Record<string, { enemy: Character, count: number }>)\r\n            ).map(([id, { enemy, count }]) => (\r\n              <ListItem key={id}>\r\n                <ListItemIcon>\r\n                  <SportsKabaddiIcon color=\"error\" fontSize=\"small\" />\r\n                </ListItemIcon>\r\n                <ListItemText \r\n                  primary={`${enemy.name} ${count > 1 ? `(x${count})` : ''}`} \r\n                  secondary={`HP: ${enemy.hp}`}\r\n                />\r\n              </ListItem>\r\n            ))}\r\n          </List>\r\n        )}\r\n        \r\n        {selectedCombat.rewards && selectedCombat.rewards.length > 0 && (\r\n          <>\r\n            <Divider sx={{ my: 2 }} />\r\n            <Typography variant=\"subtitle2\">Rewards:</Typography>\r\n            <List dense>\r\n              {selectedCombat.rewards.map(item => (\r\n                <ListItem key={item.id}>\r\n                  <ListItemText \r\n                    primary={item.name} \r\n                    secondary={`Quantity: ${item.quantity}`}\r\n                  />\r\n                </ListItem>\r\n              ))}\r\n            </List>\r\n          </>\r\n        )}\r\n      </Box>\r\n    );\r\n  };\r\n  \r\n  // Loading state for the entire application\r\n  if (isLoading) {\r\n    return (\r\n      <Box \r\n        sx={{ \r\n          height: 'calc(100vh - 64px)', \r\n          display: 'flex', \r\n          flexDirection: 'column',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          backgroundColor: 'background.default'\r\n        }}\r\n      >\r\n        <CircularProgress size={60} />\r\n        <Typography variant=\"h6\" sx={{ mt: 2 }}>\r\n          Loading your campaign...\r\n        </Typography>\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  // Render the empty state when no assets or locations are available\r\n  if (!hasLocations) {\r\n    return (\r\n      <Box \r\n        sx={{ \r\n          height: 'calc(100vh - 64px)', \r\n          display: 'flex', \r\n          flexDirection: 'column',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          padding: 4,\r\n          backgroundColor: 'background.default'\r\n        }}\r\n      >\r\n        <Paper\r\n          elevation={3}\r\n          sx={{\r\n            maxWidth: 600,\r\n            width: '100%',\r\n            p: 4,\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            alignItems: 'center',\r\n            backgroundColor: 'rgba(45, 45, 45, 0.9)',\r\n          }}\r\n        >\r\n          <Typography variant=\"h4\" gutterBottom align=\"center\" sx={{ mb: 2 }}>\r\n            Welcome to Pen & Paper Project\r\n          </Typography>\r\n          \r\n          <Typography variant=\"body1\" paragraph align=\"center\">\r\n            No campaign assets found. Please upload a zip file containing your campaign assets to get started.\r\n          </Typography>\r\n          \r\n          <Typography variant=\"body2\" paragraph align=\"center\" color=\"text.secondary\" sx={{ mb: 3 }}>\r\n            Your zip file should contain an \"audio\" folder for sound files, an \"images\" folder for location images, \r\n            and a \"data\" folder with your \"locations.json\" and \"characters.json\" files.\r\n          </Typography>\r\n          \r\n          <AssetDropZone onAssetImport={handleAssetImport} isFullPage={true} />\r\n        </Paper>\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  // Render the main map view\r\n  return (\r\n    <Box sx={{ display: 'flex', height: '100%', overflow: 'hidden' }}>\r\n      {/* Sidebar */}\r\n      <Paper \r\n        elevation={3} \r\n        sx={{ \r\n          width: 280, \r\n          height: '100%', \r\n          display: 'flex', \r\n          flexDirection: 'column',\r\n          overflow: 'hidden',\r\n          zIndex: 1,\r\n        }}\r\n      >\r\n        <Tabs \r\n          value={showDetails ? 1 : 0} \r\n          onChange={(_, value) => setShowDetails(value === 1)}\r\n          variant=\"fullWidth\"\r\n        >\r\n          <Tab label=\"Locations\" />\r\n          <Tab label=\"Details\" disabled={!selectedLocation} />\r\n        </Tabs>\r\n        \r\n        {!showDetails ? (\r\n          <List \r\n            sx={{ \r\n              overflowY: 'auto', \r\n              flexGrow: 1,\r\n              '& .MuiListItemButton-root.Mui-selected': {\r\n                bgcolor: 'primary.light',\r\n                '&:hover': {\r\n                  bgcolor: 'primary.light',\r\n                }\r\n              }\r\n            }}\r\n          >\r\n            {getAllTopLevelLocations().map((location) => renderLocationItem(location))}\r\n          </List>\r\n        ) : (\r\n          <Box sx={{ flexGrow: 1, display: 'flex', flexDirection: 'column', overflow: 'hidden' }}>\r\n            <Box sx={{ p: 2, borderBottom: '1px solid rgba(0, 0, 0, 0.12)' }}>\r\n              <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>\r\n                <IconButton \r\n                  size=\"small\"\r\n                  onClick={() => setShowDetails(false)}\r\n                  sx={{ mr: 1 }}\r\n                >\r\n                  <ArrowBackIcon fontSize=\"small\" />\r\n                </IconButton>\r\n                <Typography variant=\"h6\" noWrap>{selectedLocation?.name}</Typography>\r\n                \r\n                {editMode && (\r\n                  <IconButton \r\n                    size=\"small\" \r\n                    color=\"primary\"\r\n                    onClick={() => {\r\n                      if (selectedLocation) {\r\n                        setEditingLocation(selectedLocation);\r\n                        setShowEditDialog(true);\r\n                      }\r\n                    }}\r\n                    sx={{ ml: 'auto' }}\r\n                  >\r\n                    <EditIcon fontSize=\"small\" />\r\n                  </IconButton>\r\n                )}\r\n              </Box>\r\n              \r\n              {selectedLocation?.description && (\r\n                <Box\r\n                  onClick={() => setShowDescriptionDialog(true)} \r\n                  sx={{ \r\n                    cursor: 'pointer',\r\n                    '&:hover': {\r\n                      backgroundColor: 'rgba(0, 0, 0, 0.04)'\r\n                    },\r\n                    borderRadius: 1,\r\n                    p: 1\r\n                  }}\r\n                >\r\n                  <Typography \r\n                    variant=\"body2\" \r\n                    color=\"text.secondary\"\r\n                    sx={{\r\n                      display: '-webkit-box',\r\n                      WebkitLineClamp: 4,\r\n                      WebkitBoxOrient: 'vertical',\r\n                      overflow: 'hidden',\r\n                      textOverflow: 'ellipsis'\r\n                    }}\r\n                  >\r\n                    {selectedLocation.description}\r\n                  </Typography>\r\n                  {selectedLocation.description.length > 200 && (\r\n                    <Typography \r\n                      variant=\"caption\" \r\n                      color=\"primary\" \r\n                      sx={{ display: 'block', mt: 0.5 }}\r\n                    >\r\n                      Click to view full description\r\n                    </Typography>\r\n                  )}\r\n                </Box>\r\n              )}\r\n            </Box>\r\n            \r\n            <Box sx={{ overflow: 'auto', flexGrow: 1 }}>\r\n              {/* Location details tabs */}\r\n              <Tabs \r\n                value={detailsTab} \r\n                onChange={(_, value) => setDetailsTab(value)}\r\n                variant=\"fullWidth\" \r\n                sx={{ borderBottom: 1, borderColor: 'divider' }}\r\n              >\r\n                <Tab label=\"Info\" />\r\n                <Tab label=\"NPCs\" />\r\n                <Tab label=\"Combats\" />\r\n              </Tabs>\r\n              \r\n              {/* Info Panel */}\r\n              {detailsTab === 0 && (\r\n                <Box sx={{ p: 2 }}>\r\n                  {selectedLocation?.backgroundMusic && (\r\n                    <Box sx={{ mb: 2 }}>\r\n                      <Typography variant=\"subtitle2\">Background Music:</Typography>\r\n                      <Chip \r\n                        icon={<MusicNoteIcon />} \r\n                        label={selectedLocation.backgroundMusic}\r\n                        size=\"small\"\r\n                        color=\"primary\"\r\n                        variant=\"outlined\"\r\n                        onClick={() => {\r\n                          if (selectedLocation?.backgroundMusic) {\r\n                            playTrack(selectedLocation.backgroundMusic, { \r\n                              replace: true,\r\n                              locationId: selectedLocation.id,\r\n                              loop: true\r\n                            });\r\n                          }\r\n                        }}\r\n                      />\r\n                    </Box>\r\n                  )}\r\n                  \r\n                  {selectedLocation?.entrySound && (\r\n                    <Box sx={{ mb: 2 }}>\r\n                      <Typography variant=\"subtitle2\">Entry Sound:</Typography>\r\n                      <Chip \r\n                        icon={<MusicNoteIcon />} \r\n                        label={selectedLocation.entrySound}\r\n                        size=\"small\"\r\n                        color=\"secondary\"\r\n                        variant=\"outlined\"\r\n                        onClick={() => {\r\n                          if (selectedLocation?.entrySound) {\r\n                            playTrack(selectedLocation.entrySound, { \r\n                              replace: false,\r\n                              locationId: selectedLocation.id\r\n                            });\r\n                          }\r\n                        }}\r\n                      />\r\n                    </Box>\r\n                  )}\r\n                  \r\n                  {selectedLocation?.connectedLocations && selectedLocation.connectedLocations.length > 0 && (\r\n                    <Box sx={{ mb: 2 }}>\r\n                      <Typography variant=\"subtitle2\">Connected Locations:</Typography>\r\n                      <Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 1, mt: 1 }}>\r\n                        {selectedLocation.connectedLocations.map(locId => {\r\n                          const connectedLoc = locations.find(l => l.id === locId);\r\n                          if (!connectedLoc) return null;\r\n                          \r\n                          return (\r\n                            <Chip \r\n                              key={locId}\r\n                              icon={<PlaceIcon />}\r\n                              label={connectedLoc.name}\r\n                              size=\"small\"\r\n                              color=\"info\"\r\n                              variant=\"outlined\"\r\n                              onClick={(e) => handleLocationClick(connectedLoc, e)}\r\n                            />\r\n                          );\r\n                        })}\r\n                      </Box>\r\n                    </Box>\r\n                  )}\r\n                </Box>\r\n              )}\r\n              \r\n              {/* NPCs Panel */}\r\n              {detailsTab === 1 && renderNpcsPanel()}\r\n              \r\n              {/* Combats Panel */}\r\n              {detailsTab === 2 && renderCombatsPanel()}\r\n            </Box>\r\n          </Box>\r\n        )}\r\n      </Paper>\r\n\r\n      {/* Main content area */}\r\n      <Box\r\n        ref={mapContainerRef}\r\n        sx={{\r\n          position: 'relative',\r\n          flex: 1,\r\n          height: '100%',\r\n          overflow: 'hidden',\r\n          backgroundColor: 'black',\r\n          zIndex: 1,\r\n          cursor: editMode ? 'crosshair' : 'default'\r\n        }}\r\n        onDragOver={handleDragOver}\r\n        onDrop={handleDrop}\r\n        onClick={handleMapClick}\r\n      >\r\n        {isLoading ? (\r\n          <Box \r\n            sx={{ \r\n              width: '100%', \r\n              height: '100%', \r\n              display: 'flex',\r\n              flexDirection: 'column',\r\n              alignItems: 'center', \r\n              justifyContent: 'center',\r\n              backgroundColor: 'rgba(0, 0, 0, 0.2)'\r\n            }}\r\n          >\r\n            <CircularProgress size={60} />\r\n            <Typography variant=\"body1\" sx={{ mt: 2 }}>\r\n              Loading map...\r\n            </Typography>\r\n          </Box>\r\n        ) : !imageUrl || !selectedLocation ? (\r\n          <Box \r\n            sx={{ \r\n              width: '100%', \r\n              height: '100%', \r\n              display: 'flex',\r\n              flexDirection: 'column',\r\n              alignItems: 'center', \r\n              justifyContent: 'center',\r\n              backgroundColor: 'rgba(0, 0, 0, 0.1)'\r\n            }}\r\n          >\r\n            <ImageNotSupportedIcon sx={{ fontSize: 60, opacity: 0.7 }} />\r\n            <Typography variant=\"body1\" sx={{ mt: 2, opacity: 0.7 }}>\r\n              No map image available\r\n            </Typography>\r\n          </Box>\r\n        ) : (\r\n          <TransformWrapper\r\n            key=\"main-map\"\r\n            initialScale={1}\r\n            initialPositionX={0}\r\n            initialPositionY={0}\r\n            minScale={0.5}\r\n            maxScale={5}\r\n            wheel={{ step: 0.1 }}\r\n            limitToBounds={false}\r\n            disablePadding={true}\r\n            disabled={editMode}\r\n          >\r\n            {() => (\r\n              <>\r\n                <TransformComponent\r\n                  wrapperStyle={{\r\n                    width: '100%',\r\n                    height: '100%',\r\n                    position: 'absolute',\r\n                    top: 0,\r\n                    left: 0,\r\n                    zIndex: 0,\r\n                  }}\r\n                  contentStyle={{\r\n                    width: '100%',\r\n                    height: '100%',\r\n                    display: 'flex',\r\n                    justifyContent: 'center',\r\n                    alignItems: 'center',\r\n                  }}\r\n                >\r\n                  <Box \r\n                    sx={{\r\n                      position: 'relative',\r\n                      display: 'flex',\r\n                      justifyContent: 'center',\r\n                      alignItems: 'center',\r\n                      width: '100%',\r\n                      height: '100%',\r\n                    }}\r\n                  >\r\n                    <img\r\n                      ref={imageRef}\r\n                      src={imageUrl}\r\n                      alt={selectedLocation?.name || 'Map'}\r\n                      style={{\r\n                        maxWidth: '100%',\r\n                        maxHeight: '100%',\r\n                        objectFit: 'contain',\r\n                        position: 'relative',\r\n                        zIndex: 1,\r\n                      }}\r\n                      onLoad={() => setIsImageLoading(false)}\r\n                      onError={() => setIsImageLoading(false)}\r\n                    />\r\n                    {renderLocationMarkers()}\r\n                    {getDirectionalArrows()}\r\n                  </Box>\r\n                </TransformComponent>\r\n              </>\r\n            )}\r\n          </TransformWrapper>\r\n        )}\r\n        \r\n        {/* Empty state */}\r\n        {!hasLocations && !isLoading && (\r\n          <Box\r\n            sx={{\r\n              position: 'absolute',\r\n              top: 0,\r\n              left: 0,\r\n              width: '100%',\r\n              height: '100%',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              zIndex: 10,\r\n            }}\r\n          >\r\n            <Box sx={{ textAlign: 'center', maxWidth: 400, p: 3, bgcolor: 'rgba(0,0,0,0.8)', color: 'white', borderRadius: 2 }}>\r\n              <Typography variant=\"h5\" gutterBottom>\r\n                No locations found\r\n              </Typography>\r\n              <Typography variant=\"body1\" paragraph>\r\n                Your campaign doesn't have any locations yet. Import data or create locations in edit mode.\r\n              </Typography>\r\n              <Button \r\n                variant=\"contained\" \r\n                color=\"primary\" \r\n                sx={{ mr: 1 }}\r\n                onClick={() => setShowAssetManager(true)}\r\n              >\r\n                Import Assets\r\n              </Button>\r\n              <Button \r\n                variant=\"outlined\" \r\n                color=\"secondary\"\r\n                onClick={toggleEditMode}\r\n              >\r\n                {editMode ? 'Exit Edit Mode' : 'Enter Edit Mode'}\r\n              </Button>\r\n            </Box>\r\n          </Box>\r\n        )}\r\n      </Box>\r\n\r\n      {/* Edit Location Dialog */}\r\n      <Dialog open={showEditDialog} onClose={() => setShowEditDialog(false)} maxWidth=\"md\" fullWidth>\r\n        <DialogTitle>\r\n          Edit Location\r\n          <IconButton\r\n            aria-label=\"close\"\r\n            onClick={() => setShowEditDialog(false)}\r\n            sx={{ position: 'absolute', right: 8, top: 8 }}\r\n          >\r\n            <CancelIcon />\r\n          </IconButton>\r\n        </DialogTitle>\r\n        <DialogContent dividers>\r\n          {editingLocation && (\r\n            <Stack spacing={2}>\r\n              <TextField\r\n                label=\"Name\"\r\n                fullWidth\r\n                value={editingLocation.name}\r\n                onChange={(e) => setEditingLocation({\r\n                  ...editingLocation,\r\n                  name: e.target.value\r\n                })}\r\n              />\r\n              <TextField\r\n                label=\"Description\"\r\n                fullWidth\r\n                multiline\r\n                rows={4}\r\n                value={editingLocation.description}\r\n                onChange={(e) => setEditingLocation({\r\n                  ...editingLocation,\r\n                  description: e.target.value\r\n                })}\r\n              />\r\n              \r\n              <Autocomplete\r\n                multiple\r\n                options={locations.filter(loc => loc.id !== editingLocation.id)}\r\n                value={locations.filter(loc => editingLocation.connectedLocations?.includes(loc.id) || false)}\r\n                onChange={(_, newValue) => setEditingLocation({\r\n                  ...editingLocation,\r\n                  connectedLocations: newValue.map(item => item.id)\r\n                })}\r\n                getOptionLabel={(option) => option.name}\r\n                renderInput={(params) => (\r\n                  <TextField\r\n                    {...params}\r\n                    label=\"Connected Locations\"\r\n                    fullWidth\r\n                    helperText=\"Select locations that are connected to this one\"\r\n                  />\r\n                )}\r\n                isOptionEqualToValue={(option, value) => option.id === value.id}\r\n                renderTags={(value, getTagProps) =>\r\n                  value.map((option, index) => (\r\n                    <Chip\r\n                      label={option.name}\r\n                      {...getTagProps({ index })}\r\n                      key={option.id}\r\n                    />\r\n                  ))\r\n                }\r\n              />\r\n              \r\n              {editingLocation.coordinates && (\r\n                <Box sx={{ display: 'flex', gap: 2 }}>\r\n                  <TextField\r\n                    label=\"X Coordinate\"\r\n                    type=\"number\"\r\n                    InputProps={{ inputProps: { min: 0, max: 1, step: 0.01 } }}\r\n                    value={editingLocation.coordinates[0]}\r\n                    onChange={(e) => {\r\n                      if (editingLocation.coordinates) {\r\n                        const x = parseFloat(e.target.value);\r\n                        const y = editingLocation.coordinates[1];\r\n                        setEditingLocation({\r\n                          ...editingLocation,\r\n                          coordinates: [x, y]\r\n                        });\r\n                      }\r\n                    }}\r\n                  />\r\n                  <TextField\r\n                    label=\"Y Coordinate\"\r\n                    type=\"number\"\r\n                    InputProps={{ inputProps: { min: 0, max: 1, step: 0.01 } }}\r\n                    value={editingLocation.coordinates[1]}\r\n                    onChange={(e) => {\r\n                      if (editingLocation.coordinates) {\r\n                        const x = editingLocation.coordinates[0];\r\n                        const y = parseFloat(e.target.value);\r\n                        setEditingLocation({\r\n                          ...editingLocation,\r\n                          coordinates: [x, y]\r\n                        });\r\n                      }\r\n                    }}\r\n                  />\r\n                </Box>\r\n              )}\r\n            </Stack>\r\n          )}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setShowEditDialog(false)}>Cancel</Button>\r\n          <Button \r\n            onClick={() => {\r\n              if (editingLocation) {\r\n                const updateLocationFn = useStore.getState().updateLocation;\r\n                updateLocationFn(editingLocation.id, {\r\n                  name: editingLocation.name,\r\n                  description: editingLocation.description,\r\n                  coordinates: editingLocation.coordinates,\r\n                  connectedLocations: editingLocation.connectedLocations\r\n                });\r\n                useStore.getState().saveDataToIndexedDB();\r\n                setShowEditDialog(false);\r\n              }\r\n            }} \r\n            variant=\"contained\" \r\n            color=\"primary\"\r\n          >\r\n            Save\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      {/* Asset Manager Dialog */}\r\n      <Dialog open={showAssetManager} onClose={() => setShowAssetManager(false)} maxWidth=\"md\" fullWidth>\r\n        <DialogTitle>\r\n          <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n            Asset Manager\r\n            <IconButton \r\n              edge=\"end\" \r\n              onClick={() => setShowAssetManager(false)}\r\n            >\r\n              <CloseIcon />\r\n            </IconButton>\r\n          </Box>\r\n        </DialogTitle>\r\n        <DialogContent dividers>\r\n          <AssetDropZone onAssetImport={handleAssetImport} />\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* NPC Details Dialog */}\r\n      <Dialog\r\n        open={showNpcDetails}\r\n        onClose={() => setShowNpcDetails(false)}\r\n        maxWidth=\"sm\"\r\n        fullWidth\r\n      >\r\n        {renderNpcDetailsPanel()}\r\n      </Dialog>\r\n\r\n      {/* Combat Details Dialog */}\r\n      <Dialog\r\n        open={showCombatDetails}\r\n        onClose={() => setShowCombatDetails(false)}\r\n        maxWidth=\"sm\"\r\n        fullWidth\r\n      >\r\n        {renderCombatDetailsPanel()}\r\n      </Dialog>\r\n\r\n      {/* Description Dialog */}\r\n      <Dialog\r\n        open={showDescriptionDialog}\r\n        onClose={() => setShowDescriptionDialog(false)}\r\n        maxWidth=\"md\"\r\n        fullWidth\r\n      >\r\n        <DialogTitle>\r\n          {selectedLocation?.name} - Description\r\n          <IconButton\r\n            aria-label=\"close\"\r\n            onClick={() => setShowDescriptionDialog(false)}\r\n            sx={{ position: 'absolute', right: 8, top: 8 }}\r\n          >\r\n            <CloseIcon />\r\n          </IconButton>\r\n        </DialogTitle>\r\n        <DialogContent dividers>\r\n          <Typography variant=\"body1\" sx={{ whiteSpace: 'pre-wrap' }}>\r\n            {selectedLocation?.description}\r\n          </Typography>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setShowDescriptionDialog(false)}>Close</Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <AudioTrackPanel />\r\n\r\n      {/* Edit mode indicator */}\r\n      {editMode && (\r\n        <Paper\r\n          elevation={4}\r\n          sx={{\r\n            position: 'absolute',\r\n            top: 16,\r\n            left: '50%',\r\n            transform: 'translateX(-50%)',\r\n            zIndex: 1100,\r\n            padding: '8px 16px',\r\n            backgroundColor: 'rgba(0, 0, 0, 0.8)',\r\n            color: 'white',\r\n            borderRadius: 2,\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            gap: 1\r\n          }}\r\n        >\r\n          <EditIcon fontSize=\"small\" />\r\n          <Typography variant=\"subtitle2\">Edit Mode Active</Typography>\r\n        </Paper>\r\n      )}\r\n\r\n      {/* Floating action button for Edit Mode */}\r\n      <Tooltip\r\n        title={editMode ? \r\n          \"Exit Edit Mode\" : \r\n          \"Enter Edit Mode to add, edit, and reposition locations on the map\"\r\n        }\r\n        placement=\"left\"\r\n      >\r\n        <Fab\r\n          color={editMode ? \"secondary\" : \"primary\"}\r\n          aria-label=\"edit mode\"\r\n          sx={{\r\n            position: 'absolute',\r\n            bottom: 16,\r\n            right: 16,\r\n            zIndex: 1100,\r\n          }}\r\n          onClick={toggleEditMode}\r\n        >\r\n          {editMode ? <SaveIcon /> : <EditIcon />}\r\n        </Fab>\r\n      </Tooltip>\r\n      \r\n      {/* Save button when in edit mode */}\r\n      {editMode && (\r\n        <Tooltip\r\n          title=\"Save all changes to your campaign\"\r\n          placement=\"left\"\r\n        >\r\n          <Fab\r\n            color=\"success\"\r\n            aria-label=\"save changes\"\r\n            sx={{\r\n              position: 'absolute',\r\n              bottom: 16,\r\n              right: 96, // Position it to the left of the edit button\r\n              zIndex: 1100,\r\n            }}\r\n            onClick={handleSaveData}\r\n          >\r\n            <SaveIcon />\r\n          </Fab>\r\n        </Tooltip>\r\n      )}\r\n    </Box>\r\n  );\r\n}; "],"names":["roundNumber","num","decimal","checkIsNumber","defaultValue","handleCallback","context","event","callback","easeOut","t","linear","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","animations","handleCancelAnimationFrame","animation","handleCancelAnimation","contextInstance","handleSetupAnimation","animationName","animationTime","startTime","lastStep","frameTime","animationProgress","animationType","step","isValidTargetState","targetState","scale","positionX","positionY","animate","isValid","setTransformState","_a","scaleDiff","positionXDiff","positionYDiff","newScale","newPositionX","newPositionY","getComponentsSizes","wrapperComponent","contentComponent","wrapperWidth","wrapperHeight","contentWidth","contentHeight","newContentWidth","newContentHeight","newDiffWidth","newDiffHeight","getBounds","diffWidth","diffHeight","centerZoomedOut","scaleWidthFactor","scaleHeightFactor","minPositionX","maxPositionX","minPositionY","maxPositionY","calculateBounds","bounds","boundLimiter","value","minBound","maxBound","isActive","handleCalculateBounds","getMouseBoundedPosition","limitToBounds","paddingValueX","paddingValueY","paddingX","paddingY","x","y","handleCalculateZoomPositions","mouseX","mouseY","scaleDifference","calculatedPositionX","calculatedPositionY","newPositions","checkZoomBounds","zoom","minScale","maxScale","zoomPadding","enablePadding","scalePadding","minScaleWithPadding","isPanningStartAllowed","excluded","isInitialized","target","targetIsShadowDom","isWrapperChild","el","isAllowed","isExcluded","isExcludedNode","isPanningAllowed","isPanning","setup","disabled","handlePanningSetup","handleTouchPanningSetup","touches","oneFingerTouch","handlePanToBounds","_b","_c","xChanged","yChanged","mousePosX","mousePosY","_d","handleNewPosition","getPanningClientPosition","clientX","clientY","startCoords","transformState","panning","lockAxisX","lockAxisY","getPaddingValue","size","disablePadding","isVelocityCalculationAllowed","mounted","velocityAnimation","disabledVelocity","isVelocityAllowed","velocity","getVelocityMoveTime","equalToMove","sensitivity","getVelocityPosition","newPosition","startPosition","currentPosition","isLocked","minPosition","maxPosition","minTarget","maxTarget","calculatedPosition","getSizeMultiplier","defaultMultiplier","handleCalculateVelocity","position","lastMousePosition","velocityTime","now","sizeMultiplier","distanceX","distanceY","velocityX","velocityY","interval","speed","handleVelocityPanning","total","alignmentAnimation","zoomAnimation","sizeX","sizeY","velocityAlignmentTime","alignAnimationTime","moveAnimationTime","finalAnimationTime","maxTargetX","minTargetX","maxTargetY","minTargetY","startState","alignAnimation","alignStep","customStep","currentPositionX","currentPositionY","handlePanningStart","handleAlignToBounds","customAnimationTime","isDisabled","handlePanning","handlePanningEnd","velocityDisabled","wrapperRect","contentRect","isZoomed","shouldAnimate","handleZoomToPoint","handleAlignToScaleBounds","mousePositionX","mousePositionY","__assign","s","i","n","p","__spreadArray","to","from","pack","l","ar","initialState","initialSetup","baseClasses","createState","props","createSetup","newSetup","key","validValue","validParameter","dataType","isObject","isArray","handleCalculateButtonZoom","delta","smooth","targetScale","handleZoomToViewCenter","resetTransformations","onResetTransformation","initialTransformation","newBounds","boundedPositions","newState","getOffset","element","wrapper","content","state","offset","wrapperOffset","contentOffset","xOff","yOff","calculateZoomToNode","node","customZoom","nodeRect","nodeOffset","nodeLeft","nodeTop","nodeWidth","nodeHeight","scaleX","scaleY","offsetX","offsetY","zoomIn","zoomOut","setTransform","resetTransform","centerView","getCenterPosition","zoomToElement","getControls","getState","getContext","ref","passiveSupported","makePassiveEventOption","options","matchPrefix","exclude","cancelTimeout","timeout","getTransformStyles","centerPositionX","centerPositionY","mergeRefs","refs","isWheelAllowed","wheelDisabled","touchPadDisabled","getDeltaY","getDelta","customDelta","deltaY","getMousePosition","touch","handleCalculateWheelZoom","disable","getTarget","paddingEnabled","handleWheelZoomStop","previousWheelEvent","isPinchStartAllowed","isPinchAllowed","pinchStartDistance","calculateTouchMidPoint","firstPointX","firstPointY","secondPointX","secondPointY","getTouchDistance","calculatePinchZoom","currentDistance","pinchStartScale","touchProportion","wheelStopEventTime","wheelAnimationTime","handleWheelStart","onWheelStart","onZoomStart","handleWheelZoom","onWheel","onZoom","wheel","smoothStep","zoomStep","mousePosition","isPaddingDisabled","isLimitedToBounds","handleWheelStop","onWheelStop","onZoomStop","hasStoppedZooming","getTouchCenter","totalX","totalY","handlePinchStart","distance","center","handlePinchZoom","midPoint","panX","panY","finalX","finalY","handlePinchStop","pinchMidpoint","handleDoubleClickStop","handleDoubleClickResetMode","getDoubleClickScale","mode","handleDoubleClick","doubleClickStopEventTimer","isDoubleClickAllowed","ZoomPanPinch","_this","newProps","passive","currentDocument","currentWindow","isCentered","centerOnInit","hasTarget","entries","_i","entries_1","entry","currentWidth","currentHeight","keysPressed","onPanningStart","onPanning","onPanningStop","onPinchingStart","onPinching","onPinchingStop","isDoubleTap","isPanningAction","isPinchAction","e","keys","onTransformed","ctx_1","transform","ctx","Context","React","getContent","children","TransformWrapper","instance","useRef","useImperativeHandle","useEffect","localRef","useContext","styleInject","css","insertAt","head","style","css_248z","styles","TransformComponent","wrapperClass","contentClass","wrapperStyle","contentStyle","wrapperProps","_e","contentProps","_f","init","cleanupWindowEvents","wrapperRef","contentRef","_interopRequireDefault","require$$0","North","default_1","_createSvgIcon","require$$1","_jsxRuntime","require$$2","ImageNotSupported","MapView","navigate","useNavigate","locations","useStore","playTrack","getSublocationsByParentId","getAllTopLevelLocations","refreshAssets","isLoading","characters","combats","saveDataToIndexedDB","selectedLocationId","setSelectedLocationId","selectedLocation","setSelectedLocation","useState","showDetails","setShowDetails","showAssetManager","setShowAssetManager","editMode","setEditMode","isDragging","setIsDragging","editingLocation","setEditingLocation","showEditDialog","setShowEditDialog","imageRef","mapContainerRef","isImageLoading","setIsImageLoading","audioAssets","setAudioAssets","imageAssets","setImageAssets","hasLocations","imageUrl","setImageUrl","expandedNpcSections","setExpandedNpcSections","selectedNpc","setSelectedNpc","showNpcDetails","setShowNpcDetails","selectedCombat","setSelectedCombat","showCombatDetails","setShowCombatDetails","detailsTab","setDetailsTab","showDescriptionDialog","setShowDescriptionDialog","savedLocation","loc","topLocations","url","AssetManager","error","loadAudioAssets","assets","asset","loadImageAssets","handleLocationClick","location","soundUrl","Howl","audioPath","replace","handleAssetImport","locationId","refreshedLocation","handleMapClick","rect","newLocationData","addLocation","handleDragStart","img","handleDragOver","handleDrop","updateLocationFn","toggleEditMode","handleSaveData","result","renderLocationMarkers","sublocation","relX","relY","isSelected","jsx","Tooltip","jsxs","Box","PlaceIcon","Typography","renderLocationItem","depth","sublocations","hasSublocations","ListItem","ListItemButton","ListItemIcon","ListItemText","IconButton","Collapse","List","subloc","getDirectionalArrows","circleRadius","connectedLoc","currentX","currentY","targetX","targetY","dx","dy","angleDeg","normalizedDx","normalizedDy","mapCenterX","mapCenterY","arrowX","arrowY","NorthIcon","toggleNpcSection","sectionId","prev","getCharactersByLocationId","char","getAllCharactersInLocationHierarchy","directCharacters","allCharacters","sublocationCharacters","handleNpcClick","npc","renderNpcsPanel","directNpcs","allNpcs","hasSublocationsWithNpcs","Fragment","PersonIcon","MerchantIcon","SportsKabaddiIcon","Divider","renderSublocationsNpcs","npcs","isExpanded","ExpandLessIcon","ExpandMoreIcon","renderNpcDetailsPanel","locationName","updateCharacter","handleAddItem","newItem","updatedInventory","handleUpdateItem","itemId","itemData","item","handleDeleteItem","CloseIcon","AddIcon","DeleteIcon","TextField","Button","getCombatsByLocationHierarchy","directCombats","combat","allCombats","sublocationCombats","handleCombatClick","renderCombatsPanel","hasSublocationsWithCombats","renderSubLocationsCombats","locationCombats","renderCombatDetailsPanel","character","acc","enemy","id","count","CircularProgress","Paper","Tabs","_","Tab","ArrowBackIcon","EditIcon","Chip","MusicNoteIcon","locId","ImageNotSupportedIcon","Dialog","DialogTitle","CancelIcon","DialogContent","Stack","Autocomplete","newValue","option","params","getTagProps","index","createElement","DialogActions","AssetDropZone","AudioTrackPanel","Fab","SaveIcon"],"mappings":"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","x_google_ignoreList":[0,1,2]}
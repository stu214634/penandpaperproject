import{i as Ri,j as r,B as b,G as Pi,d as T,P as Ue,O as Ti,Q as Pe,L as U,I as K,a0 as Yn,a1 as Ge,a2 as pe,M as zi,a3 as _e,e as fe,l as Te,m as Je,a4 as kn,n as Ie,a5 as Dn,o as I,a6 as Xn,r as Ai,q as ie,a7 as Yi,a8 as ki,f as Z,a9 as En,g as me,h as R,z as ei,aa as ii,ab as Di,ac as Me,k as xe,ad as Wn,E as Xi,y as Ei}from"./mui-vendor-BNyFSCPN.js";import{a as re,r as P,i as Nn}from"./react-vendor-BzdEknB4.js";import{r as $i,u as _,A as Wi,M as G,d as Be,a as _n,b as Oe,c as ye,e as Mn}from"./index-B0S_hfGj.js";import{h as Bn}from"./utilities-BTDtKTyc.js";import"./map-vendor-CMk8R3PE.js";var F=function(e,t){return Number(e.toFixed(t))},On=function(e,t){return t},X=function(e,t,i){i&&typeof i=="function"&&i(e,t)},Ln=function(e){return-Math.cos(e*Math.PI)/2+.5},Hn=function(e){return e},Zn=function(e){return e*e},Rn=function(e){return e*(2-e)},$n=function(e){return e<.5?2*e*e:-1+(4-2*e)*e},Fn=function(e){return e*e*e},Vn=function(e){return--e*e*e+1},Kn=function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},qn=function(e){return e*e*e*e},Qn=function(e){return 1- --e*e*e*e},Un=function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},Gn=function(e){return e*e*e*e*e},Jn=function(e){return 1+--e*e*e*e*e},In=function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e},Fi={easeOut:Ln,linear:Hn,easeInQuad:Zn,easeOutQuad:Rn,easeInOutQuad:$n,easeInCubic:Fn,easeOutCubic:Vn,easeInOutCubic:Kn,easeInQuart:qn,easeOutQuart:Qn,easeInOutQuart:Un,easeInQuint:Gn,easeOutQuint:Jn,easeInOutQuint:In},Vi=function(e){typeof e=="number"&&cancelAnimationFrame(e)},q=function(e){e.mounted&&(Vi(e.animation),e.animate=!1,e.animation=null,e.velocity=null)};function Ki(e,t,i,n){if(e.mounted){var a=new Date().getTime(),o=1;q(e),e.animation=function(){if(!e.mounted)return Vi(e.animation);var s=new Date().getTime()-a,l=s/i,c=Fi[t],h=c(l);s>=i?(n(o),e.animation=null):e.animation&&(n(h),requestAnimationFrame(e.animation))},requestAnimationFrame(e.animation)}}function er(e){var t=e.scale,i=e.positionX,n=e.positionY;return!(Number.isNaN(t)||Number.isNaN(i)||Number.isNaN(n))}function ae(e,t,i,n){var a=er(t);if(!(!e.mounted||!a)){var o=e.setTransformState,s=e.transformState,l=s.scale,c=s.positionX,h=s.positionY,f=t.scale-l,g=t.positionX-c,d=t.positionY-h;i===0?o(t.scale,t.positionX,t.positionY):Ki(e,n,i,function(y){var w=l+f*y,j=c+g*y,A=h+d*y;o(w,j,A)})}}function ir(e,t,i){var n=e.offsetWidth,a=e.offsetHeight,o=t.offsetWidth,s=t.offsetHeight,l=o*i,c=s*i,h=n-l,f=a-c;return{wrapperWidth:n,wrapperHeight:a,newContentWidth:l,newDiffWidth:h,newContentHeight:c,newDiffHeight:f}}var nr=function(e,t,i,n,a,o,s){var l=e>t?i*(s?1:.5):0,c=n>a?o*(s?1:.5):0,h=e-t-l,f=l,g=n-a-c,d=c;return{minPositionX:h,maxPositionX:f,minPositionY:g,maxPositionY:d}},li=function(e,t){var i=e.wrapperComponent,n=e.contentComponent,a=e.setup.centerZoomedOut;if(!i||!n)throw new Error("Components are not mounted");var o=ir(i,n,t),s=o.wrapperWidth,l=o.wrapperHeight,c=o.newContentWidth,h=o.newDiffWidth,f=o.newContentHeight,g=o.newDiffHeight,d=nr(s,c,h,l,f,g,!!a);return d},ti=function(e,t,i,n){return n?e<t?F(t,2):e>i?F(i,2):F(e,2):F(e,2)},he=function(e,t){var i=li(e,t);return e.bounds=i,i};function Ae(e,t,i,n,a,o,s){var l=i.minPositionX,c=i.minPositionY,h=i.maxPositionX,f=i.maxPositionY,g=0,d=0;s&&(g=a,d=o);var y=ti(e,l-g,h+g,n),w=ti(t,c-d,f+d,n);return{x:y,y:w}}function Ze(e,t,i,n,a,o){var s=e.transformState,l=s.scale,c=s.positionX,h=s.positionY,f=n-l;if(typeof t!="number"||typeof i!="number")return console.error("Mouse X and Y position were not provided!"),{x:c,y:h};var g=c-t*f,d=h-i*f,y=Ae(g,d,a,o,0,0,null);return y}function Ye(e,t,i,n,a){var o=a?n:0,s=t-o;return!Number.isNaN(i)&&e>=i?i:!Number.isNaN(t)&&e<=s?s:e}var Ni=function(e,t){var i=e.setup.panning.excluded,n=e.isInitialized,a=e.wrapperComponent,o=t.target,s="shadowRoot"in o&&"composedPath"in t,l=s?t.composedPath().some(function(f){return f instanceof Element?a==null?void 0:a.contains(f):!1}):a==null?void 0:a.contains(o),c=n&&o&&l;if(!c)return!1;var h=Re(o,i);return!h},_i=function(e){var t=e.isInitialized,i=e.isPanning,n=e.setup,a=n.panning.disabled,o=t&&i&&!a;return!!o},rr=function(e,t){var i=e.transformState,n=i.positionX,a=i.positionY;e.isPanning=!0;var o=t.clientX,s=t.clientY;e.startCoords={x:o-n,y:s-a}},tr=function(e,t){var i=t.touches,n=e.transformState,a=n.positionX,o=n.positionY;e.isPanning=!0;var s=i.length===1;if(s){var l=i[0].clientX,c=i[0].clientY;e.startCoords={x:l-a,y:c-o}}};function ar(e){var t=e.transformState,i=t.positionX,n=t.positionY,a=t.scale,o=e.setup,s=o.disabled,l=o.limitToBounds,c=o.centerZoomedOut,h=e.wrapperComponent;if(!(s||!h||!e.bounds)){var f=e.bounds,g=f.maxPositionX,d=f.minPositionX,y=f.maxPositionY,w=f.minPositionY,j=i>g||i<d,A=n>y||n<w,W=i>g?h.offsetWidth:e.setup.minPositionX||0,S=n>y?h.offsetHeight:e.setup.minPositionY||0,E=Ze(e,W,S,a,e.bounds,l||c),Q=E.x,L=E.y;return{scale:a,positionX:j?Q:i,positionY:A?L:n}}}function qi(e,t,i,n,a){var o=e.setup.limitToBounds,s=e.wrapperComponent,l=e.bounds,c=e.transformState,h=c.scale,f=c.positionX,g=c.positionY;if(!(s===null||l===null||t===f&&i===g)){var d=Ae(t,i,l,o,n,a,s),y=d.x,w=d.y;e.setTransformState(h,y,w)}}var or=function(e,t,i){var n=e.startCoords,a=e.transformState,o=e.setup.panning,s=o.lockAxisX,l=o.lockAxisY,c=a.positionX,h=a.positionY;if(!n)return{x:c,y:h};var f=t-n.x,g=i-n.y,d=s?c:f,y=l?h:g;return{x:d,y}},te=function(e,t){var i=e.setup,n=e.transformState,a=n.scale,o=i.minScale,s=i.disablePadding;return t>0&&a>=o&&!s?t:0},sr=function(e){var t=e.mounted,i=e.setup,n=i.disabled,a=i.velocityAnimation,o=e.transformState.scale,s=a.disabled,l=!s||o>1||!n||t;return!!l},lr=function(e){var t=e.mounted,i=e.velocity,n=e.bounds,a=e.setup,o=a.disabled,s=a.velocityAnimation,l=e.transformState.scale,c=s.disabled,h=!c||l>1||!o||t;return!(!h||!i||!n)};function dr(e,t){var i=e.setup.velocityAnimation,n=i.equalToMove,a=i.animationTime,o=i.sensitivity;return n?a*t*o:a}function Mi(e,t,i,n,a,o,s,l,c,h){if(a){if(t>s&&i>s){var f=s+(e-s)*h;return f>c?c:f<s?s:f}if(t<o&&i<o){var f=o+(e-o)*h;return f<l?l:f>o?o:f}}return n?t:ti(e,o,s,a)}function ur(e,t){var i=1;return t?Math.min(i,e.offsetWidth/window.innerWidth):i}function cr(e,t){var i=sr(e);if(i){var n=e.lastMousePosition,a=e.velocityTime,o=e.setup,s=e.wrapperComponent,l=o.velocityAnimation.equalToMove,c=Date.now();if(n&&a&&s){var h=ur(s,l),f=t.x-n.x,g=t.y-n.y,d=f/h,y=g/h,w=c-a,j=f*f+g*g,A=Math.sqrt(j)/w;e.velocity={velocityX:d,velocityY:y,total:A}}e.lastMousePosition=t,e.velocityTime=c}}function pr(e){var t=e.velocity,i=e.bounds,n=e.setup,a=e.wrapperComponent,o=lr(e);if(!(!o||!t||!i||!a)){var s=t.velocityX,l=t.velocityY,c=t.total,h=i.maxPositionX,f=i.minPositionX,g=i.maxPositionY,d=i.minPositionY,y=n.limitToBounds,w=n.alignmentAnimation,j=n.zoomAnimation,A=n.panning,W=A.lockAxisY,S=A.lockAxisX,E=j.animationType,Q=w.sizeX,L=w.sizeY,z=w.velocityAlignmentTime,B=z,$=dr(e,c),O=Math.max($,B),V=te(e,Q),H=te(e,L),oe=V*a.offsetWidth/100,J=H*a.offsetHeight/100,ke=h+oe,se=f-oe,De=g+J,ve=d-J,be=e.transformState,Xe=new Date().getTime();Ki(e,E,O,function(Se){var ge=e.transformState,$e=ge.scale,Y=ge.positionX,ee=ge.positionY,Fe=new Date().getTime()-Xe,we=Fe/B,M=Fi[w.animationType],Ee=1-M(Math.min(1,we)),We=1-Se,le=Y+s*We,de=ee+l*We,Ve=Mi(le,be.positionX,Y,S,y,f,h,se,ke,Ee),Ke=Mi(de,be.positionY,ee,W,y,d,g,ve,De,Ee);(Y!==le||ee!==de)&&e.setTransformState($e,Ve,Ke)})}}function Bi(e,t){var i=e.transformState.scale;q(e),he(e,i),window.TouchEvent!==void 0&&t instanceof TouchEvent?tr(e,t):rr(e,t)}function di(e,t){var i=e.transformState.scale,n=e.setup,a=n.minScale,o=n.alignmentAnimation,s=o.disabled,l=o.sizeX,c=o.sizeY,h=o.animationTime,f=o.animationType,g=s||i<a||!l&&!c;if(!g){var d=ar(e);d&&ae(e,d,t??h,f)}}function Oi(e,t,i){var n=e.startCoords,a=e.setup,o=a.alignmentAnimation,s=o.sizeX,l=o.sizeY;if(n){var c=or(e,t,i),h=c.x,f=c.y,g=te(e,s),d=te(e,l);cr(e,{x:h,y:f}),qi(e,h,f,g,d)}}function fr(e){if(e.isPanning){var t=e.setup.panning.velocityDisabled,i=e.velocity,n=e.wrapperComponent,a=e.contentComponent;e.isPanning=!1,e.animate=!1,e.animation=null;var o=n==null?void 0:n.getBoundingClientRect(),s=a==null?void 0:a.getBoundingClientRect(),l=(o==null?void 0:o.width)||0,c=(o==null?void 0:o.height)||0,h=(s==null?void 0:s.width)||0,f=(s==null?void 0:s.height)||0,g=l<h||c<f,d=!t&&i&&(i==null?void 0:i.total)>.1&&g;d?pr(e):di(e)}}function ui(e,t,i,n){var a=e.setup,o=a.minScale,s=a.maxScale,l=a.limitToBounds,c=Ye(F(t,2),o,s,0,!1),h=he(e,c),f=Ze(e,i,n,c,h,l),g=f.x,d=f.y;return{scale:c,positionX:g,positionY:d}}function Qi(e,t,i){var n=e.transformState.scale,a=e.wrapperComponent,o=e.setup,s=o.minScale,l=o.limitToBounds,c=o.zoomAnimation,h=c.disabled,f=c.animationTime,g=c.animationType,d=h||n>=s;if((n>=1||l)&&di(e),!(d||!a||!e.mounted)){var y=t||a.offsetWidth/2,w=i||a.offsetHeight/2,j=ui(e,s,y,w);j&&ae(e,j,f,g)}}var ne=function(){return ne=Object.assign||function(t){for(var i,n=1,a=arguments.length;n<a;n++){i=arguments[n];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}return t},ne.apply(this,arguments)};function Li(e,t,i){for(var n=0,a=t.length,o;n<a;n++)(o||!(n in t))&&(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}var Le={scale:1,positionX:0,positionY:0},ze={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,allowLeftClickPan:!0,allowMiddleClickPan:!0,allowRightClickPan:!0,wheelPanning:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},ai={wrapperClass:"react-transform-wrapper",contentClass:"react-transform-component"},Ui=function(e){var t,i,n,a;return{previousScale:(t=e.initialScale)!==null&&t!==void 0?t:Le.scale,scale:(i=e.initialScale)!==null&&i!==void 0?i:Le.scale,positionX:(n=e.initialPositionX)!==null&&n!==void 0?n:Le.positionX,positionY:(a=e.initialPositionY)!==null&&a!==void 0?a:Le.positionY}},Hi=function(e){var t=ne({},ze);return Object.keys(e).forEach(function(i){var n=typeof e[i]<"u",a=typeof ze[i]<"u";if(a&&n){var o=Object.prototype.toString.call(ze[i]),s=o==="[object Object]",l=o==="[object Array]";s?t[i]=ne(ne({},ze[i]),e[i]):l?t[i]=Li(Li([],ze[i],!0),e[i]):t[i]=e[i]}}),t},Gi=function(e,t,i){var n=e.transformState.scale,a=e.wrapperComponent,o=e.setup,s=o.maxScale,l=o.minScale,c=o.zoomAnimation,h=o.smooth,f=c.size;if(!a)throw new Error("Wrapper is not mounted");var g=h?n*Math.exp(t*i):n+t*i,d=Ye(F(g,3),l,s,f,!1);return d};function Ji(e,t,i,n,a){var o=e.wrapperComponent,s=e.transformState,l=s.scale,c=s.positionX,h=s.positionY;if(!o)return console.error("No WrapperComponent found");var f=o.offsetWidth,g=o.offsetHeight,d=(f/2-c)/l,y=(g/2-h)/l,w=Gi(e,t,i),j=ui(e,w,d,y);if(!j)return console.error("Error during zoom event. New transformation state was not calculated.");ae(e,j,n,a)}function Ii(e,t,i,n){var a=e.setup,o=e.wrapperComponent,s=a.limitToBounds,l=Ui(e.props),c=e.transformState,h=c.scale,f=c.positionX,g=c.positionY;if(o){var d=li(e,l.scale),y=Ae(l.positionX,l.positionY,d,s,0,0,o),w={scale:l.scale,positionX:y.x,positionY:y.y};h===l.scale&&f===l.positionX&&g===l.positionY||(n==null||n(),ae(e,w,t,i))}}function mr(e,t,i,n){var a=e.getBoundingClientRect(),o=t.getBoundingClientRect(),s=i.getBoundingClientRect(),l=o.x*n.scale,c=o.y*n.scale;return{x:(a.x-s.x+l)/n.scale,y:(a.y-s.y+c)/n.scale}}function hr(e,t,i){var n=e.wrapperComponent,a=e.contentComponent,o=e.transformState,s=e.setup,l=s.limitToBounds,c=s.minScale,h=s.maxScale;if(!n||!a)return o;var f=n.getBoundingClientRect(),g=t.getBoundingClientRect(),d=mr(t,n,a,o),y=d.x,w=d.y,j=g.width/o.scale,A=g.height/o.scale,W=n.offsetWidth/j,S=n.offsetHeight/A,E=Ye(i||Math.min(W,S),c,h,0,!1),Q=(f.width-j*E)/2,L=(f.height-A*E)/2,z=(f.left-y)*E+Q,B=(f.top-w)*E+L,$=li(e,E),O=Ae(z,B,$,l,0,0,n),V=O.x,H=O.y;return{positionX:V,positionY:H,scale:E}}var vr=function(e){return function(t,i,n){t===void 0&&(t=.5),i===void 0&&(i=300),n===void 0&&(n="easeOut"),Ji(e,1,t,i,n)}},gr=function(e){return function(t,i,n){t===void 0&&(t=.5),i===void 0&&(i=300),n===void 0&&(n="easeOut"),Ji(e,-1,t,i,n)}},xr=function(e){return function(t,i,n,a,o){a===void 0&&(a=300),o===void 0&&(o="easeOut");var s=e.transformState,l=s.positionX,c=s.positionY,h=s.scale,f=e.wrapperComponent,g=e.contentComponent,d=e.setup.disabled;if(!(d||!f||!g)){var y={positionX:Number.isNaN(t)?l:t,positionY:Number.isNaN(i)?c:i,scale:Number.isNaN(n)?h:n};ae(e,y,a,o)}}},yr=function(e){return function(t,i){t===void 0&&(t=200),i===void 0&&(i="easeOut"),Ii(e,t,i)}},br=function(e){return function(t,i,n){i===void 0&&(i=200),n===void 0&&(n="easeOut");var a=e.transformState,o=e.wrapperComponent,s=e.contentComponent;if(o&&s){var l=en(t||a.scale,o,s);ae(e,l,i,n)}}},Sr=function(e){return function(t,i,n,a){n===void 0&&(n=600),a===void 0&&(a="easeOut"),q(e);var o=e.wrapperComponent,s=typeof t=="string"?document.getElementById(t):t;if(o&&s&&o.contains(s)){var l=hr(e,s,i);ae(e,l,n,a)}}},oi=function(e){return{instance:e,zoomIn:vr(e),zoomOut:gr(e),setTransform:xr(e),resetTransform:yr(e),centerView:br(e),zoomToElement:Sr(e)}},wr=function(e){return{instance:e,state:e.transformState}},D=function(e){var t={};return Object.assign(t,wr(e)),Object.assign(t,oi(e)),t},ni=!1;function ri(){try{var e={get passive(){return ni=!0,!1}};return e}catch{return ni=!1,ni}}var He=".".concat(ai.wrapperClass),Re=function(e,t){return t.some(function(i){return e.matches("".concat(He," ").concat(i,", ").concat(He," .").concat(i,", ").concat(He," ").concat(i," *, ").concat(He," .").concat(i," *"))})},si=function(e){e&&clearTimeout(e)},jr=function(e,t,i){return"translate(".concat(e,"px, ").concat(t,"px) scale(").concat(i,")")},en=function(e,t,i){var n=i.offsetWidth*e,a=i.offsetHeight*e,o=(t.offsetWidth-n)/2,s=(t.offsetHeight-a)/2;return{scale:e,positionX:o,positionY:s}};function Cr(e){return function(t){e.forEach(function(i){typeof i=="function"?i(t):i!=null&&(i.current=t)})}}var Pr=function(e,t){var i=e.setup.wheel,n=i.disabled,a=i.wheelDisabled,o=i.touchPadDisabled,s=i.excluded,l=e.isInitialized,c=e.isPanning,h=t.target,f=l&&!c&&!n&&h;if(!f||a&&!t.ctrlKey||o&&t.ctrlKey)return!1;var g=Re(h,s);return!g},Tr=function(e){return e?e.deltaY<0?1:-1:0};function zr(e,t){var i=Tr(e),n=On(t,i);return n}function nn(e,t,i){var n=t.getBoundingClientRect(),a=0,o=0;if("clientX"in e)a=(e.clientX-n.left)/i,o=(e.clientY-n.top)/i;else{var s=e.touches[0];a=(s.clientX-n.left)/i,o=(s.clientY-n.top)/i}return(Number.isNaN(a)||Number.isNaN(o))&&console.error("No mouse or touch offset found"),{x:a,y:o}}var Ar=function(e,t,i,n,a){var o=e.transformState.scale,s=e.wrapperComponent,l=e.setup,c=l.maxScale,h=l.minScale,f=l.zoomAnimation,g=l.disablePadding,d=f.size,y=f.disabled;if(!s)throw new Error("Wrapper is not mounted");var w=o+t*i,j=n?!1:!y,A=Ye(F(w,3),h,c,d,j&&!g);return A},Yr=function(e,t){var i=e.previousWheelEvent,n=e.transformState.scale,a=e.setup,o=a.maxScale,s=a.minScale;return i?n<o||n>s||Math.sign(i.deltaY)!==Math.sign(t.deltaY)||i.deltaY>0&&i.deltaY<t.deltaY||i.deltaY<0&&i.deltaY>t.deltaY||Math.sign(i.deltaY)!==Math.sign(t.deltaY):!1},kr=function(e,t){var i=e.setup.pinch,n=i.disabled,a=i.excluded,o=e.isInitialized,s=t.target,l=o&&!n&&s;if(!l)return!1;var c=Re(s,a);return!c},Dr=function(e){var t=e.setup.pinch.disabled,i=e.isInitialized,n=e.pinchStartDistance,a=i&&!t&&n;return!!a},Xr=function(e,t,i){var n=i.getBoundingClientRect(),a=e.touches,o=F(a[0].clientX-n.left,5),s=F(a[0].clientY-n.top,5),l=F(a[1].clientX-n.left,5),c=F(a[1].clientY-n.top,5);return{x:(o+l)/2/t,y:(s+c)/2/t}},rn=function(e){return Math.sqrt(Math.pow(e.touches[0].pageX-e.touches[1].pageX,2)+Math.pow(e.touches[0].pageY-e.touches[1].pageY,2))},Er=function(e,t){var i=e.pinchStartScale,n=e.pinchStartDistance,a=e.setup,o=a.maxScale,s=a.minScale,l=a.zoomAnimation,c=a.disablePadding,h=l.size,f=l.disabled;if(!i||n===null||!t)throw new Error("Pinch touches distance was not provided");if(t<0)return e.transformState.scale;var g=t/n,d=g*i;return Ye(F(d,2),s,o,h,!f&&!c)},Wr=160,Nr=100,_r=function(e,t){var i=e.props,n=i.onWheelStart,a=i.onZoomStart;e.wheelStopEventTimer||(q(e),X(D(e),t,n),X(D(e),t,a))},Mr=function(e,t){var i=e.props,n=i.onWheel,a=i.onZoom,o=e.contentComponent,s=e.setup,l=e.transformState,c=l.scale,h=s.limitToBounds,f=s.centerZoomedOut,g=s.zoomAnimation,d=s.wheel,y=s.disablePadding,w=s.smooth,j=g.size,A=g.disabled,W=d.step,S=d.smoothStep;if(!o)throw new Error("Component not mounted");t.preventDefault(),t.stopPropagation();var E=zr(t,null),Q=w?S*Math.abs(t.deltaY):W,L=Ar(e,E,Q,!t.ctrlKey);if(c!==L){var z=he(e,L),B=nn(t,o,c),$=A||j===0||f||y,O=h&&$,V=Ze(e,B.x,B.y,L,z,O),H=V.x,oe=V.y;e.previousWheelEvent=t,e.setTransformState(L,H,oe),X(D(e),t,n),X(D(e),t,a)}},Br=function(e,t){var i=e.props,n=i.onWheelStop,a=i.onZoomStop;si(e.wheelAnimationTimer),e.wheelAnimationTimer=setTimeout(function(){e.mounted&&(Qi(e,t.x,t.y),e.wheelAnimationTimer=null)},Nr);var o=Yr(e,t);o&&(si(e.wheelStopEventTimer),e.wheelStopEventTimer=setTimeout(function(){e.mounted&&(e.wheelStopEventTimer=null,X(D(e),t,n),X(D(e),t,a))},Wr))},tn=function(e){for(var t=0,i=0,n=0;n<2;n+=1)t+=e.touches[n].clientX,i+=e.touches[n].clientY;var a=t/2,o=i/2;return{x:a,y:o}},Or=function(e,t){var i=rn(t);e.pinchStartDistance=i,e.lastDistance=i,e.pinchStartScale=e.transformState.scale,e.isPanning=!1;var n=tn(t);e.pinchLastCenterX=n.x,e.pinchLastCenterY=n.y,q(e)},Lr=function(e,t){var i=e.contentComponent,n=e.pinchStartDistance,a=e.wrapperComponent,o=e.transformState.scale,s=e.setup,l=s.limitToBounds,c=s.centerZoomedOut,h=s.zoomAnimation,f=s.alignmentAnimation,g=h.disabled,d=h.size;if(!(n===null||!i)){var y=Xr(t,o,i);if(!(!Number.isFinite(y.x)||!Number.isFinite(y.y))){var w=rn(t),j=Er(e,w),A=tn(t),W=A.x-(e.pinchLastCenterX||0),S=A.y-(e.pinchLastCenterY||0);if(!(j===o&&W===0&&S===0)){e.pinchLastCenterX=A.x,e.pinchLastCenterY=A.y;var E=he(e,j),Q=g||d===0||c,L=l&&Q,z=Ze(e,y.x,y.y,j,E,L),B=z.x,$=z.y;e.pinchMidpoint=y,e.lastDistance=w;var O=f.sizeX,V=f.sizeY,H=te(e,O),oe=te(e,V),J=B+W,ke=$+S,se=Ae(J,ke,E,l,H,oe,a),De=se.x,ve=se.y;e.setTransformState(j,De,ve)}}}},Hr=function(e){var t=e.pinchMidpoint;e.velocity=null,e.lastDistance=null,e.pinchMidpoint=null,e.pinchStartScale=null,e.pinchStartDistance=null,Qi(e,t==null?void 0:t.x,t==null?void 0:t.y)},an=function(e,t){var i=e.props.onZoomStop,n=e.setup.doubleClick.animationTime;si(e.doubleClickStopEventTimer),e.doubleClickStopEventTimer=setTimeout(function(){e.doubleClickStopEventTimer=null,X(D(e),t,i)},n)},Zr=function(e,t){var i=e.props,n=i.onZoomStart,a=i.onZoom,o=e.setup.doubleClick,s=o.animationTime,l=o.animationType;X(D(e),t,n),Ii(e,s,l,function(){return X(D(e),t,a)}),an(e,t)};function Rr(e,t){return e==="toggle"?t===1?1:-1:e==="zoomOut"?-1:1}function $r(e,t){var i=e.setup,n=e.doubleClickStopEventTimer,a=e.transformState,o=e.contentComponent,s=a.scale,l=e.props,c=l.onZoomStart,h=l.onZoom,f=i.doubleClick,g=f.disabled,d=f.mode,y=f.step,w=f.animationTime,j=f.animationType;if(!g&&!n){if(d==="reset")return Zr(e,t);if(!o)return console.error("No ContentComponent found");var A=Rr(d,e.transformState.scale),W=Gi(e,A,y);if(s!==W){X(D(e),t,c);var S=nn(t,o,s),E=ui(e,W,S.x,S.y);if(!E)return console.error("Error during zoom event. New transformation state was not calculated.");X(D(e),t,h),ae(e,E,w,j),an(e,t)}}}var Fr=function(e,t){var i=e.isInitialized,n=e.setup,a=e.wrapperComponent,o=n.doubleClick,s=o.disabled,l=o.excluded,c=t.target,h=a==null?void 0:a.contains(c),f=i&&c&&h&&!s;if(!f)return!1;var g=Re(c,l);return!g},Vr=function(){function e(t){var i=this;this.mounted=!0,this.pinchLastCenterX=null,this.pinchLastCenterY=null,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.isWheelPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){i.initializeWindowEvents()},this.unmount=function(){i.cleanupWindowEvents()},this.update=function(n){i.props=n,he(i,i.transformState.scale),i.setup=Hi(n)},this.initializeWindowEvents=function(){var n,a,o=ri(),s=(n=i.wrapperComponent)===null||n===void 0?void 0:n.ownerDocument,l=s==null?void 0:s.defaultView;(a=i.wrapperComponent)===null||a===void 0||a.addEventListener("wheel",i.onWheelPanning,o),l==null||l.addEventListener("mousedown",i.onPanningStart,o),l==null||l.addEventListener("mousemove",i.onPanning,o),l==null||l.addEventListener("mouseup",i.onPanningStop,o),s==null||s.addEventListener("mouseleave",i.clearPanning,o),l==null||l.addEventListener("keyup",i.setKeyUnPressed,o),l==null||l.addEventListener("keydown",i.setKeyPressed,o)},this.cleanupWindowEvents=function(){var n,a,o=ri(),s=(n=i.wrapperComponent)===null||n===void 0?void 0:n.ownerDocument,l=s==null?void 0:s.defaultView;l==null||l.removeEventListener("mousedown",i.onPanningStart,o),l==null||l.removeEventListener("mousemove",i.onPanning,o),l==null||l.removeEventListener("mouseup",i.onPanningStop,o),s==null||s.removeEventListener("mouseleave",i.clearPanning,o),l==null||l.removeEventListener("keyup",i.setKeyUnPressed,o),l==null||l.removeEventListener("keydown",i.setKeyPressed,o),document.removeEventListener("mouseleave",i.clearPanning,o),q(i),(a=i.observer)===null||a===void 0||a.disconnect()},this.handleInitializeWrapperEvents=function(n){var a=ri();n.addEventListener("wheel",i.onWheelZoom,a),n.addEventListener("dblclick",i.onDoubleClick,a),n.addEventListener("touchstart",i.onTouchPanningStart,a),n.addEventListener("touchmove",i.onTouchPanning,a),n.addEventListener("touchend",i.onTouchPanningStop,a)},this.handleInitialize=function(n,a){var o=!1,s=i.setup.centerOnInit,l=function(c,h){for(var f=0,g=c;f<g.length;f++){var d=g[f];if(d.target===h)return!0}return!1};i.applyTransformation(),i.onInitCallbacks.forEach(function(c){c(D(i))}),i.observer=new ResizeObserver(function(c){if(l(c,n)||l(c,a))if(s&&!o){var h=a.offsetWidth,f=a.offsetHeight;(h>0||f>0)&&(o=!0,i.setCenter())}else q(i),he(i,i.transformState.scale),di(i,0)}),i.observer.observe(n),i.observer.observe(a)},this.onWheelZoom=function(n){var a=i.setup.disabled;if(!a){var o=Pr(i,n);if(o){var s=i.isPressingKeys(i.setup.wheel.activationKeys);s&&(_r(i,n),Mr(i,n),Br(i,n))}}},this.onWheelPanning=function(n){var a=i.setup,o=a.disabled,s=a.wheel,l=a.panning;if(!(!i.wrapperComponent||!i.contentComponent||o||!s.wheelDisabled||l.disabled||!l.wheelPanning||n.ctrlKey)){n.preventDefault(),n.stopPropagation();var c=i.transformState,h=c.positionX,f=c.positionY,g=h-n.deltaX,d=f-n.deltaY,y=l.lockAxisX?h:g,w=l.lockAxisY?f:d,j=i.setup.alignmentAnimation,A=j.sizeX,W=j.sizeY,S=te(i,A),E=te(i,W);y===h&&w===f||qi(i,y,w,S,E)}},this.onPanningStart=function(n){var a=i.setup.disabled,o=i.props.onPanningStart;if(!a){var s=Ni(i,n);if(s){var l=i.isPressingKeys(i.setup.panning.activationKeys);l&&(n.button===0&&!i.setup.panning.allowLeftClickPan||n.button===1&&!i.setup.panning.allowMiddleClickPan||n.button===2&&!i.setup.panning.allowRightClickPan||(n.preventDefault(),n.stopPropagation(),q(i),Bi(i,n),X(D(i),n,o)))}}},this.onPanning=function(n){var a=i.setup.disabled,o=i.props.onPanning;if(!a){var s=_i(i);if(s){var l=i.isPressingKeys(i.setup.panning.activationKeys);l&&(n.preventDefault(),n.stopPropagation(),Oi(i,n.clientX,n.clientY),X(D(i),n,o))}}},this.onPanningStop=function(n){var a=i.props.onPanningStop;i.isPanning&&(fr(i),X(D(i),n,a))},this.onPinchStart=function(n){var a=i.setup.disabled,o=i.props,s=o.onPinchingStart,l=o.onZoomStart;if(!a){var c=kr(i,n);c&&(Or(i,n),q(i),X(D(i),n,s),X(D(i),n,l))}},this.onPinch=function(n){var a=i.setup.disabled,o=i.props,s=o.onPinching,l=o.onZoom;if(!a){var c=Dr(i);c&&(n.preventDefault(),n.stopPropagation(),Lr(i,n),X(D(i),n,s),X(D(i),n,l))}},this.onPinchStop=function(n){var a=i.props,o=a.onPinchingStop,s=a.onZoomStop;i.pinchStartScale&&(Hr(i),X(D(i),n,o),X(D(i),n,s))},this.onTouchPanningStart=function(n){var a=i.setup.disabled,o=i.props.onPanningStart;if(!a){var s=Ni(i,n);if(s){var l=i.lastTouch&&+new Date-i.lastTouch<200&&n.touches.length===1;if(!l){i.lastTouch=+new Date,q(i);var c=n.touches,h=c.length===1,f=c.length===2;h&&(q(i),Bi(i,n),X(D(i),n,o)),f&&i.onPinchStart(n)}}}},this.onTouchPanning=function(n){var a=i.setup.disabled,o=i.props.onPanning;if(i.isPanning&&n.touches.length===1){if(a)return;var s=_i(i);if(!s)return;n.preventDefault(),n.stopPropagation();var l=n.touches[0];Oi(i,l.clientX,l.clientY),X(D(i),n,o)}else n.touches.length>1&&i.onPinch(n)},this.onTouchPanningStop=function(n){i.onPanningStop(n),i.onPinchStop(n)},this.onDoubleClick=function(n){var a=i.setup.disabled;if(!a){var o=Fr(i,n);o&&$r(i,n)}},this.clearPanning=function(n){i.isPanning&&i.onPanningStop(n)},this.setKeyPressed=function(n){i.pressedKeys[n.key]=!0},this.setKeyUnPressed=function(n){i.pressedKeys[n.key]=!1},this.isPressingKeys=function(n){return n.length?!!n.find(function(a){return i.pressedKeys[a]}):!0},this.setTransformState=function(n,a,o){var s=i.props.onTransformed;if(!Number.isNaN(n)&&!Number.isNaN(a)&&!Number.isNaN(o)){n!==i.transformState.scale&&(i.transformState.previousScale=i.transformState.scale,i.transformState.scale=n),i.transformState.positionX=a,i.transformState.positionY=o,i.applyTransformation();var l=D(i);i.onChangeCallbacks.forEach(function(c){return c(l)}),X(l,{scale:n,positionX:a,positionY:o},s)}else console.error("Detected NaN set state values")},this.setCenter=function(){if(i.wrapperComponent&&i.contentComponent){var n=en(i.transformState.scale,i.wrapperComponent,i.contentComponent);i.setTransformState(n.scale,n.positionX,n.positionY)}},this.handleTransformStyles=function(n,a,o){return i.props.customTransform?i.props.customTransform(n,a,o):jr(n,a,o)},this.applyTransformation=function(){if(!(!i.mounted||!i.contentComponent)){var n=i.transformState,a=n.scale,o=n.positionX,s=n.positionY,l=i.handleTransformStyles(o,s,a);i.contentComponent.style.transform=l}},this.getContext=function(){return D(i)},this.onChange=function(n){return i.onChangeCallbacks.has(n)||i.onChangeCallbacks.add(n),function(){i.onChangeCallbacks.delete(n)}},this.onInit=function(n){return i.onInitCallbacks.has(n)||i.onInitCallbacks.add(n),function(){i.onInitCallbacks.delete(n)}},this.init=function(n,a){i.cleanupWindowEvents(),i.wrapperComponent=n,i.contentComponent=a,he(i,i.transformState.scale),i.handleInitializeWrapperEvents(n),i.handleInitialize(n,a),i.initializeWindowEvents(),i.isInitialized=!0;var o=D(i);X(o,void 0,i.props.onInit)},this.props=t,this.setup=Hi(this.props),this.transformState=Ui(this.props)}return e}(),ci=re.createContext(null),Kr=function(e,t){return typeof e=="function"?e(t):e},qr=re.forwardRef(function(e,t){var i=P.useRef(new Vr(e)).current,n=Kr(e.children,oi(i));return P.useImperativeHandle(t,function(){return oi(i)},[i]),P.useEffect(function(){i.update(e)},[i,e]),re.createElement(ci.Provider,{value:i},n)});re.forwardRef(function(e,t){var i=P.useRef(null),n=P.useContext(ci);return P.useEffect(function(){return n.onChange(function(a){if(i.current){var o=0,s=0;i.current.style.transform=n.handleTransformStyles(o,s,1/a.instance.transformState.scale)}})},[n]),re.createElement("div",ne({},e,{ref:Cr([i,t])}))});function Qr(e,t){t===void 0&&(t={});var i=t.insertAt;if(!(typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",i==="top"&&n.firstChild?n.insertBefore(a,n.firstChild):n.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}var Ur=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
  transform: translate3d(0, 0, 0);
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,Zi={wrapper:"transform-component-module_wrapper__SPB86",content:"transform-component-module_content__FBWxo"};Qr(Ur);var Gr=function(e){var t=e.children,i=e.wrapperClass,n=i===void 0?"":i,a=e.contentClass,o=a===void 0?"":a,s=e.wrapperStyle,l=e.contentStyle,c=e.wrapperProps,h=c===void 0?{}:c,f=e.contentProps,g=f===void 0?{}:f,d=P.useContext(ci),y=d.init,w=d.cleanupWindowEvents,j=P.useRef(null),A=P.useRef(null);return P.useEffect(function(){var W=j.current,S=A.current;return W!==null&&S!==null&&y&&(y==null||y(W,S)),function(){w==null||w()}},[]),re.createElement("div",ne({},h,{ref:j,className:"".concat(ai.wrapperClass," ").concat(Zi.wrapper," ").concat(n),style:s}),re.createElement("div",ne({},g,{ref:A,className:"".concat(ai.contentClass," ").concat(Zi.content," ").concat(o),style:l}),t))},pi={},Jr=Ri;Object.defineProperty(pi,"__esModule",{value:!0});var on=pi.default=void 0,Ir=Jr($i()),et=r;on=pi.default=(0,Ir.default)((0,et.jsx)("path",{d:"m5 9 1.41 1.41L11 5.83V22h2V5.83l4.59 4.59L19 9l-7-7z"}),"North");var fi={},it=Ri;Object.defineProperty(fi,"__esModule",{value:!0});var sn=fi.default=void 0,nt=it($i()),rt=r;sn=fi.default=(0,nt.default)((0,rt.jsx)("path",{d:"m21.9 21.9-8.49-8.49-9.82-9.82L2.1 2.1.69 3.51 3 5.83V19c0 1.1.9 2 2 2h13.17l2.31 2.31zM5 18l3.5-4.5 2.5 3.01L12.17 15l3 3zm16 .17L5.83 3H19c1.1 0 2 .9 2 2z"}),"ImageNotSupported");const dt=()=>{const e=Nn(),t=_(u=>u.locations),i=_(u=>u.playTrack);_(u=>u.stopTrack);const n=_(u=>u.getSublocationsByParentId),a=_(u=>u.getAllTopLevelLocations),o=_(u=>u.refreshAssets);_(u=>u.hasAssets);const s=_(u=>u.isLoading),l=_(u=>u.characters),c=_(u=>u.combats),h=_(u=>u.saveDataToIndexedDB),f=_(u=>u.selectedLocationId),g=_(u=>u.setSelectedLocationId),[d,y]=P.useState(null),[w,j]=P.useState(!1),[A,W]=P.useState(!1),[S,E]=P.useState(!1),[Q,L]=P.useState(!1),[z,B]=P.useState(null),[$,O]=P.useState(!1),V=P.useRef(null),H=P.useRef(null),[oe,J]=P.useState(!1),[ke,se]=P.useState([]),[De,ve]=P.useState([]),be=t.length>0,[Xe,Se]=P.useState(""),[ge,$e]=P.useState({}),[Y,ee]=P.useState(null),[Fe,we]=P.useState(!1),[M,Ee]=P.useState(null),[We,le]=P.useState(!1),[de,Ve]=P.useState(0),[Ke,Ne]=P.useState(!1),qe=P.useRef(null),[ln,dn]=P.useState(0),[un,cn]=P.useState(0);P.useEffect(()=>{if(t.length>0)if(f){const u=t.find(p=>p.id===f);if(u)y(u),j(!0);else{const p=a();p.length>0&&(y(p[0]),g(p[0].id))}}else{const u=a();u.length>0&&(y(u[0]),g(u[0].id))}},[t,f]),P.useEffect(()=>{d&&((async()=>{J(!0);try{if(d.imageUrl){const p=await Oe.getAssetUrl("images",d.imageUrl);Se(p)}else Se("")}catch(p){console.error("Error loading image:",p),Se("")}finally{J(!1)}})(),g(d.id))},[d==null?void 0:d.id,d==null?void 0:d.imageUrl]),P.useEffect(()=>{if($){const u=async()=>{try{const m=await Oe.getAssets("audio");se(m.map(v=>v.name))}catch(m){console.error("Failed to load audio assets:",m),se([])}},p=async()=>{try{const m=await Oe.getAssets("images");ve(m.map(v=>v.name))}catch(m){console.error("Failed to load image assets:",m),ve([])}};u(),p()}},[$]);const je=async(u,p)=>{if(p.stopPropagation(),S){B(u),O(!0);return}if((d==null?void 0:d.id)!==u.id){if(y(u),j(!0),u.entrySound){const m=await Oe.getAssetUrl("audio",u.entrySound);m&&new Bn.Howl({src:[m],loop:!1,volume:_.getState().volume}).play()}if(u.backgroundMusic){const m=`/audio/${u.backgroundMusic}`,C=!(!!u.parentLocationId&&u.mixWithParent===!0);i(m,{replace:C,locationId:u.id})}}else j(!w)},mi=async()=>{if(await o(),d){const u=d.id;y(null),setTimeout(()=>{const p=t.find(m=>m.id===u);p&&y(p)},100)}},pn=u=>{if(!S||!d||!V.current||!H.current)return;const p=H.current.getBoundingClientRect(),m=(u.clientX-p.left)/p.width,v=(u.clientY-p.top)/p.height,C={name:"New Location",description:"Add a description",coordinates:[m,v],parentLocationId:d.id},N=_.getState().addLocation;N(C),_.getState().saveDataToIndexedDB()},fn=(u,p)=>{if(!S)return;const m=new Image;m.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",p.dataTransfer.setDragImage(m,0,0),p.dataTransfer.setData("locationId",u),L(!0)},mn=u=>{S&&u.preventDefault()},hn=u=>{if(!S||!H.current)return;u.preventDefault();const p=u.dataTransfer.getData("locationId");if(!p||!_.getState().locations.find(Ce=>Ce.id===p))return;const C=H.current.getBoundingClientRect(),N=(u.clientX-C.left)/C.width,x=(u.clientY-C.top)/C.height,k=Math.max(0,Math.min(1,N)),ue=Math.max(0,Math.min(1,x)),ce=_.getState().updateLocation;ce(p,{coordinates:[k,ue]}),_.getState().saveDataToIndexedDB(),L(!1)},hi=()=>{!S&&qe.current&&qe.current.resetTransform(),E(!S),$&&(O(!1),B(null))},vn=async()=>{const u=await h();alert(u.message)},gn=()=>d?n(d.id).map(p=>{if(!p.coordinates)return null;const[m,v]=p.coordinates,C=(d==null?void 0:d.id)===p.id;return r.jsx(ie,{title:S?"Drag to move, click to edit":p.name,arrow:!0,placement:"top",children:r.jsxs(b,{sx:{position:"absolute",left:`${m*100}%`,top:`${v*100}%`,transform:"translate(-50%, -50%)",zIndex:5,cursor:S?"move":"pointer",transition:"all 0.2s ease-in-out","&:hover":{transform:"translate(-50%, -50%) scale(1.2)"}},onClick:N=>je(p,N),draggable:S,onDragStart:N=>fn(p.id,N),children:[r.jsx(_e,{color:C?"primary":S?"secondary":"error",sx:{fontSize:C?"2.5rem":"2rem",filter:"drop-shadow(0px 0px 4px rgba(0, 0, 0, 0.9))"}}),r.jsx(T,{variant:"caption",sx:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",whiteSpace:"nowrap",backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white",padding:"2px 6px",borderRadius:"4px",fontSize:"0.7rem",fontWeight:"bold",textAlign:"center",maxWidth:"120px",overflow:"hidden",textOverflow:"ellipsis",filter:"drop-shadow(0px 0px 2px rgba(0, 0, 0, 0.5))"},children:p.name})]})},p.id)}):null,vi=(u,p=0)=>{const m=n(u.id),v=m.length>0;return r.jsxs(re.Fragment,{children:[r.jsx(Z,{disablePadding:!0,sx:{pl:p*2},children:r.jsxs(En,{selected:(d==null?void 0:d.id)===u.id,onClick:C=>je(u,C),children:[r.jsx(me,{sx:{minWidth:36},children:r.jsx(_e,{})}),r.jsx(R,{primary:u.name}),v&&r.jsx(K,{size:"small"})]})}),v&&r.jsx(ei,{in:(d==null?void 0:d.id)===u.id,timeout:"auto",unmountOnExit:!0,children:r.jsx(U,{disablePadding:!0,children:m.map(C=>vi(C,p+1))})})]},u.id)},xn=()=>{if(!d)return null;const u=Math.min(ln,un)/5e3;return t.filter(p=>{var m;return((m=d.connectedLocations)==null?void 0:m.includes(p.id))&&p.id!==d.id}).map(p=>{if(!d.coordinates||!p.coordinates)return null;const[m,v]=d.coordinates,[C,N]=p.coordinates,x=C-m,k=N-v,ce=Math.atan2(k,x)*(180/Math.PI)+90,Ce=Math.sqrt(x*x+k*k),jn=x/Ce,Cn=k/Ce,Pn=.5,Tn=.5,zn=Pn+jn*u,An=Tn+Cn*u;return r.jsx(ie,{title:`${p.name} (${Ce.toFixed(1)} meters)`,placement:"top",arrow:!0,children:r.jsx(K,{onClick:Ci=>{Ci.stopPropagation(),je(p,Ci)},sx:{position:"absolute",zIndex:10,color:"white",backgroundColor:"rgba(0,0,0,0.5)","&:hover":{backgroundColor:"rgba(0,0,0,0.8)"},left:`${zn*100}%`,top:`${An*100}%`,transform:"translate(-50%, -50%)"},children:r.jsx(on,{fontSize:"large",sx:{transform:`rotate(${ce}deg)`}})})},`tooltip-${p.id}`)})},gi=u=>{$e(p=>({...p,[u]:!p[u]}))},Qe=u=>l.filter(p=>p.locationId===u),xi=u=>{const p=Qe(u),m=n(u);let v=[...p];return m.forEach(C=>{const N=xi(C.id);v=[...v,...N]}),v},yi=(u,p)=>{p.stopPropagation(),ee(u),we(!0)},yn=()=>{if(!d)return null;const u=Qe(d.id),p=xi(d.id),m=p.length>u.length;return p.length===0?r.jsx(b,{sx:{p:2},children:r.jsx(T,{variant:"body2",color:"text.secondary",children:"No NPCs in this location"})}):r.jsx(b,{children:r.jsxs(U,{dense:!0,children:[u.length>0&&r.jsxs(r.Fragment,{children:[r.jsx(Z,{children:r.jsx(R,{primary:`NPCs in ${d.name}`,primaryTypographyProps:{variant:"subtitle1",fontWeight:"bold"}})}),u.map(v=>r.jsxs(Z,{button:!0,onClick:C=>yi(v,C),sx:{cursor:"pointer"},children:[r.jsx(me,{children:v.type==="npc"?r.jsx(ii,{fontSize:"small"}):v.type==="merchant"?r.jsx(Di,{fontSize:"small"}):r.jsx(ye,{color:"error",fontSize:"small"})}),r.jsx(R,{primary:r.jsxs(b,{sx:{display:"flex",alignItems:"center"},children:[v.name,v.descriptionType==="markdown"&&r.jsx(ie,{title:"Uses Markdown formatting",children:r.jsx(b,{component:"span",sx:{display:"flex",ml:1,color:"text.secondary"},children:r.jsx(Me,{fontSize:"small"})})})]}),secondary:r.jsx(b,{sx:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",lineHeight:1.2,fontSize:"0.875rem"},children:v.descriptionType==="markdown"?r.jsx(G,{content:v.description.length>80?`${v.description.substring(0,80)}...`:v.description,sx:{fontSize:"0.8rem",lineHeight:1.2,"& h1, & h2, & h3, & h4, & h5, & h6":{fontSize:"0.9rem",my:.5},"& p":{my:.5}},disableParaTags:!0}):v.description.length>80?`${v.description.substring(0,80)}...`:v.description})})]},v.id)),m&&r.jsx(xe,{sx:{my:1}})]}),m&&bi(d.id)]})})},bi=u=>{const p=n(u);return r.jsx(r.Fragment,{children:p.map(m=>{const v=Qe(m.id);if(v.length===0)return null;const C=`npc-section-${m.id}`,N=ge[C]||!1;return r.jsxs(b,{children:[r.jsxs(Z,{button:!0,onClick:()=>gi(C),sx:{pl:2},children:[r.jsx(R,{primary:m.name,primaryTypographyProps:{variant:"subtitle2"}}),N?r.jsx(Xi,{}):r.jsx(Ei,{})]}),r.jsx(ei,{in:N,timeout:"auto",unmountOnExit:!0,children:r.jsx(U,{component:"span",disablePadding:!0,children:v.map(x=>r.jsxs(Z,{button:!0,onClick:k=>yi(x,k),sx:{pl:4,cursor:"pointer"},children:[r.jsx(me,{children:x.type==="npc"?r.jsx(ii,{fontSize:"small"}):x.type==="merchant"?r.jsx(Di,{fontSize:"small"}):r.jsx(ye,{color:"error",fontSize:"small"})}),r.jsx(R,{primary:r.jsxs(b,{sx:{display:"flex",alignItems:"center"},children:[x.name,x.descriptionType==="markdown"&&r.jsx(ie,{title:"Uses Markdown formatting",children:r.jsx(b,{component:"span",sx:{display:"flex",ml:1,color:"text.secondary"},children:r.jsx(Me,{fontSize:"small"})})})]}),secondary:r.jsx(b,{sx:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",lineHeight:1.2,fontSize:"0.875rem"},children:x.descriptionType==="markdown"?r.jsx(G,{content:x.description.length>80?`${x.description.substring(0,80)}...`:x.description,sx:{fontSize:"0.8rem",lineHeight:1.2,"& h1, & h2, & h3, & h4, & h5, & h6":{fontSize:"0.9rem",my:.5},"& p":{my:.5}},disableParaTags:!0}):x.description.length>80?`${x.description.substring(0,80)}...`:x.description})})]},x.id))})}),bi(m.id)]},m.id)})})},bn=()=>{var N;if(!Y)return null;const u=((N=t.find(x=>x.id===Y.locationId))==null?void 0:N.name)||"Unknown",p=_.getState().updateCharacter,m=()=>{if(!Y||!S)return;const x={id:crypto.randomUUID(),name:"New Item",description:"Item description",quantity:1},k=[...Y.inventory||[],x];p(Y.id,{inventory:k}),ee({...Y,inventory:k})},v=(x,k)=>{if(!Y||!S)return;const ue=(Y.inventory||[]).map(ce=>ce.id===x?{...ce,...k}:ce);p(Y.id,{inventory:ue}),ee({...Y,inventory:ue})},C=x=>{if(!Y||!S)return;const k=(Y.inventory||[]).filter(ue=>ue.id!==x);p(Y.id,{inventory:k}),ee({...Y,inventory:k})};return r.jsxs(b,{sx:{p:2,minWidth:300,maxWidth:400},children:[r.jsxs(b,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[r.jsx(T,{variant:"h6",children:Y.name}),r.jsx(K,{onClick:()=>we(!1),size:"small",children:r.jsx(Be,{})})]}),r.jsx(T,{variant:"subtitle1",color:"text.secondary",children:Y.type==="npc"?"NPC":Y.type==="merchant"?"Merchant":"Enemy"}),Y.descriptionType==="markdown"&&r.jsx(b,{sx:{mt:1,mb:2},children:r.jsx(G,{content:Y.description})}),(!Y.descriptionType||Y.descriptionType!=="markdown")&&r.jsx(T,{variant:"body2",paragraph:!0,children:Y.description}),r.jsxs(b,{sx:{mb:2},children:[r.jsx(T,{variant:"subtitle2",children:"Location:"}),r.jsx(T,{variant:"body2",children:u})]}),r.jsx(xe,{sx:{my:2}}),r.jsxs(b,{sx:{mb:1,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx(T,{variant:"h6",children:"Inventory"}),S&&r.jsx(K,{size:"small",onClick:m,color:"primary",children:r.jsx(Mn,{})})]}),!Y.inventory||Y.inventory.length===0?r.jsx(T,{variant:"body2",color:"text.secondary",children:"No items in inventory"}):r.jsx(U,{dense:!0,children:Y.inventory.map(x=>r.jsx(Z,{secondaryAction:S?r.jsx(K,{edge:"end",size:"small",onClick:()=>C(x.id),children:r.jsx(Wn,{fontSize:"small"})}):null,children:r.jsx(R,{primary:S?r.jsx(I,{size:"small",value:x.name,onChange:k=>v(x.id,{name:k.target.value}),fullWidth:!0,variant:"standard",margin:"dense"}):x.name,secondary:r.jsxs(r.Fragment,{children:[S?r.jsx(I,{size:"small",value:x.description,onChange:k=>v(x.id,{description:k.target.value}),fullWidth:!0,variant:"standard",margin:"dense",multiline:!0}):x.description,r.jsxs(b,{sx:{display:"flex",justifyContent:"space-between",mt:1},children:[r.jsxs(b,{children:["Qty: ",S?r.jsx(I,{size:"small",type:"number",value:x.quantity,onChange:k=>v(x.id,{quantity:parseInt(k.target.value)||0}),variant:"standard",sx:{width:50}}):x.quantity]}),x.price!==void 0&&r.jsxs(b,{children:["Price: ",S?r.jsx(I,{size:"small",type:"number",value:x.price,onChange:k=>v(x.id,{price:parseInt(k.target.value)||0}),variant:"standard",sx:{width:60}}):x.price]}),S&&x.price===void 0&&r.jsx(fe,{size:"small",onClick:()=>v(x.id,{price:0}),children:"Add Price"})]})]})})},x.id))})]})},Si=u=>{const p=c.filter(C=>C.locationId===u),m=n(u);let v=[...p];return m.forEach(C=>{const N=Si(C.id);v=[...v,...N]}),v},wi=(u,p)=>{p.stopPropagation(),Ee(u),le(!0)},Sn=()=>{if(!d)return null;const u=c.filter(v=>v.locationId===d.id),p=Si(d.id),m=p.length>u.length;return p.length===0?r.jsx(b,{sx:{p:2},children:r.jsx(T,{variant:"body2",color:"text.secondary",children:"No combats in this location"})}):r.jsx(b,{children:r.jsxs(U,{dense:!0,children:[u.length>0&&r.jsxs(r.Fragment,{children:[r.jsx(Z,{children:r.jsx(R,{primary:`Combats in ${d.name}`,primaryTypographyProps:{variant:"subtitle1",fontWeight:"bold"}})}),u.map(v=>r.jsxs(Z,{button:!0,onClick:C=>wi(v,C),sx:{cursor:"pointer"},children:[r.jsx(me,{children:r.jsx(ye,{color:"primary",fontSize:"small"})}),r.jsx(R,{primary:r.jsxs(b,{sx:{display:"flex",alignItems:"center"},children:[v.name,v.descriptionType==="markdown"&&r.jsx(ie,{title:"Uses Markdown formatting",children:r.jsx(b,{component:"span",sx:{display:"flex",ml:1,color:"text.secondary"},children:r.jsx(Me,{fontSize:"small"})})})]}),secondary:r.jsxs(b,{sx:{display:"flex",alignItems:"center",gap:.5},children:[r.jsx(pe,{size:"small",label:`Difficulty: ${v.difficulty||"Medium"}`,variant:"outlined"}),v.description&&v.descriptionType==="markdown"&&r.jsx(b,{component:"span",sx:{display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical",overflow:"hidden",lineHeight:1.2,fontSize:"0.8rem",flex:1},children:r.jsx(G,{content:v.description.length>40?`${v.description.substring(0,40)}...`:v.description,sx:{fontSize:"0.8rem",lineHeight:1.2,"& h1, & h2, & h3, & h4, & h5, & h6":{fontSize:"0.9rem",my:.5},"& p":{my:.5}},disableParaTags:!0})})]}),secondaryTypographyProps:{component:"span"}})]},v.id)),m&&r.jsx(xe,{sx:{my:1}})]}),m&&ji(d.id)]})})},ji=u=>{const p=n(u);return r.jsx(r.Fragment,{children:p.map(m=>{const v=c.filter(x=>x.locationId===m.id);if(v.length===0)return null;const C=`combat-section-${m.id}`,N=ge[C]||!1;return r.jsxs(b,{children:[r.jsxs(Z,{button:!0,onClick:()=>gi(C),sx:{pl:2},children:[r.jsx(R,{primary:m.name,primaryTypographyProps:{variant:"subtitle2"}}),N?r.jsx(Xi,{}):r.jsx(Ei,{})]}),r.jsx(ei,{in:N,timeout:"auto",unmountOnExit:!0,children:r.jsx(U,{component:"span",disablePadding:!0,children:v.map(x=>r.jsxs(Z,{button:!0,onClick:k=>wi(x,k),sx:{pl:4,cursor:"pointer"},children:[r.jsx(me,{children:r.jsx(ye,{color:"primary",fontSize:"small"})}),r.jsx(R,{primary:r.jsxs(b,{sx:{display:"flex",alignItems:"center"},children:[x.name,x.descriptionType==="markdown"&&r.jsx(ie,{title:"Uses Markdown formatting",children:r.jsx(b,{component:"span",sx:{display:"flex",ml:1,color:"text.secondary"},children:r.jsx(Me,{fontSize:"small"})})})]}),secondary:r.jsxs(b,{sx:{display:"flex",alignItems:"center",gap:.5},children:[r.jsx(pe,{size:"small",label:`Difficulty: ${x.difficulty||"Medium"}`,variant:"outlined"}),x.description&&x.descriptionType==="markdown"&&r.jsx(b,{component:"span",sx:{display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical",overflow:"hidden",lineHeight:1.2,fontSize:"0.8rem",flex:1},children:r.jsx(G,{content:x.description.length>40?`${x.description.substring(0,40)}...`:x.description,sx:{fontSize:"0.8rem",lineHeight:1.2,"& h1, & h2, & h3, & h4, & h5, & h6":{fontSize:"0.9rem",my:.5},"& p":{my:.5}},disableParaTags:!0})})]}),secondaryTypographyProps:{component:"span"}})]},x.id))})}),ji(m.id)]},m.id)})})},wn=()=>{var p;if(!M)return null;const u=((p=t.find(m=>m.id===M.locationId))==null?void 0:p.name)||"Unknown";return r.jsxs(b,{sx:{p:2,minWidth:300,maxWidth:400},children:[r.jsxs(b,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[r.jsx(T,{variant:"h6",children:M.name}),r.jsx(K,{onClick:()=>le(!1),size:"small",children:r.jsx(Be,{})})]}),r.jsxs(T,{variant:"subtitle1",color:"text.secondary",children:["Difficulty: ",M.difficulty||"Medium"]}),M.descriptionType==="markdown"&&r.jsx(b,{sx:{mt:1,mb:2},children:r.jsx(G,{content:M.description})}),(!M.descriptionType||M.descriptionType!=="markdown")&&r.jsx(T,{variant:"body2",paragraph:!0,children:M.description}),r.jsxs(b,{sx:{mb:2},children:[r.jsx(T,{variant:"subtitle2",children:"Location:"}),r.jsx(T,{variant:"body2",children:u})]}),r.jsx(fe,{variant:"contained",color:"primary",fullWidth:!0,startIcon:r.jsx(ye,{}),onClick:()=>{le(!1),e("/combat-session",{state:{combatId:M.id}})},sx:{mb:3},children:"Start Combat"}),r.jsx(xe,{sx:{my:2}}),r.jsx(T,{variant:"subtitle2",children:"Player Characters:"}),M.playerCharacters.length===0?r.jsx(T,{variant:"body2",color:"text.secondary",children:"No player characters assigned"}):r.jsx(U,{dense:!0,children:M.playerCharacters.map(m=>r.jsxs(Z,{children:[r.jsx(me,{children:r.jsx(ii,{fontSize:"small"})}),r.jsx(R,{primary:m.name,secondary:m.descriptionType==="markdown"?r.jsx(G,{content:m.description||"",sx:{fontSize:"0.8rem",lineHeight:1.2,"& h1, & h2, & h3, & h4, & h5, & h6":{fontSize:"0.9rem",my:.5},"& p":{my:.5}},disableParaTags:!0}):null})]},m.id))}),r.jsx(xe,{sx:{my:2}}),r.jsx(T,{variant:"subtitle2",children:"Enemies:"}),M.enemies.length===0?r.jsx(T,{variant:"body2",color:"text.secondary",children:"No enemies assigned"}):r.jsx(U,{dense:!0,children:Object.entries(M.enemies.reduce((m,v)=>(m[v.id]=m[v.id]||{enemy:v,count:0},m[v.id].count++,m),{})).map(([m,{enemy:v,count:C}])=>r.jsxs(Z,{children:[r.jsx(me,{children:r.jsx(ye,{color:"error",fontSize:"small"})}),r.jsx(R,{primary:`${v.name} ${C>1?`(x${C})`:""}`,secondary:r.jsx(r.Fragment,{children:v.descriptionType==="markdown"?r.jsx(G,{content:`HP: ${v.hp}`,sx:{fontSize:"0.8rem",lineHeight:1.2,"& h1, & h2, & h3, & h4, & h5, & h6":{fontSize:"0.9rem",my:.5},"& p":{my:.5}},disableParaTags:!0}):`HP: ${v.hp}`})})]},m))}),M.rewards&&M.rewards.length>0&&r.jsxs(r.Fragment,{children:[r.jsx(xe,{sx:{my:2}}),r.jsx(T,{variant:"subtitle2",children:"Rewards:"}),r.jsx(U,{dense:!0,children:M.rewards.map(m=>r.jsx(Z,{children:r.jsx(R,{primary:m.name,secondary:r.jsx(r.Fragment,{children:`Quantity: ${m.quantity}${m.description?` - ${m.description}`:""}`})})},m.id))})]})]})};return s?r.jsxs(b,{sx:{height:"calc(100vh - 64px)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"background.default"},children:[r.jsx(Pi,{size:60}),r.jsx(T,{variant:"h6",sx:{mt:2},children:"Loading your campaign..."})]}):be?r.jsxs(b,{sx:{display:"flex",height:"100%",overflow:"hidden"},children:[r.jsxs(Ue,{elevation:3,sx:{width:280,height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",zIndex:1},children:[r.jsxs(Ti,{value:w?1:0,onChange:(u,p)=>j(p===1),variant:"fullWidth",children:[r.jsx(Pe,{label:"Locations"}),r.jsx(Pe,{label:"Details",disabled:!d})]}),w?r.jsxs(b,{sx:{flexGrow:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[r.jsxs(b,{sx:{p:2,borderBottom:"1px solid rgba(0, 0, 0, 0.12)"},children:[r.jsxs(b,{sx:{display:"flex",alignItems:"center",mb:1},children:[r.jsx(K,{size:"small",onClick:()=>j(!1),sx:{mr:1},children:r.jsx(Yn,{fontSize:"small"})}),r.jsx(T,{variant:"h6",noWrap:!0,children:d==null?void 0:d.name}),S&&r.jsx(K,{size:"small",color:"primary",onClick:()=>{d&&(B(d),O(!0))},sx:{ml:"auto"},children:r.jsx(Ge,{fontSize:"small"})})]}),(d==null?void 0:d.description)&&r.jsxs(b,{onClick:()=>Ne(!0),sx:{cursor:"pointer","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"},borderRadius:1,p:1},children:[r.jsx(b,{sx:{display:"-webkit-box",WebkitLineClamp:4,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:r.jsx(G,{content:d.description})}),d.description.length>200&&r.jsx(T,{variant:"caption",color:"primary",sx:{display:"block",mt:.5},children:"Click to view full description"})]})]}),r.jsxs(b,{sx:{overflow:"auto",flexGrow:1},children:[r.jsxs(Ti,{value:de,onChange:(u,p)=>Ve(p),variant:"fullWidth",sx:{borderBottom:1,borderColor:"divider"},children:[r.jsx(Pe,{label:"Info"}),r.jsx(Pe,{label:"NPCs"}),r.jsx(Pe,{label:"Combats"})]}),de===0&&r.jsxs(b,{sx:{p:2},children:[(d==null?void 0:d.backgroundMusic)&&r.jsxs(b,{sx:{mb:2},children:[r.jsx(T,{variant:"subtitle2",children:"Background Music:"}),r.jsx(pe,{icon:r.jsx(zi,{}),label:d.backgroundMusic,size:"small",color:"primary",variant:"outlined",onClick:()=>{d!=null&&d.backgroundMusic&&i(d.backgroundMusic,{replace:!0,locationId:d.id,loop:!0})}})]}),(d==null?void 0:d.entrySound)&&r.jsxs(b,{sx:{mb:2},children:[r.jsx(T,{variant:"subtitle2",children:"Entry Sound:"}),r.jsx(pe,{icon:r.jsx(zi,{}),label:d.entrySound,size:"small",color:"secondary",variant:"outlined",onClick:()=>{d!=null&&d.entrySound&&i(d.entrySound,{replace:!1,locationId:d.id})}})]}),(d==null?void 0:d.connectedLocations)&&d.connectedLocations.length>0&&r.jsxs(b,{sx:{mb:2},children:[r.jsx(T,{variant:"subtitle2",children:"Connected Locations:"}),r.jsx(b,{sx:{display:"flex",flexWrap:"wrap",gap:1,mt:1},children:d.connectedLocations.map(u=>{const p=t.find(m=>m.id===u);return p?r.jsx(pe,{icon:r.jsx(_e,{}),label:p.name,size:"small",color:"info",variant:"outlined",onClick:m=>je(p,m)},u):null})})]}),(d==null?void 0:d.sublocations)&&d.sublocations.length>0&&r.jsxs(b,{sx:{mb:2},children:[r.jsx(T,{variant:"subtitle2",children:"Sublocations:"}),r.jsx(b,{sx:{display:"flex",flexWrap:"wrap",gap:1,mt:1},children:d.sublocations.map(u=>{const p=t.find(m=>m.id===u.id);return p?r.jsx(pe,{icon:r.jsx(_e,{}),label:p.name,size:"small",color:"info",variant:"outlined",onClick:m=>je(p,m)},u.id):null})})]})]}),de===1&&yn(),de===2&&Sn()]})]}):r.jsx(U,{sx:{overflowY:"auto",flexGrow:1,"& .MuiListItemButton-root.Mui-selected":{bgcolor:"primary.light","&:hover":{bgcolor:"primary.light"}}},children:a().map(u=>vi(u))})]}),r.jsxs(b,{ref:H,className:"map-background",sx:{position:"relative",flex:1,height:"100%",overflow:"hidden",zIndex:1,cursor:S?"crosshair":"default"},onDragOver:mn,onDrop:hn,onClick:pn,children:[s?r.jsxs(b,{className:"map-background",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[r.jsx(Pi,{size:60}),r.jsx(T,{variant:"body1",sx:{mt:2},children:"Loading map..."})]}):!Xe||!d?r.jsxs(b,{className:"map-background",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[r.jsx(sn,{sx:{fontSize:60,opacity:.7}}),r.jsx(T,{variant:"body1",sx:{mt:2,opacity:.7},children:"No map image available"})]}):r.jsx(qr,{initialScale:1,initialPositionX:0,initialPositionY:0,minScale:.5,maxScale:5,wheel:{step:.1},limitToBounds:!1,disablePadding:!0,disabled:S,ref:qe,children:()=>r.jsx(r.Fragment,{children:r.jsx(Gr,{wrapperStyle:{width:"100%",height:"100%",position:"absolute",top:0,left:0,zIndex:0},contentStyle:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:r.jsxs(b,{sx:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"},children:[r.jsx("img",{ref:V,src:Xe,alt:(d==null?void 0:d.name)||"Map",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",position:"relative",zIndex:1},onLoad:u=>{J(!1);const p=u.target;dn(p.naturalWidth),cn(p.naturalHeight)},onError:()=>J(!1)}),gn(),xn()]})})})},"main-map"),!be&&!s&&r.jsx(b,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},children:r.jsxs(b,{sx:{textAlign:"center",maxWidth:400,p:3,bgcolor:"rgba(0,0,0,0.8)",color:"white",borderRadius:2},children:[r.jsx(T,{variant:"h5",gutterBottom:!0,children:"No locations found"}),r.jsx(T,{variant:"body1",paragraph:!0,children:"Your campaign doesn't have any locations yet. Import data or create locations in edit mode."}),r.jsx(fe,{variant:"contained",color:"primary",sx:{mr:1},onClick:()=>W(!0),children:"Import Assets"}),r.jsx(fe,{variant:"outlined",color:"secondary",onClick:hi,children:S?"Exit Edit Mode":"Enter Edit Mode"})]})})]}),r.jsxs(Te,{open:$,onClose:()=>O(!1),maxWidth:"md",fullWidth:!0,children:[r.jsxs(Je,{children:["Edit Location",r.jsx(K,{"aria-label":"close",onClick:()=>O(!1),sx:{position:"absolute",right:8,top:8},children:r.jsx(kn,{})})]}),r.jsx(Ie,{dividers:!0,children:z&&r.jsxs(Dn,{spacing:2,children:[r.jsx(I,{label:"Name",fullWidth:!0,value:z.name,onChange:u=>B({...z,name:u.target.value})}),r.jsx(I,{label:"Description",fullWidth:!0,multiline:!0,rows:4,value:z.description,onChange:u=>B({...z,description:u.target.value})}),r.jsx(Xn,{multiple:!0,options:t.filter(u=>u.id!==z.id),value:t.filter(u=>{var p;return((p=z.connectedLocations)==null?void 0:p.includes(u.id))||!1}),onChange:(u,p)=>B({...z,connectedLocations:p.map(m=>m.id)}),getOptionLabel:u=>u.name,renderInput:u=>r.jsx(I,{...u,label:"Connected Locations",fullWidth:!0,helperText:"Select locations that are connected to this one"}),isOptionEqualToValue:(u,p)=>u.id===p.id,renderTags:(u,p)=>u.map((m,v)=>P.createElement(pe,{label:m.name,...p({index:v}),key:m.id}))}),z.coordinates&&r.jsxs(b,{sx:{display:"flex",gap:2},children:[r.jsx(I,{label:"X Coordinate",type:"number",InputProps:{inputProps:{min:0,max:1,step:.01}},value:z.coordinates[0],onChange:u=>{if(z.coordinates){const p=parseFloat(u.target.value),m=z.coordinates[1];B({...z,coordinates:[p,m]})}}}),r.jsx(I,{label:"Y Coordinate",type:"number",InputProps:{inputProps:{min:0,max:1,step:.01}},value:z.coordinates[1],onChange:u=>{if(z.coordinates){const p=z.coordinates[0],m=parseFloat(u.target.value);B({...z,coordinates:[p,m]})}}})]})]})}),r.jsxs(Ai,{children:[r.jsx(fe,{onClick:()=>O(!1),children:"Cancel"}),r.jsx(fe,{onClick:()=>{if(z){const u=_.getState().updateLocation;u(z.id,{name:z.name,description:z.description,coordinates:z.coordinates,connectedLocations:z.connectedLocations}),_.getState().saveDataToIndexedDB(),O(!1)}},variant:"contained",color:"primary",children:"Save"})]})]}),r.jsxs(Te,{open:A,onClose:()=>W(!1),maxWidth:"md",fullWidth:!0,children:[r.jsx(Je,{children:r.jsxs(b,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:["Asset Manager",r.jsx(K,{edge:"end",onClick:()=>W(!1),children:r.jsx(Be,{})})]})}),r.jsx(Ie,{dividers:!0,children:r.jsx(Wi,{onAssetImport:mi})})]}),r.jsx(Te,{open:Fe,onClose:()=>we(!1),maxWidth:"sm",fullWidth:!0,children:bn()}),r.jsx(Te,{open:We,onClose:()=>le(!1),maxWidth:"sm",fullWidth:!0,children:wn()}),r.jsxs(Te,{open:Ke,onClose:()=>Ne(!1),maxWidth:"md",fullWidth:!0,children:[r.jsxs(Je,{children:[d==null?void 0:d.name," - Description",r.jsx(K,{"aria-label":"close",onClick:()=>Ne(!1),sx:{position:"absolute",right:8,top:8},children:r.jsx(Be,{})})]}),r.jsx(Ie,{dividers:!0,children:r.jsx(G,{content:(d==null?void 0:d.description)||""})}),r.jsx(Ai,{children:r.jsx(fe,{onClick:()=>Ne(!1),children:"Close"})})]}),r.jsx(_n,{}),S&&r.jsxs(Ue,{elevation:4,sx:{position:"absolute",top:16,left:"50%",transform:"translateX(-50%)",zIndex:1100,padding:"8px 16px",backgroundColor:"rgba(0, 0, 0, 0.8)",color:"white",borderRadius:2,display:"flex",alignItems:"center",gap:1},children:[r.jsx(Ge,{fontSize:"small"}),r.jsx(T,{variant:"subtitle2",children:"Edit Mode Active"})]}),r.jsx(ie,{title:S?"Exit Edit Mode":"Enter Edit Mode to add, edit, and reposition locations on the map",placement:"left",children:r.jsx(Yi,{color:S?"secondary":"primary","aria-label":"edit mode",sx:{position:"absolute",bottom:16,right:16,zIndex:1100},onClick:hi,children:S?r.jsx(ki,{}):r.jsx(Ge,{})})}),S&&r.jsx(ie,{title:"Save all changes to your campaign",placement:"left",children:r.jsx(Yi,{color:"success","aria-label":"save changes",sx:{position:"absolute",bottom:16,right:96,zIndex:1100},onClick:vn,children:r.jsx(ki,{})})})]}):r.jsx(b,{sx:{height:"calc(100vh - 64px)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:4,backgroundColor:"background.default"},children:r.jsxs(Ue,{elevation:3,sx:{maxWidth:600,width:"100%",p:4,display:"flex",flexDirection:"column",alignItems:"center",backgroundColor:"rgba(45, 45, 45, 0.9)"},children:[r.jsx(T,{variant:"h4",gutterBottom:!0,align:"center",sx:{mb:2},children:"Welcome to Pen & Paper Project"}),r.jsx(T,{variant:"body1",paragraph:!0,align:"center",children:"No campaign assets found. Please upload a zip file containing your campaign assets to get started."}),r.jsx(T,{variant:"body2",paragraph:!0,align:"center",color:"text.secondary",sx:{mb:3},children:'Your zip file should contain an "audio" folder for sound files, an "images" folder for location images, and a "data" folder with your "locations.json" and "characters.json" files.'}),r.jsx(Wi,{onAssetImport:mi,isFullPage:!0})]})})};export{dt as MapView};
//# sourceMappingURL=MapView-BYgOyPi9.js.map
